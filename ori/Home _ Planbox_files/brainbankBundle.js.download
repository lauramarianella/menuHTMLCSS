var BrainBank={apiUrl:null,webUrl:null,permissions:[],initialize:function(e){e=this.util.ApplyArgumentSchema(e,{apiUrl:null,webUrl:null,permissions:[]}),this.apiUrl=e.apiUrl,this.webUrl=e.webUrl,this.permissions=e.permissions},hasPermission:function(e){return-1!==$.inArray(e,BrainBank.permissions)},getApiRoute:function(e,t,i){var a=BrainBank.apiUrl;return e&&(a+="/"+e),t&&(a+="."+t),i&&(a+="("+i+")"),a},ui:{AddOneClickButtons:function(i){$("input.post-once").on("click",function(e){var t=$(this);t[0].form.submit(),t.attr("disabled","disabled"),i&&t.val(i)})},SetFocus:function(e){e.focus();var t=e.val();e.val("").val(t)}},util:{ApplyArgumentSchema:function(e,t,i){if(e){for(var a in e)if(void 0===t[a]){if(!i){var n=[];for(var o in t)n.push(o);throw new Error('Invalid argument "'+a+'"; valid arguments are ['+n.toString()+"].")}delete e[a]}}else e={};for(var r in t)void 0!==e[r]&&null!==e[r]||(e[r]=t[r]);return e}}};!function(s,d){s.loading='<div class="loading"><div class="loader"></div><h5 class="loading-title">Loading...</h5></div>',s.loadingAbsoluteSelector=".loading-absolute",s.loadingAbsolute='<div class="loading-style loading-absolute"><h5 class="loading-title">Loading...</h5></div>';var a=".ajax-error";s.IgnoreHtmlErrorCodes=new Array,s.initializeAjaxError=function(){d(document).ajaxSend(function(e,t,i){t.url=i.url,t.type=i.type,d(a).length&&d(a).remove(),void 0!==i.loading?d("body").append(i.loading):d("body").append(s.loadingAbsolute),t.done(function(){d(s.loadingAbsoluteSelector).remove()}).fail(function(){d(s.loadingAbsoluteSelector).length&&d(s.loadingAbsoluteSelector).remove(),0!=t.readyState&&0!=t.status&&-1==d.inArray(t.status,s.IgnoreHtmlErrorCodes)&&(d("body").append('<div class="loading-style ajax-error"><h5 class="ajax-error-title">Ajax Error ! (<a>View</a>)</h5></div>'),function(t){d(".ajax-error a").click(function(){var e="<strong>URL:</strong> "+t.url+"<br/><strong>Status:</strong> "+t.status+"<br/><strong>Type:</strong> "+t.type+"<br/><strong>Response:</strong> "+t.responseText;s.DialogBox?(s.DialogBox.show({title:"Ajax error",body:e,closeButtonLabel:"Close",width:900}),d(".modal-body:last").css("overflow-x","auto")):alert(e),d(a).remove()})}(t))})})},s.JqXhrPools=s.JqXhrPools||{};var n={};function o(e,t,i){var a=d.inArray(e,n[t]);-1<a&&(i&&e.abort(),n[t].splice(a,1))}s.JqXhrPools.add=function(e,t){n[e]||(n[e]=new Array),n[e].push(t)},s.JqXhrPools.abortAll=function(i){d(n[i]).each(function(e,t){o(t,i,!0)})},s.JqXhrPools.remove=function(e,t){o(t,e)},s.loadScripts=function(){var e=d("[data-load-scripts]").remove();if(e.length){var n=[],o=[];e.each(function(e,t){var i=d.trim(d(t).data("load-scripts")).split(" ");-1==d.inArray(i,n)&&n.push(i);var a=d(t).data("callback");-1==d.inArray(a,o)&&o.push(a)}),n=d.map(n,function(e){return e}),Modernizr.load({load:n,complete:function(){for(var e=0;e<o.length;e++)d.globalEval(o[e])}})}},s.executeScript=function(){var e=d("[data-script]").remove(),a=[];e.each(function(e,t){var i=d(t).data("script");-1==d.inArray(i,a)&&a.push(i)});for(var t=0;t<a.length;t++)d.globalEval(a[t])},s.AutoResizeTextarea=function(){d("textarea:not(.textarea-autoresize, #JobDescription, #SQLCommand , #JsonMapping)").on("keyup cut paste click",function(){var e,t=d(this);t.hasClass("textarea-autoresize")||t.css("min-height",t.css("height")),-1!=navigator.appName.indexOf("Internet Explorer")&&(e=-1==navigator.appVersion.indexOf("MSIE 9")&&-1==navigator.appVersion.indexOf("MSIE 1")),e?t.css("overflow","auto"):t.css("overflow","hidden"),t.css("height","0px"),t.css("height",this.scrollHeight),t.addClass("textarea-autoresize")})},s.DeclareTrimFunction=function(){"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})},s.IsDialogSuccess=function(e){return"1"==d(e).data("form-success")||d(e).find('[data-form-success="1"]').length},s.CollapseLeftMenu=function(){d(".left-menu-btn").click(function(){var e=d(".sub-container-new"),t=d(".left-menu"),i=d(".body-backend ul.navbar-nav"),a=d("#toggle-main-nav"),n=d("#toggle-main-nav i"),o=d("#footer-new .footer-container"),r=d(".page-header h2"),l=d(".page-header h3");t.hasClass("collapsed")?(t.removeClass("collapsed"),n.addClass("left"),n.removeClass("right"),a.removeClass("collapsed"),r.removeClass("collapsed"),l.removeClass("collapsed"),e.removeClass("left-menu-iscollapsed"),i.removeClass("left-menu-iscollapsed"),o.removeClass("footer-text-collapsed"),s.DeleteCookie("left-menu")):(e.addClass("left-menu-iscollapsed"),i.addClass("left-menu-iscollapsed"),t.addClass("collapsed"),a.addClass("collapsed"),n.addClass("right"),n.removeClass("left"),r.addClass("collapsed"),l.addClass("collapsed"),o.addClass("footer-text-collapsed"),s.SetCookie("left-menu","collapsed",1))})},s.SetCookie=function(e,t,i){if(i){var a=new Date;a.setTime(a.getTime()+24*i*60*60*1e3);var n="; expires="+a.toGMTString()}else n="";document.cookie=e+"="+t+n+"; path=/"},s.GetCookie=function(e){for(var t=e+"=",i=document.cookie.split(";"),a=0;a<i.length;a++){for(var n=i[a];" "==n.charAt(0);)n=n.substring(1,n.length);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return null},s.DeleteCookie=function(e){s.GetCookie(e)&&s.SetCookie(e,"",-1)}}(window.Brainbank=window.Brainbank||{},jQuery);var BrainBank=BrainBank||{};BrainBank.AsyncUpload={initialize:function(t,e,i){var a=(t=$(t)).siblings(".k-upload:first").find(":data('kendoUpload')").data("kendoUpload");a.element.attr("accept","image/*,video/*,audio/*,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/vnd.ms-powerpoint,application/vnd.openxmlformats-officedocument.presentationml.presentation,text/plain,.csv,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel,application/vnd.visio,application/vnd.ms-project,.vdx,.vtx,.vsx"),""==t.val()&&$.get(e,function(e){t.val(e),a.options.async.saveUrl=i(e)})},error:function(e){var t=e.files;"upload"==e.operation&&("InvalidFileType"==e.XMLHttpRequest.responseText?alert("Sorry! The file that you are trying to upload is not allowed."):"VirusDetected"==e.XMLHttpRequest.responseText?alert(" Threats found!"):alert("Sorry! "+t.length+" files couldn't be uploaded, probably because they were too large."),$(e.sender.element).parents(".k-upload:first").find(".k-retry").removeClass("k-retry").addClass("k-cancel").parents("button").click())},success:function(i){var a=$(i.sender.element).parents(".k-upload:first").siblings(".blob-references-container");i.response&&$(i.response).each(function(e,t){i.files[e].name=t.Value,Brainbank.ImageGallery.addSelectedImage(t.Value,a,!0,e,t.Key)})},successSingle:function(e){e.files[0].name=e.response&&null!=e.response.length?e.response[0].Value:"";var t=$(e.sender.element).parents(".k-upload:first").siblings(".blob-references-container");Brainbank.ImageGallery.addSelectedImage(e.files[0].name,t,!1,0,e.files[0].rawFile.name)},remove:function(e){var t=e.files[0].name,i=$(e.sender.element).parents(".k-upload:first").siblings(".blob-references-container");Brainbank.ImageGallery.cleanBlobReference(i,t),Brainbank.ImageGallery.removeInvalidImage(e.files[0].rawFile.name)},select:function(e){$('input[type="submit"], button[type="submit"], #saveasdraftbtn, .close-dialog-button').attr("disabled","disabled")},cancel:function(e){$('input[type="submit"], button[type="submit"], #saveasdraftbtn, .close-dialog-button').removeAttr("disabled","disabled")},complete:function(e){$('input[type="submit"], button[type="submit"], #saveasdraftbtn, .close-dialog-button').removeAttr("disabled","disabled")},selectImage:function(t){$('input[type="submit"], #saveasdraftbtn, button[type="submit"], .close-dialog-button').attr("disabled","disabled");var i=$(t.sender.element).parents(".k-upload:first").siblings(".blob-references-container");$(t.files).each(function(e){Brainbank.ImageGallery.validateImage(i,t.files[e].name)})}},function(n,o){n.IdeaTask=n.IdeaTask||{};var r="",l="",s="",d=!1,c=!1;function i(){d?location.href=l:c?location.href=s:o(".idea-task-title .close-btn").trigger("click")}function u(e,t){e.ajaxForm({beforeSubmit:function(){o(t).html(n.loading)},success:function(e){n.IsDialogSuccess(e)?n.Attachments?o.when(n.Attachments.deleteFromQueue()).then(i):i():(o(t).html(e),u(o(t).find("form"),t))}})}function p(e,t){o(".idea-task .content").html(n.loading),o(".idea-task").show(),"False"==t?(o(".survey.title").show(),o(".task.title").hide()):(o(".survey.title").hide(),o(".task.title").show()),o(".idea-task").addClass("open");var i=o.param.querystring(r,{taskId:e});o(".idea-task .content").load(i,function(){u(o(".idea-task .content").find("form"),".idea-task .content")})}n.IdeaTask.showTask=function(e,t){o.bbq.pushState({task:e,isTask:t})},n.IdeaTask.initialize=function(e,t,i,a){c=i||!1,r=e+"/",l=t,s=a||"",o(document).on("click",".idea-task-title, .idea-task .min-or-max",function(){var e=o(this).parents(".idea-task");e.hasClass("open")?e.removeClass("open"):e.addClass("open")}),o(document).on("click",".task-bottom-section .close-btn, .idea-task-title .close-btn",function(){c?window.history.back():(o(this).parents(".idea-task").hide(),o.bbq.removeState("task"))}),o(document).on("click",".view-task",function(e){if(!c){e.preventDefault();var t=o(this).data("task-id"),i=o(this).data("is-task");n.IdeaTask.showTask(t,i),o(".main-dialogbox.in").modal("hide")}}),function(){if(c)u(o(".main-content-inner").find("form"),".main-content-inner");else{var e=o.bbq.getState("task"),t=o.bbq.getState("isTask");null!=e&&p(e,t)}"dashboard"==o.bbq.getState("return")&&(d=!0)}(),o(window).on("hashchange",function(e){var t=o.bbq.getState("task"),i=o.bbq.getState("isTask");null!=t?p(t,i):0<o(".idea-task.open").length||o("#bottom-menu .idea-task").hide()})},n.IdeaTask.initializeFrontDashboard=function(e){c=e||!1,o(document).on("click",".view-task",function(e){e.preventDefault();var t=o(this).attr("href");if(c)location.href=t+="#return=dashboard";else{var i=o(this).data("task-id");location.href=t+="#task="+i+"&return=dashboard"}})}}(window.Brainbank=window.Brainbank||{},jQuery),function(n){var t,i=n([]);function a(){i.each(function(){var e=n(this),t=e.width(),i=e.height(),a=e.data("resize");t===a.w&&i===a.h||(a.w=t,a.h=i,e.triggerHandler("resize"))}),t=setTimeout(a,250)}n.event.special.resize={setup:function(){var e=n(this);i=i.add(e),e.data("resize",{w:e.width(),h:e.height()}),1===i.length&&a()},teardown:function(){var e=n(this);i=i.not(e),e.removeData("resize"),i.length||clearTimeout(t)}}}(jQuery),function(u,T,l){var I,E,A,D,L,F,$;u.Ideas=u.Ideas||{};var O,P,V,_,H,r,U,s,d,z,R,j,N,M,a,q=!1,G=!1,K=!1,n=1,o=T(window).outerHeight()/3,c=!1,W=!1,Q='<div class="contentLoader"><svg version = "1.1" id = "L7" xmlns = "http://www.w3.org/2000/svg" xmlns: xlink = "http://www.w3.org/1999/xlink" x = "0px" y = "0px" viewBox = "0 0 100 100" enable-background="new 0 0 100 100" xml: space = "preserve" > <path fill="#025A9A" d="M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3 c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="2s" from="0 50 50" to="360 50 50" repeatCount="indefinite" /> </path> <path fill="#025A9A" d="M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7 c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="-360 50 50" repeatCount="indefinite" /> </path> <path fill="#f7941d" d="M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5 L82,35.7z"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="2s" from="0 50 50" to="360 50 50" repeatCount="indefinite" /> </path> </svg></div>';unreadDropdown="";var p,J,h,f,v=0,m=-1,g=!1,b=[],w=!1,X=!1,Y=!1,y=!1,Z=0,ee=0,te=1;function ie(e){0!=e.parents(".myfilters").length?T(".myfilters").addClass("active"):T(".myfilters").removeClass("active")}function ae(i){if(0<T(".idealist-view").length&&T(".idealist-view").css("pointer-events","none"),(O||G)&&(T(".scrollUpBanner").hide(),T(".ideaListPageLoadTop").show(),-1<window.location.pathname.toLowerCase().indexOf("/ideas")&&"challenge"==window.localStorage.getItem("challengeOrIdea")?(window.localStorage.challengeOrIdea="idea",window.localStorage.removeItem("lastIdeaClicked")):-1<window.location.pathname.toLowerCase().indexOf("/challenges/")&&"idea"==window.localStorage.getItem("challengeOrIdea")&&(window.localStorage.challengeOrIdea="challenge",window.localStorage.removeItem("lastIdeaClicked"))),i&&T("input#CurrentPage").val(i),N){var e=T(".idealist-right-side #filter-form-post #filters").clone();T(".new-idea-theme-menu #filter-form-post").append(e);var t=T(".new-idea-theme-menu #filter-form-post").formSerialize();T(".new-idea-theme-menu #filter-form-post #filters").remove(),!1}else t=T("#filter-form-post").formSerialize();n=0<T("#currentPageSize").length?parseInt(T("#currentPageSize").val()):n,T.post(A+"?isTitleView="+q,t).done(function(e){if(N&&(T(".contentLoader").remove(),fe()),O||G){if(G)if(X)0==T("#ideaTileView").length&&(T("#idea-list").children().remove(),T("#idea-list").append('<div id="ideaTileView" class="expanding-grid"><div class="links"></div></div><div class="clearfix"></div>')),T("div#idea-list #ideaTileView .links").html(e),re(),X=!1;else if(0==T("#ideaTileView").length&&(T("#idea-list").children().remove(),T("#idea-list").append('<div id="ideaTileView" class="expanding-grid"><div class="links"></div></div><div class="clearfix"></div>')),te<i)T("#idea-list #ideaTileView .links").append(e);else{var t=T("div[data-idea-info]:first");T("#idea-list #ideaTileView .links").prepend(e),0<t.length&&T(document).scrollTop(t.offset().top-80)}else if(K||q)if(X)T("div#idea-list").html(e),re(),X=!1;else if(te<i)T("div#idea-list").append(e);else{t=T("div[data-idea-info]:first");T("div#idea-list").prepend(e),0<t.length&&T(document).scrollTop(t.offset().top-60)}1==i&&(Y=!0),y=(e.match(/data-idea-info/g)||[]).length<n,T(".ideaListPageLoadBottom").hide(),T(".ideaListPageLoadTop").hide(),Y?T(".scrollUpBanner").hide():T(".scrollUpBanner").show(),1<=parseInt(he("page"))&&i==te&&window.localStorage.lastIdeaClicked&&0<T('div[data-idea-info="'+window.localStorage.getItem("lastIdeaClicked")+'"]').length&&window.scrollTo(0,T('div[data-idea-info="'+window.localStorage.getItem("lastIdeaClicked")+'"]').offset().top-60),w=W=!1}else T("div#idea-list").html(e),-1<window.location.href.indexOf("/Challenges/")&&1<=parseInt(he("page"))?T("html, body").animate({scrollTop:T(".challenge-view-responses").offset().top},500):-1==window.location.href.indexOf("/Challenges/")&&T(window).scrollTop(0),re();0<T(".idealist-view").length&&T(".idealist-view").css("pointer-events","all"),c&&T(".showGauges").click()})}function ne(i,e){var a=!0;N?T(".idealist-right-side div#filters").filter(":hidden").length&&(a=!1):T("div#idea-list-Filter div#filters").filter(":hidden").length&&(a=!1),T.get(E,{key:i,challengeid:T("input#ChallengeId").val(),categoryIds:T("#CategoryIds").val(),filterCount:e}).done(function(e){N?T(".idealist-right-side form").replaceWith(e):T("div#idea-list-Filter").html(e),T('[data-filter-key="'+i+'"]',"#idea-list-Filters").addClass("active"),N?T('[data-filter-key!="'+i+'"]',"#idea-list-Filters").not(".changeIdeaLayout img").removeClass("active"):T('[data-filter-key!="'+i+'"]',"#idea-list-Filters").removeClass("active"),ie(T('[data-filter-key="'+i+'"]')),a&&(T("#showfilter a").html(r),T("div#filters").toggle("fade"));var t=T(".sort-hidden").val();T("#sortbar a[data-sort='"+t+"']").addClass("active"),N&&T("#currentIdeaSortOption .sortOptionName").text(T(".new-idea-theme-sorts #sortbar li a[data-sort='"+t+"']").text()),ce(!1),"true"!=T("#showDependentFilterConfig").val()||(g=!(m=-1),p="",v=0,b=[],le(),se()),ae(1)})}function oe(e,t){u.DialogBox.show({remote:H+"?key="+e,title:t,validateButtonLabel:s,validateButtonAction:function(){var e=T(".main-dialogbox:last"),t=e.find(".modal-body form").attr("id");if(0<e.find("#createNewChoice:checked").length||0<e.find("input#CreateNewFilter").length){var i=e.find(".modal-body form #Name").val().trim(),a=e.find(".modal-body form #Description").val();i?(T("#Key").val(t),T("#Name_Original").val(i),T("#Description_Original").val(a),C(),e.modal("hide")):k(T("#"+t))}else""!=T("#Name_Original").val()?(C(),e.modal("hide")):k(T("#"+t))},closeAfterValidate:!1,closeButtonLabel:d})}function C(){var t=T("#Key").val();if(N){var e=T(".idealist-right-side #filter-form-post #filters").clone();T(".new-idea-theme-menu #filter-form-post").append(e);var i=T(".new-idea-theme-menu #filter-form-post").formSerialize();T(".new-idea-theme-menu #filter-form-post #filters").remove()}else i=T("#filter-form-post").formSerialize();T.post(L,i).done(function(e){N?(X=!0,T(".new-idea-theme-tabs").html(e),T("#currentActiveFilterApplied").text(T(".menu-my-filters li:last a").text()),T(".idealist-right-side #filter-form-post #filters").hide(),T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)):T("div#idea-list-Filters div.sort-menu").html(e),"KeywordSearch"==t&&(t=T("li[data-filter-key]").last().attr("data-filter-key")),ne(t,1),N||ae(1)})}function k(e){var t=e.find("#Name"),i=t.prev(".field-validation-valid");i.html(t.desktop-idea-menudata("val-required")),i.addClass("field-validation-error"),i.show()}function x(e){0<T("#collaboratorsLeaderboard").length&&(e=T(".idealist-left-side").offset().top),T(window).scrollTop()>e?(T(".idealist-left-side").addClass("new-idealist-left-affix"),T(".idealist-right-side").addClass("new-idealist-right-affix")):(T(".idealist-left-side").removeClass("new-idealist-left-affix"),T(".idealist-right-side").removeClass("new-idealist-right-affix"))}function re(){N&&(a=T(".idealist-left-side").offset().top),O||G?T(window).on("scroll",function(){if(N&&x(a),T(window).scrollTop()>o?T(".m-backtotop").addClass("active"):T(".m-backtotop").removeClass("active"),!W)if(T(".scrollUpBanner").is(":visible")&&T(this).scrollTop()<T(".scrollUpBanner").offset().top-100)w||!T(".scrollUpBanner").is(":visible")||Y||(w=!0,ae(te-(ee+=1)));else{var e=T("#idea-list"),t=e.offset().top+parseInt(e.height()),i=T(this).scrollTop()+parseInt(T(window).height());T(document.body)[0].scrollHeight>T(window).height()&&!y&&t<i&&(w||T("#idea-list-Filter #filters").is(":visible")||(T(".ideaListPageLoadBottom").show(),w=!0,Z+=1,0==T(".contentLoader").length&&ae(te+Z)))}}):(T("#idea-list").unbind().on("click","div#list-pagination a",function(e){e.preventDefault(),c="none"!=T("div.idea-details .AI-Algorithm").first().css("display"),ae(T(this).parent().attr("data-page"))}),T(window).on("scroll",function(){N&&x(a),T(window).scrollTop()>o?T(".m-backtotop").addClass("active"):T(".m-backtotop").removeClass("active")}))}function le(){var e,t=!!T("#dependentfiltersIsAlwaysMultiple").val();e={keys:T("#filter-form-post #SelectedCategory").val(),isAlwaysMultiple:t},T.ajax({url:J,async:!1,data:e,success:function(e){f=e.IdeaCountByCategoryList,S(T.grep(f,function(e){return 1==e.ParentId}),0,h,t)}})}function S(e,t,i,a,n,o){var r;0==v?((p=document.createElement("div")).setAttribute("id","parentSelect"),p.setAttribute("class","dependentFilterPad"+v+"Div"),p.setAttribute("divCount",v)):((p=document.createElement("div")).setAttribute("parentId",t),p.setAttribute("divCount",parseInt(a)+1)),v++,r=m<T("#filter-form-post #SelectedCategory").val().split("</br>").length-1?T("#filter-form-post #SelectedCategory").val():"";var l="";0,l='<div parentId="'+t+'"><strong>'+i+"</strong>";for(var s=b.length=0;s<e.length;s+=1){var d="";""!=r&&""!==(d=-1<r.split("</br>").indexOf(e[s].CategoryId.toString())?"checked":"")&&(b.push({index:r.split("</br>").indexOf(e[s].CategoryId.toString())}),g=!0,0),l+=' <div class="'+e[s].CategoryName.Translation+' indentedCategory"><input type="checkbox" onchange="Brainbank.Ideas.showChildrenDropDown.call(this, this.value, false);" id="'+e[s].CategoryId+'" value="'+e[s].CategoryId+'" '+d+" >"+e[s].CategoryName.Translation+"</input></div>"}if(l+="</div>",p.innerHTML=l,1==v?(T("#section_DependentFilters").append(p),T("div[parentid=0]").attr("class","section-dependentfilter-dropdown well well-small pull-left"),T(".section-dependentfilter-dropdown").after('<div class="pull-left dependentFilterPad'+v+'Div"></div>')):(T(".dependentFilterPad"+(parseInt(a)+1)+"Div").attr("class","section-dependentfilter-dropdown well well-small pull-left dependentFilterPad"+(parseInt(a)+1)+"Div"),T(".dependentFilterPad"+(parseInt(a)+1)+"Div").append(p),0==T(".dependentFilterPad"+(parseInt(a)+2)+"Div").length&&T(".dependentFilterPad"+(parseInt(a)+1)+"Div").after('<div class="pull-left dependentFilterPad'+(parseInt(a)+2)+'Div"></div>')),T(n).prop("disabled",!1),T(".submit-dependentFilter").css("display","inline-block"),4<=T(".dependentFilterHead .well.well-small.pull-left").length?T(".dependentFilterHead .well.well-small.pull-left").addClass("overFilter").removeClass("underFilter"):T(".dependentFilterHead .well.well-small.pull-left").addClass("underFilter").removeClass("overFilter"),g){var c=r.split("</br>");m++,T(e).each(function(){-1<c.indexOf(""+this.CategoryId)&&u.Ideas.showChildrenDropDown(this.CategoryId,!0,o)})}}function se(){var e=[],t=[];T("#parentSelect input:checked").each(function(){t.push(T(this).parents().eq(1).attr("parentId")),e.push(T(this).attr("value"))});for(var i=0;i<t.length;i++)0<=e.indexOf(t[i])&&e.splice(e.indexOf(t[i]),1);e=e.join(","),T("#filter-form-post #SelectedCategory").val(e)}function de(){if(T("#ideaTileView").is(":visible")){var e=0,t=0,i=0,a=0;T(".equalize-idea-title").each(function(){T(this).height()>e&&(e=T(this).height())}),T(".equalize-idea-title").css("height",e+"px"),T(".equalize-idea-author-date").each(function(){T(this).height()>a&&(a=T(this).height())}),T(".equalize-idea-author-date").css("height",a+"px"),T(".equalize-idea-desc").each(function(){T(this).height()>t&&(t=T(this).height())}),T(".equalize-idea-desc").css("height",t+"px"),T(".equalize-idea-card").each(function(){T(this).height()>i&&(i=T(this).height())}),T(".equalize-idea-card").css("height",i)}}function ce(t){if(_&&z){var e=T("#filter-form-post").formSerialize();e=(e=e.replace("ShowUserUnreadIdeas=false","ShowUserUnreadIdeas=true")).replace("ShowUserUnreadIdeas=False","ShowUserUnreadIdeas=true"),T.post(I,e).done(function(e){T(".badge-unread-count").each(function(){T(this).remove()}),"0"!=e?N?(0<T(".new-idea-filter-dropdown .items.active").length?T(".new-idea-filter-dropdown #currentActiveFilterApplied").after('<span class="badge badge-unread-count">'+e+"</span>"):0<T(".myfilters li.active").length?T(".myfilters > a.dropdown-toggle .caret").before('<span class="badge badge-unread-count">'+e+"</span>"):0<T("#LastSearch.active").length&&T("#LastSearch a").append('<span class="badge badge-unread-count">'+e+"</span>"),T(".new-idea-theme-sorts #currentIdeaUnreadOption .unreadOptionName").text(T('#new-idea-theme-unread a[unread-value="'+unreadDropdown+'"]').text())):(T(".desktop-idea-menu.nav.nav-tabs li.active a").append('<span class="badge badge-unread-count">'+e+"</span>"),T("#unreadViewDropdown select").val(unreadDropdown)):unreadDropdown=(N?T(".new-idea-theme-sorts #currentIdeaUnreadOption .unreadOptionName").text(T('#new-idea-theme-unread a[unread-value="all"]').text()):T("#unreadViewDropdown select").val("all"),"all"),"unread"==unreadDropdown?T("#ShowUserUnreadIdeas").attr("value","True"):T("#ShowUserUnreadIdeas").attr("value","False"),t&&ae(1)})}}function ue(i){T.ajax({url:V,type:"POST",data:i,contentType:"text/plain",success:function(e){var t=i.split(",");T(t).each(function(e){0<T(".item.viewToggle").length?T('.dog-ear[data-idea-id="'+t[e]+'"]').parent().css("background-image","none"):T('.dog-ear[data-idea-id="'+t[e]+'"]').hide()}),ce(!0)}})}function pe(){"False"==T("#ShowUserUnreadIdeas").val()||"false"==T("#ShowUserUnreadIdeas").val()?N?T(".new-idea-theme-sorts #currentIdeaUnreadOption .unreadOptionName").text(T('#new-idea-theme-unread a[unread-value="all"]').text()):T("#unreadViewDropdown select").val("all"):N?T(".new-idea-theme-sorts #currentIdeaUnreadOption .unreadOptionName").text(T('#new-idea-theme-unread a[unread-value="unread"]').text()):T("#unreadViewDropdown select").val("unread"),N||T("#unreadViewDropdown").show()}u.Ideas.showChildrenDropDown=function(t,e,i){var a=this,n="",o="";if(e&&(a=T("#"+t)[0]),void 0!==a)if(T(a).prop("disabled",!0),a.checked){var r=T.grep(f,function(e){return e.ParentId==t});"0"==T(a).parents().eq(1).attr("parentid")?n=T(a).parent().text().split(" (")[0]:(n=T(a).parent().text().split(" (")[0],!(o=T(a).parent().parent().find("strong").text())!=l&&""!=!o||(n=o+" | "+n)),0!==r.length?S(r,a.value,n,T(a).parents().eq(2).attr("divcount"),a,i):T(a).prop("disabled",!1)}else T(a).prop("disabled",!1),function e(t){var i=T("div[parentId="+t+"] :input");var a=T(T("div[parentId="+t+"]")[0]).parent();T("div[parentId="+t+"]").remove();""==a.text()&&a.removeClass("well well-small pull-left");for(var n=0;n<i.length;n++)e(i[n].value);4<=T(".dependentFilterHead .well.well-small.pull-left").length?T(".dependentFilterHead .well.well-small.pull-left").addClass("overFilter").removeClass("underFilter"):T(".dependentFilterHead .well.well-small.pull-left").addClass("underFilter").removeClass("overFilter")}(a.value)},function(x,S,r){"use strict";function B(e){for(var t=e,i=e.offsetTop;null!==t.nextElementSibling;){if(t.nextElementSibling.offsetTop>i)return t;t=t.nextElementSibling}return t}function t(e,t){function s(e,t,i,a){var n,o=0,r=function(e,t){var i,a,n=x(S).scrollTop(),o=x(S).height();return e<=n?e-n:t<=n+o?0:(i=e-n,a=t-(n+o),Math.min(i,a))}(e,t),l=x(S).scrollTop();i=void 0===i?u.animationDuration:i,n=i;var s=(new Date).getTime(),d=s,c=function(){var e=0===(n=Math.max(i-(new Date-s),0))||0===r?0:(new Date-d)/n*r,t=0<r?Math.min(e,r):Math.max(e,r);r-=t,o+=t,S.scrollTo(0,l+o),(d=(new Date).getTime())-s<=i?S.requestAnimationFrame&&requestAnimationFrame(c)||setTimeout(c,16):"function"==typeof a&&a()};c()}var u=x.extend({},{animationDuration:250,linksSelector:".links a.idea-expand-btn",expandingAreaSelector:".expanding-container",closeButtonMarkup:'<a href="#" class="close-button">Close</a>',spacerMarkup:'<span class="spacer" aria-hidden="true"/>',elementActiveClass:"active",elementExpandedClass:"expanded",onExpandBefore:!1,onExpandAfter:!1},t),d=!1,n=!1,o=!1,c=!1,p=!1,h=!1,f=!1,v=!1,m=x(u.linksSelector,e),g=x(u.expandingAreaSelector,e),b=x(u.closeButtonMarkup),w=x(u.spacerMarkup),y=w.clone();m.each(function(){var i=x(this),e=i.attr("href").match(/#([^\?]+)/)[1],a=r.getElementById(e),t=!1;x._data(this,"events")==l?t=!1:0<x._data(this,"events").click.length&&(t=!0),a&&(t||i.click(function(e){var r,t,l=this;e.preventDefault(),d&&n===l?b.click():(m.removeClass(u.elementActiveClass).filter(i).addClass(u.elementActiveClass).parents().eq(3).each(function(){x(".expanded").css({display:"none"});var e=B(this);(f=e!==h)&&(h=e),d&&f&&(y.height(w.height()),w.height(0).replaceWith(y)),x(h).after(w)}),d&&f&&(y.animate({height:0},u.animationDuration,function(){x(this).detach()}),b.removeClass(u.elementActiveClass).hide()),r=y.position().top<w.position().top?y.height():0,c=w.position().top-r,g.removeClass(u.elementExpandedClass).hide().filter(a).each(function(){var t=x(this),e=t.height(),i=t.outerHeight(),a=d&&p&&!1===f?p:0;C(),w.animate({height:e+"px"},u.animationDuration),t.css({height:a+"px",position:"absolute",left:0,top:w.position().top+"px"}).show(0,function(){"function"==typeof u.onExpandBefore&&u.onExpandBefore.call(this)}).animate({height:e+"px",top:c+"px"},u.animationDuration,function(){t.css({height:"auto"}).addClass(u.elementExpandedClass),p=t.height(),v=setInterval(function(){var e=t.height();e!==p&&(p=e,k())},1e3),"function"==typeof u.onExpandAfter&&u.onExpandAfter.call(this)});var n=x(l).offset().top-r,o=t.offset().top+i+20-r;s(n,o)}),t=d&&f&&i.parent().index()>x(n).parent().index()?u.animationDuration:u.animationDuration/4,b.css({position:"absolute",right:0,top:c+"px"}).delay(t).fadeIn(u.animationDuration,function(){x(this).addClass(u.elementActiveClass)}),n=this,o=a,d=!0),x(".idea-expand-btn em.icon-circle_minus:not(.idea-expand-btn.active em)").each(function(){x(this).removeClass("icon-circle_minus").addClass("icon-circle_plus")}),x(x(this).children()[0]).hasClass("icon-circle_plus")&&d?x(x(this).children()[0]).removeClass("icon-circle_plus").addClass("icon-circle_minus"):x(x(this).children()[0]).hasClass("icon-circle_minus")&&d&&x(x(this).children()[0]).removeClass("icon-circle_minus").addClass("icon-circle_plus")}))}),b.appendTo(e).hide().click(function(e){var t=x(n),i=t.offset().top,a=i+t.outerHeight();e.preventDefault(),m.removeClass(u.elementActiveClass),g.slideUp(u.animationDuration).removeClass(u.elementExpandedClass),b.removeClass("active").hide(),w.animate({height:0},u.animationDuration,function(){w.detach()}),s(i,a),C(),o=n=d=!1});var C=function(){v&&clearInterval(v)},k=function(){o&&d&&(w.height(x(o).height()),c=w.position().top,b.add(o).css({top:c+"px"}))};x(S).resize(function(){d&&(function(){var e;n&&h&&d&&(w.detach(),e=B(x(n).parent()[0]),h!==e&&(console.log(e),h=e),x(h).after(w))}(),k())})}x.fn.expandingGrid=function(e){return this.each(function(){t(this,e)})}}(jQuery,window,document);var he=function(e){var t,i,a=decodeURIComponent(window.location.search.substring(1)).split("&");for(i=0;i<a.length;i++)if((t=a[i].split("="))[0]===e)return t[1]===l?1:t[1]};function fe(){T(".idealist-right-side #filter-form-post #currentIdeaSortOption, .idealist-right-side #filter-form-post #sortbar, .idealist-right-side #filter-form-post #new-idea-theme-unread, .idealist-right-side #filter-form-post #createIdeaToBoard, .idealist-right-side #filter-form-post #downloadfilebutton1").remove(),T("#idea-list-Filters #filter-form-post #filters").remove(),T(".idealist-right-side #filter-form-post").css("display","block")}u.Ideas.updateCommentCount=function(e){if(K){if(0<T(".new-idea-theme-layout").length)a=parseInt(T(".idea-direct-comment-"+e).text())+1;else{var t=T(".idea-direct-comment-"+e).text().indexOf("(")+1,i=T(".idea-direct-comment-"+e).text().indexOf(")"),a=T(".idea-direct-comment-"+e).text().substr(0,t),n=T(".idea-direct-comment-"+e).text().substring(t,i);a+=parseInt(n)+1+")"}T(".idea-direct-comment-"+e).text(a)}else if(G){a=parseInt(T(".idea-direct-comment-"+e).text())+1;T(".idea-direct-comment-"+e).text(a)}},u.Ideas.InitializeGauges=function(e,t){u.JsGauges.setDefaultSettings(JSON.parse(t)),u.JsGauges.json=JSON.parse(e),T(".chart").each(function(e,t){u.JsGauges.placeDivs(t,e)})},u.Ideas.addTranslation=function(e,t,i,a,n,o){r=e,R=t,h=i,U=a,s=n,d=o},u.Ideas.initialize=function(e,t,i,a,n,o,r,l,s,d,c,u,p,h,f,v,m,g,b,w,y){I=e,E=t,A=i,D=a,L=n,F=o,H=r,J=s,$=d,P=c,q=u,G=p,K=h,V=f,_=v,O=m,N=b,j=w,M=y,z=g,ce(!1),T(document).on("click","div.sort-menu .items a, .new-idea-theme-tabs .new-idea-filter-dropdown ul li.items a, .new-idea-theme-tabs ul.menu-my-filters .items a, .new-idea-theme-tabs #LastSearch",function(e){if(e.preventDefault(),te=1,Y=X=!0,ee=Z=0,N&&("LastSearch"!=T(this).attr("id")&&T("#currentActiveFilterApplied").text(T(this).text()),T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)),T(this).parent().hasClass("myfilters"))return!0;var t=T(this).parent(),i=t.attr("data-filter-key"),a=t.attr("data-filter-count");"KeywordSearch"==i?window.location.reload():ne(i,a)}),re(),N&&fe(),pe(),T("div#idea-list-Filter, .new-idea-theme-sorts").on("click","#sortbar a[data-sort]",function(e){if(e.preventDefault(),te=1,Y=X=!0,ee=Z=0,N){var t=T(this).attr("data-sort");T("#currentIdeaSortOption .sortOptionName").text(T(".new-idea-theme-sorts li a[data-sort='"+t+"']").text()),T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)}else{T(this).addClass("active");t=T(this).attr("data-sort")}T(".sort-hidden").val(t),ae(1),T("#sortbar a[data-sort!='"+t+"']").removeClass("active")}),T(document).on("click","div#idea-list-Filter input#gobutton, .new-idea-theme-layout #filters input#gobutton",function(e){e.preventDefault(),T("#IsSearch").val(!0),T("#filters").hide(),T("#showfilter a").html(R);var t=T("#createIdeaToBoard a");if(0<t.length){var i=t.attr("data-dialog-href").replace(/filterIsSearched=False/i,"filterIsSearched=True");T("#createIdeaToBoard a").attr("data-dialog-href",i)}te=1,Y=X=!0,ee=Z=0,N&&(T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q),!0),ae(1)}),T(document).on("click","input#downloadfilebutton1",function(e){e.preventDefault(),T("#is-search").val(!0),T("#filters").hide(),T("#showfilter a").html(R),function(){var e=T("#filter-form-post").formSerialize(),t='<button type="button" id="closeAlertExport" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>';T.post(D,e,function(e){}).done(function(){T("#downloadfileAlert").show(),document.getElementById("requestExport").innerHTML=t+"Your file is being generated. Please check your email for a link to download the file. Depending on the size of the export this may take a few minutes."}).fail(function(){var e=document.getElementById("requestExport");T("#requestExport").toggleClass("notification alert-error"),e.innerHTML=t+"Your request has failed. Please try again.",T("#downloadfileAlert").show()})}()}),T(document).on("click",".desktop-idea-menu a, .new-idea-theme-tabs .new-idea-filter-dropdown li.items a, .new-idea-theme-tabs ul.menu-my-filters .items a, .new-idea-theme-tabs #LastSearch",function(e){e.preventDefault(),T("#downloadfileAlert").hide()}),T(document).on("click","#closeAlertExport",function(e){e.preventDefault(),T("#downloadfileAlert").hide()}),T(document).on("click",".savebutton",function(e){var t=T(this).attr("data-title"),i=T("input#Key").val();"KeywordSearch"==i?oe(i,t):oe("True"==T("input#IsSystemFilter").val()?"SystemFilter":i,t)}),T("#sorting-dropdown").change(function(){var e=T(this).val();T(".sort-hidden").val(e),ae(1)}),T(".submit-dependentFilter").on("click",function(){T(this).css("display","none")}),T("#idea-list-Filter").on("click","input#dependentfilter",function(){se(),T("#is-search").val(!0),te=1,X=Y=!(ee=Z=0),N&&(T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)),ae(1)}),T("#categories-dropdown").change(function(){T("#filter-form-post #SelectedCategory").val(T(this).val()),T("#is-search").val(!0),ae(1)}),T("div#idea-list-Filter").on("click","input#deletebutton",function(e){!function(e){var t=T('.sort-menu li[data-filter-key="'+e+'"]').prev().attr("data-filter-key"),i=T('.sort-menu li[data-filter-key="'+e+'"]').attr("data-filter-count");(t=t||T(".sort-menu div[data-filter-key]").last().attr("data-filter-key"))&&T.post(F,{key:e}).done(function(e){T("div#idea-list-Filters div.sort-menu").html(e),ne(t,i)})}(T("input#Key").val())}),ie(T('[data-filter-key="'+l+'"]').addClass("active"));var C=T(".sort-hidden").val();T("#sortbar a[data-sort='"+C+"']").addClass("active"),N&&(T("#currentIdeaSortOption .sortOptionName").text(T(".new-idea-theme-sorts li a[data-sort='"+C+"']").text()),""==T(".new-idea-theme-tabs .items.active").text()&&T(".new-idea-theme-tabs .items:first-of-type").addClass("active"),T("#currentActiveFilterApplied").text(""!=T(".new-idea-theme-tabs .items.active").text()?T(".new-idea-theme-tabs .items.active").text():T(".new-idea-theme-tabs .items:first-of-type").text()),T(".idea-list-title").after(T(".idealist-submit-idea.mobile-submit")),(0<T("#createIdeaToBoard").length||0<T("#downloadfilebutton1").length)&&(0<T(".idea-list-title").length?T(".idea-list-title").after('<div class="pull-right userTitleOptions"></div>'):T(".challenge-view-responses").prepend('<div class="pull-right userTitleOptions"></div>'),T(".userTitleOptions").append(T("#createIdeaToBoard")),T(".userTitleOptions").append(T("#downloadfilebutton1")),T("#createIdeaToBoard, #downloadfilebutton1").show()));var k=T("#showDependentFilterConfig").val(),x=T(".sort-menu li.active").attr("data-filter-count");if("true"!=k||(0!=x&&T("#filter-form-post #SelectedCategory").val(""),le(),se()),1<(te=1<=parseInt(he("page"))?parseInt(he("page")):1)?T("#idea-list").before('<div class="scrollUpBanner alert alert-info" style="text-align: center;"> <button type="button" class="close" data-dismiss="alert">Ã—</button><i class="icon-arrow-up" style="margin-right: 5px;"></i>'+U+'<i class="icon-arrow-up" style="margin-left: 6px;"></i></div>'):Y=!0,ae(te),T("#view-mode-select > li > a").click(function(e){T("#view-mode-select > li > a").removeClass("selected"),T(this).addClass("selected")}),T("#ideaListBtn, #new-idea-theme-list-light").on("click",function(e){W=!0;var t=P+"?ideaListView=list&ChallengeListView="+$;T.ajax({type:"POST",url:t,complete:function(){te=1,K=!(G=q=!(X=Y=!(ee=Z=0))),N&&(T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)),ae(1),T("#idea-list-Filters").show(),T("#new-idea-theme-list-light").removeClass("active"),T("#new-idea-theme-list").addClass("active"),T("#new-idea-theme-tile-light").addClass("active"),T("#new-idea-theme-tile").removeClass("active")}})}),T("#ideaTileBtn, #new-idea-theme-tile-light").on("click",function(e){W=!0;var t=P+"?ideaListView=card&ChallengeListView="+$;T.ajax({type:"POST",url:t,complete:function(){X=!(K=q=!(G=!0)),te=1,Y=!(ee=Z=0),N&&(T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)),ae(1),T("#idea-list-Filters").show(),T("#new-idea-theme-tile-light").removeClass("active"),T("#new-idea-theme-tile").addClass("active"),T("#new-idea-theme-list-light").addClass("active"),T("#new-idea-theme-list").removeClass("active")}})}),T("#ideaTitleBtn").on("click",function(e){W=!0;var t=P+"?ideaListView=title&ChallengeListView="+$;T.ajax({type:"POST",url:t,complete:function(){te=1<=parseInt(he("page"))?parseInt(he("page")):1,X=!(K=G=!(q=!0)),te=1,Y=!(ee=Z=0),N&&(T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)),ae(1),T("#idea-list-Filters").show()}})}),T(document).on("click",".dog-ear",function(){ue(T(this).attr("data-idea-id").toString())}),T(document).on("change, click","#unreadViewDropdown select, #new-idea-theme-unread ul.dropdown-menu li a",function(){if(event.preventDefault(),te=1,X=Y=!(ee=Z=0),N){if("all"==T(this).attr("unread-value"))T("#ShowUserUnreadIdeas").attr("value","False"),0<T("#ideaTileView").length&&T("#ideaTileView").remove(),ae(1),unreadDropdown=T(this).attr("unread-value");else if("unread"==T(this).attr("unread-value"))T("#ShowUserUnreadIdeas").attr("value","True"),0<T("#ideaTileView").length&&T("#ideaTileView").remove(),ae(1),unreadDropdown=T(this).attr("unread-value");else{var e="";T(".dog-ear").each(function(){e+=T(this).attr("data-idea-id")+","}),ue(e=e.slice(0,-1))}T(".idealist-right-side #idea-list").children().remove(),T(".idealist-right-side #idea-list").append(Q)}else if("all"==this.value)T("#ShowUserUnreadIdeas").attr("value","False"),0<T("#ideaTileView").length&&T("#ideaTileView").remove(),ae(1),unreadDropdown=this.value;else if("unread"==this.value)T("#ShowUserUnreadIdeas").attr("value","True"),0<T("#ideaTileView").length&&T("#ideaTileView").remove(),ae(1),unreadDropdown=this.value;else{e="";T(".dog-ear").each(function(){e+=T(this).attr("data-idea-id")+","}),ue(e=e.slice(0,-1))}}),T(".m-backtotop").click(function(){return W=!0,1<=parseInt(he("page"))&&(te=1,Y=X=!0,Z=0,window.localStorage.lastIdeaClicked&&window.localStorage.removeItem("lastIdeaClicked"),ae(1)),T("html, body").animate({scrollTop:0},"slow",function(){W=!1}),!1}),T(document).on("click","div[data-idea-info]",function(){window.localStorage.lastIdeaClicked=T(this).attr("data-idea-info")}),de(),0<T(".challenge-view-responses").length)var S=T("#currentChallengeID").val(),B=j+"?dateCriteria=7&inChallenge="+S+"&notInStatus=3,6&numberOfRow=5&sort=points";else B=j+"?dateCriteria=7&notInStatus=3,6&numberOfRow=5&sort=points";T.ajax({url:B,success:function(e){var a="";T(e.Items).each(function(){var e="",t="",i=M+"ideas/"+this.ID;e=""==this.Thumbnail?"//d32ekf2zat2q3c.cloudfront.net/Idealink/images/icon-default-thumb.png":urlContent.replace("{blobkey}","")+this.Thumbnail,t=25<this.Title.length?this.Title.substring(this.Title,22)+"...":this.Title,a+='<div class="row"><div class="column-left flex-grow-2"><div class="divider-2"><div class="idea-img"><img alt="'+this.Title+'" src="'+e+'"></div><div class="idea-info"><p class="lead leaderboard-idea-title"><a href="'+i+'">'+t+'</a></p><div class="idea-stats"><span class="votes"><i class="icon-thumbs-up"></i> '+this.VoteValue+'</span><span class="comments"><i class="icon-comment"></i> '+this.CommentCount+'</span><span class="views"><i class="icon-eye-open"></i> '+this.ViewCount+"</span></div></div></div></div></div>"}),T(".new-idea-theme-layout #trendingIdeasLeaderboard .content .leaderboardloader").remove(),""!=a?T("#trendingIdeasLeaderboard .content").html(a):T("#trendingIdeasLeaderboard .content .no-data").show()}})},T(window).resize(function(){N&&(a=T(".idealist-left-side").offset().top)}),T(document).ajaxComplete(function(){pe()}),T(document).ajaxStop(function(){T(".expanding-grid").expandingGrid(),T(".dog-ear i, .new-idealist-idea-number-icon").tooltip(),de(),unreadDropdown=0<T("#unreadViewDropdown select").length?T("#unreadViewDropdown select").val():T("#new-idea-theme-unread li a").attr("unread-value")})}(window.Brainbank=window.Brainbank||{},jQuery),function(e,l){e.UserActivity=e.UserActivity||{};var r,s,d,c,u,i,t,p,a,n,o,h,f,v,m,g,b,w,y,C,k,x,S=[],B=[],T=[];function I(){l(document).ajaxComplete(function(){Highcharts.chart("SessionChart_container",{chart:{type:"line"},title:{text:"",style:{color:"#0769A5",fontWeight:"bold"}},credits:{enabled:!1},xAxis:[{categories:S,crosshair:!0}],yAxis:{allowDecimals:!1,title:{text:""}},legend:{itemStyle:{color:"#848383",fontFamily:'"open_sansregular" ,"Helvetica Neue",Helvetica,Arial,sans-serif'}},series:[{name:"Sessions",data:B}]})})}e.UserActivity=e.useractivity||{},e.UserActivity.initialize=function(e,t){S=t,B=e,I()},e.UserActivity.initializepageViewPerDay=function(e,t){n=e,o=t,Highcharts.chart("pageViewPerDay",{chart:{type:"column",height:250},credits:{enabled:!1},title:{text:"",style:{color:"#0769A5",fontWeight:"bold",fontFamily:'"open_sansregular" ,"Helvetica Neue",Helvetica,Arial,sans-serif'}},xAxis:{categories:n},yAxis:{visible:!1,title:{text:""}},plotOptions:{series:{pointWidth:20}},legend:{itemStyle:{color:"#848383"}},series:[{name:"Page Views",data:o}]})},e.UserActivity.addTranslation_pageViewPerDay=function(e){e},e.UserActivity.initializeBubbleChart=function(e){a=e,function(){(function(){var e,t=[],i=Highcharts.getOptions().colors[0];for(e=0;e<10;e+=1)t.push(Highcharts.Color(i).brighten((e-3)/7).get())})(),l(window).width();Highcharts.chart("ActivityBreakdownPieChart",{chart:{plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,type:"pie"},credits:{enabled:!1},title:{text:"",style:{color:"#0769A5",fontWeight:"bold"}},tooltip:{pointFormat:"{series.name}: <b>{point.percentage:.1f}%</b>"},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1},showInLegend:!0}},legend:{itemStyle:{color:"#848383",fontFamily:'"open_sansregular" ,"Helvetica Neue",Helvetica,Arial,sans-serif'}},series:[{name:"Share",data:a}]})}(),I()},e.UserActivity.initializeOverViewChr=function(e){i=e,function(){if(0<i.length)var t=[{name:v,type:"column",color:"#e29c42",data:i[0]&&i[0].AllActivities,maxPointWidth:50,tooltip:{valueSuffix:""},plotOptions:{column:{pointPadding:.2,borderWidth:0,maxPointWidth:50}}},{name:m,type:"spline",color:"#458AC6",data:i[0]&&i[0].TotalIdeaView,visible:!1,tooltip:{valueSuffix:""}},{name:g,type:"spline",color:"#DD87B8",data:i[0]&&i[0].TotalVoteCount,tooltip:{valueSuffix:""}},{name:b,type:"spline",color:"#885BA2",data:i[0]&&i[0].TotalCommentCount,visible:!1,tooltip:{valueSuffix:""}},{name:w,type:"spline",color:"#00FFFF",visible:!1,data:i[0]&&i[0].TotalSubmissionCount,tooltip:{valueSuffix:""}},{name:y,type:"spline",color:"#FFCCCC",visible:!1,data:i[0]&&i[0].TotalEvaluationCount,tooltip:{valueSuffix:""}},{name:C,type:"spline",color:"#CCCCFF",data:i[0]&&i[0].TotalCompletedTaskCount,visible:!1,tooltip:{valueSuffix:""}},{name:k,type:"spline",color:"#92D050",data:i[0]&&i[0].TotalAgileCount,visible:!1,tooltip:{valueSuffix:""}},{name:x,type:"spline",color:"#f8361c",data:i[0]&&i[0].TotalStatusChangedCount,visible:!1,tooltip:{valueSuffix:""}}];else t=[];Highcharts.chart("overview-chart",{chart:{zoomType:null},title:{text:""},credits:{enabled:!1},subtitle:{text:""},xAxis:[{categories:dates,crosshair:!0,labels:{x:20,style:{whiteSpace:"nowrap",textOverflow:"clip"}}}],yAxis:[{gridLineWidth:0,visible:!1,labels:{format:"{value}",style:{color:Highcharts.getOptions().colors[1]}},title:{text:"Votes",style:{color:Highcharts.getOptions().colors[1]}}},{visible:!1,title:{text:"Rainfall",style:{color:Highcharts.getOptions().colors[0]}},labels:{format:"{value} mm",style:{color:Highcharts.getOptions().colors[0]}},opposite:!0}],tooltip:{shared:!0},legend:{enabled:!0,layout:"horizontal",align:"left",x:80,verticalAlign:"top",y:-10,itemStyle:{color:"#848383",fontFamily:'"open_sansregular" ,"Helvetica Neue",Helvetica,Arial,sans-serif'},floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.legendBackgroundColor||"rgba(255,255,255,0.25)",align:"center",x:3,useHTML:!0,labelFormatter:function(){return"<span>"+this.name+"</span>"}},series:t},function(e){0==t.length&&e.renderer.text(f,e.plotLeft+e.plotWidth-.5*e.chartWidth+e.plotLeft,180).attr({zIndex:55,align:"center"}).css({fontFamily:'"open_sansregular" ,"Helvetica Neue",Helvetica,Arial,sans-serif',color:"#a2a1a1",fontSize:"20px"}).add()})}()},e.UserActivity.addTranslation_BubbleChart=function(e){e},e.UserActivity.addTranslation_session=function(e){e},e.UserActivity.initializeInnovationPortfolio=function(e){0<(T=e).length&&l(document).ajaxComplete(function(){0<T.length&&Highcharts.chart("innovationPortfolioHealthChart",{chart:{type:"bubble",plotBorderWidth:1,zoomType:null},legend:{enabled:!1,itemStyle:{color:"#848383",fontFamily:'"open_sansregular" ,"Helvetica Neue",Helvetica,Arial,sans-serif'}},credits:{enabled:!1},title:{text:""},subtitle:{text:""},xAxis:{gridLineWidth:1,title:{text:""},labels:{format:"{value}"},plotLines:[{color:"black",dashStyle:"dot",width:2,value:65,label:{rotation:0,y:15,style:{fontStyle:"italic"},text:""},zIndex:3}]},yAxis:{startOnTick:!1,endOnTick:!1,title:{text:""},labels:{format:"{value}"},maxPadding:.2,plotLines:[{color:"black",dashStyle:"dot",width:2,value:50,label:{align:"right",style:{fontStyle:"italic"},text:"",x:-10},zIndex:3}]},tooltip:{useHTML:!0,style:{pointerEvents:"auto"},headerFormat:"<table>",pointFormat:'<tr><th colspan="2"><a class="portfolio-link" target="_blank" href="{point.url}">Idea : #{point.IdeaId}</a></th></tr><tr><th>'+l("#xAxisValue>a").text()+":</th><td>{point.x}</td></tr><tr><th>"+l("#yAxisValue>a").text()+":</th><td>{point.y}</td></tr><tr><th>"+l("#innovationPortfolioHealthSize>a").text()+":</th><td>{point.z}</td></tr><tr><th>"+l("#innovationPortfolioHealthColor>a").text()+":</th><td>{point.c}</td></tr>",footerFormat:"</table>",followPointer:!0},plotOptions:{series:{dataLabels:{enabled:!0,format:"{point.name}"}}},series:[{data:T}]})})},e.UserActivity.addTranslationOverView=function(e,t,i,a,n,o,r,l,s,d,c,u,p){v=e,m=t,g=i,b=a,w=n,y=o,C=r,k=l,x=s,d,h=c,u,f=p},e.UserActivity.createUrl=function(e,t,i,a,n,o){r=t,s=i,d=a,c=n,u=e,p=o},e.UserActivity.initializeFunnel=function(e){t=e,$()},l(function(){l("#DateRange-from, #DateRange-to").on("input change keyup",function(){var e=l("#DateRange-from").val(),t=l("#DateRange-to").val();""!=e&&""!=t?l("#dateRange-btn").removeAttr("disabled"):l("#dateRange-btn").attr("disabled",!0)})}),window.onresize=function(){0<l("#funnelChart-div").length&&$()},l(function(){l(document).on("click",".highcharts-tooltip .portfolio-link",function(){window.location.href=this.attr("href")}),l("#userActivityTab a").click(function(e){e.preventDefault(),l(this).tab("show")}),l("li.Overview").unbind().on("click",function(e){e.preventDefault(),l.ajax({type:"GET",url:c}).error(function(e){}).success(function(e){l("input[name='SelectedUserActivityCommunity.Value']").select2("val",""),l("#DateRange-from").val(""),l("#DateRange-to").val("");var t=l("#dateRange-selector").css("display");t&&"block"==t&&l("#dateRange-selector").css("display","none"),l("#_OverviewPartial").html(e),l(".btn.dropdown-toggle.selectDateRange").html(h)})}),l("a#rangeTimeBtn").unbind().on("click",function(e){var t=l("#dateRange-selector").css("display");t&&"block"==t?l("#dateRange-selector").css("display","none"):l("#dateRange-selector").css("display","block")}),l("a#dateRange-btn").unbind().on("click",function(e){var t=l("#DateRange-from").val(),i=l("#DateRange-to").val(),a=l("#overview .brainbank-dropdown").find("input[name='SelectedUserActivityCommunity.Value']"),n={key:"",fromDate:t,toDate:i,communityId:a[0]&&a[0].value};""!=t&&""!=i&&(e.preventDefault(),l.ajax({type:"GET",url:c,data:n}).error(function(e){}).done(function(e){l("#_OverviewPartial").html(e)}))}),l(".dateRange_summary a").unbind().on("click",function(e){var t,i=l(e.target).prop("id").replace("_"," ");if("Custom (From-To)"==i){var a=l("#dateRange-selector").css("display");a&&"block"==a?l("#dateRange-selector").css("display","none"):l("#dateRange-selector").css("display","block")}else{l("#dateRange-selector").css("display","none");var n=l("#overview .brainbank-dropdown").find("input[name='SelectedUserActivityCommunity.Value']");t={key:i,communityId:n[0]&&n[0].value},l(this).parents(".btn-group").find("a.selectDateRange").html(l(e.target).text()),l(this).parents(".btn-group").find("a.selectDateRange").attr("value",l(e.target).prop("id")),e.preventDefault(),l.ajax({type:"GET",url:c,data:t}).error(function(e){}).done(function(e){l("#_OverviewPartial").html(e)})}}),l("li.Progress").unbind().on("click",function(e){e.preventDefault(),l.ajax({type:"GET",url:d}).error(function(e){}).success(function(e){l("#funnelPartial #SelectedChallenges_Value").select2("val",""),l("input[name='SelectedUserActivityCommunity.Value']").select2("val",""),l("#funnelChart-div").html(e)})}),l("li.User").unbind().on("click",function(e){e.preventDefault(),l.ajax({type:"GET",url:u}).error(function(e){}).success(function(e){l("input[name='SelectedUserActivityCommunity.Value']").select2("val",""),l("#userCharts").html(e)})}),l("li.Innovation-Portfolio-health").unbind().on("click",function(e){e.preventDefault(),l.ajax({type:"GET",url:s}).error(function(e){console.log(e)}).success(function(e){l("#innovationPortfolioHealth #SelectedChallenges_Value").select2("val",""),l("input[name='SelectedUserActivityCommunity.Value']").select2("val",""),l("#innovationPortfolioHealth-Partial").html(e)})})}),l(document).ajaxComplete(function(){l("#innovationPortfolioHealthValues-btn").unbind().on("click",function(e){var t=l("#innovationPortfolioHealth .brainbank-dropdown").find("input[name='SelectedChallenges.Value']"),i=l("#xAxisValue>a").text().trim(),a=l("#yAxisValue>a").text().trim(),n=l("#innovationPortfolioHealthSize>a").text().trim(),o=l("#innovationPortfolioHealthColor>a").text().trim(),r={xAxisValue:i,yAxisValue:a,size:n,color:o,challengeId:0<t.length&&t[0].value?t[0].value:0};e.preventDefault(),l.ajax({type:"GET",url:p,data:r}).error(function(e){}).success(function(e){l("#innovationPortfolioHealth-Partial").html(e),l("#xAxisValue>a").text(i),l("#yAxisValue>a").text(a),l("#innovationPortfolioHealthSize>a").text(n),l("#innovationPortfolioHealthColor>a").text(o)})}),l(".xAxisValue a").click(function(e){e.preventDefault();var t=l(e.target).text();l(this).parents(".btn-group").find("a.AxisValue").html(t)}),l(".yAxisValue a").click(function(e){e.preventDefault();var t=l(e.target).text();l(this).parents(".btn-group").find("a.AxisValue").html(t)}),l(".innovationPortfolioHealthSize a").click(function(e){e.preventDefault();var t=l(e.target).text();l(this).parents(".btn-group").find("a.AxisValue").html(t)}),l(".innovationPortfolioHealthColor a").click(function(e){e.preventDefault();var t=l(e.target).text();l(this).parents(".btn-group").find("a.AxisValue").html(t)})}),l(document).ajaxComplete(function(){l(".dateRange_UserActivity a").unbind().on("click",function(e){var t=l(e.target).prop("id").replace("_"," ");l(this).parents(".btn-group").find("a.dropdown-toggle").html(l(e.target).text()),l(this).parents(".btn-group").find("a.dropdown-toggle").attr("value",l(e.target).prop("id")),e.preventDefault(),l.ajax({type:"GET",url:r,data:{key:t}}).error(function(e){}).done(function(e){l("#SessionChart_container").html(e)})})});var E=190,A=1,D=50,L="rgb("+E+","+A+","+D+")";function F(){var e=document.getElementById("FunnelChr");if(e){var t=e.childElementCount;if(height=l("#FunnelChr .square-box").css("height"),height){height=height.split("px")[0]-120;var i,a=0,n=l("#FunnelChr .square-box").length;switch(n){case 1:i=45,l(".square-content-Number").css("margin-left","15%");break;case 2:i=47,l(".square-content-Number").css("margin-left","9%");break;case 3:i=48;break;default:i=43+n}switch(t){case 4:a=-1;break;case 3:a=-3;break;case 2:a=-22,height-=80,l(".legend-funnel-container:first-child .legend-funnel").addClass("legend-funnel-only-child"),l(".legend-funnel-container:first-child .legend-funnel").css("border","5px solid #92d050 !important");break;default:a=0}l(".square-footer").css("top",n+5+80+"%"),l(".square-content-Number").css("top",i+"%");l("#funnelPartial").css("display","block"),l("#FunnelChr .square-box").each(function(e){switch(0<e?height<=0&&7==t?l(this).find(".square-content").css("margin-top",a-.5+"%"):(l(this).find(".square-content").css("height",height+"px"),l(this).find(".square-content").css("margin-top",a+"%"),function(e,t,i){L="rgb("+e+","+t+","+i+")"}(E+10,A+50*e,D-3),l(this).css("background",L),l("#legend_funnel_"+e).css("border","5px solid "+L)):0==e&&(l(this).find(".square-content").css("height",3==t?height-100:height+"px"),l(this).find(".square-content").css("margin-top",a+"%"),l("#legend_funnel_"+e).css("border","5px solid "+L)),t){case 6:a+=3,height-=10;break;case 5:height-=20;break;case 4:height-=50;break;case 3:height-=110}6<t&&(a+=3),l(this).css("width",90/t+"%"),5==t&&2==e&&l(this).find(".square-content").css("margin-top","5%"),5==t&&3==e&&l(this).find(".square-content").css("margin-top","8%"),4==t&&2==e&&l(this).find(".square-content").css("margin-top","6%"),4==t&&0==e&&l(this).find(".square-content").css("margin-top","-4%"),height-=50})}}}function $(){F();var e=document.getElementById("FunnelChr");if(e){var n=e.childElementCount;t.forEach(function(a){l("#FunnelChr .square-box").each(function(e){var t=l(this).find(".square-content").css("height"),i=l(this).css("width");if(h1=t.split("px")[0]-(70-10*n),w1=i.split("px")[0]-10,0!=h1&&a.id==this.id){Highcharts.chart("funnelChr_"+a.id,{chart:{height:h1,width:w1,backgroundColor:"rgba(0,0,0,0)",type:"scatter",zoomType:null},title:{text:""},subtitle:{text:""},credits:{enabled:!1},xAxis:{title:{enabled:!0,text:"Height (cm)"},visible:!1,startOnTick:!0,endOnTick:!0,showLastLabel:!0},yAxis:{visible:!1,title:{text:"Weight (kg)"}},legend:{layout:"vertical",align:"left",verticalAlign:"top",x:100,y:70,itemStyle:{color:"#848383",fontFamily:'"open_sansregular" ,"Helvetica Neue",Helvetica,Arial,sans-serif'},floating:!0,backgroundColor:Highcharts.theme&&Highcharts.theme.legendBackgroundColor||"#FFFFFF",borderWidth:1},plotOptions:{visible:!1,scatter:{marker:{radius:3,states:{hover:{enabled:!0,lineColor:"rgb(100,100,100)"}}},states:{hover:{marker:{enabled:!1}}},series:{fillOpacity:0}}},tooltip:{enabled:!1},series:[a]})}})})}}l(function(){l("#selectedUserCommunity .brainbank-dropdown").unbind().on("change",function(e){var t=l(".selectDateRangeSession").attr("value"),i=l(".selectDateRangeSession").text(),a=l(this).find("input[name='SelectedUserActivityCommunity.Value']"),n=a[0]&&a[0].value,o={key:t?t.replace("_"," "):"",communityId:n};e.preventDefault(),l.ajax({type:"GET",url:u,data:o}).error(function(e){}).success(function(e){l("#userCharts").html(e),l(".selectDateRangeSession").html(i),l(".selectDateRangeSession").attr("value",t)})}),l("#overview .brainbank-dropdown").unbind().on("change",function(e){var t=l("#DateRange-from").val(),i=l("#DateRange-to").val(),a=l(this).find("input[name='SelectedUserActivityCommunity.Value']"),n=a[0]&&a[0].value,o={key:l(".selectDateRange").attr("value")?l(".selectDateRange").attr("value").replace("_"," "):"",fromDate:t,toDate:i,communityId:n};e.preventDefault(),l.ajax({type:"GET",url:c,data:o}).error(function(e){}).success(function(e){l("#_OverviewPartial").html(e),l(document).ajaxStop(function(){})})}),l("#funnelPartial .brainbank-dropdown, #SelectedUACommunity .brainbank-dropdown").unbind().on("change",function(e){l("#funnelPartial").text().trim();var t=l("#funnelPartial .brainbank-dropdown").find("input[name='SelectedChallenges.Value']"),i=t[0]&&t[0].value,a=l("#SelectedUACommunity .brainbank-dropdown").find("input[name='SelectedUserActivityCommunity.Value']"),n=a[0]&&a[0].value;e.preventDefault(),l.ajax({type:"GET",url:d,data:{key:i,communityId:n}}).error(function(e){}).success(function(e){l("#funnelChart-div").html(e),l(document).ajaxStop(function(){})})}),l("#innovationPortfolioHealth .brainbank-dropdown").unbind().on("change",function(e){l("#innovationPortfolioHealth");var t=l(this).find("input[name='SelectedChallenges.Value']");e.preventDefault(),l.ajax({type:"GET",url:p,data:{challengeId:t[0].value}}).error(function(e){}).success(function(e){l("#innovationPortfolioHealth-Partial").html(e)})})})}(window.Brainbank=window.Brainbank||{},jQuery),function(e,d){var a,n,r;function o(e,t){var l=e.PollsInfo,s=[],o="";d(e.FieldOptions).each(function(){for(var a=[],n=[],o=this.FieldId,e=!1,r=0,t=0;t<s.length;t++)if(s[t].formId==this.FormId){e=!0,r=t;break}if(!e){r=s.length;var i={formId:this.FormId,isUsed:!1,fields:[],options:[],questions:[]};s.push(i)}d(this.Options).each(function(){var e=this.Value.Translation,t=this.Key,i={name:e,y:0};a.push(i),n.push(e),d(l).each(function(){if(this.FieldId==o&&(s[r].isUsed=!0,this.Value==t)){var e=a.indexOf(i);-1<e&&(a[e].y=this.Percentage)}})}),s[r].questions.push({pollQuestion:this.FieldName.Translation,fieldId:this.FieldId}),s[r].fields.push({fieldId:this.FieldId,options:a}),s[r].options.push(n)}),s=s.filter(function(e){return e.isUsed}),t&&(d('[data-current-form-id="'+r+'"] #poll-loader').remove(),0<d("#formResults-"+r).length&&d("#formResults-"+r).each(function(){d(this).remove()}),d("#form-"+r+".active").after('<div id="formResults-'+r+'" class="item active" data-current-form-id="'+r+'">'),d("#form-"+r+".active").remove()),0==d("#pollCarousel .carousel-inner .active").length&&(o="active"),d(s).each(function(){var i=this.options,a=this.fields,n=this.formId;t||(d("#pollCarousel .carousel-inner").append('<div id="formResults-'+n+'" class="item '+o+'" data-current-form-id="'+n+'">'),o=""),d(this.questions).each(function(e,t){d("#formResults-"+n).append('<div id="pollResults-'+n+'"></div>'),function(e,t,i,a){Highcharts.chart("pollResults-"+a,{chart:{type:"bar"},title:{text:""},subtitle:{text:e.pollQuestion},xAxis:{categories:t,title:{text:null}},yAxis:{gridLineWidth:0,minorGridLineWidth:0,min:0,title:{text:"",align:"high"},labels:{overflow:"justify"}},tooltip:{pointFormat:"<b>{point.y}%</b>"},plotOptions:{bar:{pointWidth:30,dataLabels:{enabled:!0}},series:{groupPadding:0,pointPadding:.1,borderWidth:0}},credits:{enabled:!1},series:[{dataLabels:[{format:"{y}%"}],showInLegend:!1,colorByPoint:!0,name:"",data:i}]})}(this,i[e],a[e].options,n)})}),1<d("#pollCarousel .carousel-inner").children().length?d("#pollCarousel .poll-indicators").show():0==d("#pollCarousel .carousel-inner").children().length&&(d("#pollCarousel").hide(),d("#noPolls").show())}e.Polls=e.Polls||{},e.Polls.initialize=function(e,t){a=e,n=t,d("#pollCarousel .carousel-inner .item:first-of-type").addClass("active"),d(document).on("click",".completePollButton",function(e){e.preventDefault(),r=d(this).attr("data-form-id");var t=d(this).attr("data-poll-id");d('[data-current-form-id="'+r+'"].active').prepend('<svg id="poll-loader" version="1.1" id="L7" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve"> <path fill="#025A9A" d="M31.6,3.5C5.9,13.6-6.6,42.7,3.5,68.4c10.1,25.7,39.2,38.3,64.9,28.1l-3.1-7.9c-21.3,8.4-45.4-2-53.8-23.3 c-8.4-21.3,2-45.4,23.3-53.8L31.6,3.5z"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="2s" from="0 50 50" to="360 50 50" repeatCount="indefinite" /> </path> <path fill="#025A9A" d="M42.3,39.6c5.7-4.3,13.9-3.1,18.1,2.7c4.3,5.7,3.1,13.9-2.7,18.1l4.1,5.5c8.8-6.5,10.6-19,4.1-27.7 c-6.5-8.8-19-10.6-27.7-4.1L42.3,39.6z"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="1s" from="0 50 50" to="-360 50 50" repeatCount="indefinite" /> </path> <path fill="#f7941d" d="M82,35.7C74.1,18,53.4,10.1,35.7,18S10.1,46.6,18,64.3l7.6-3.4c-6-13.5,0-29.3,13.5-35.3s29.3,0,35.3,13.5 L82,35.7z"> <animateTransform attributeName="transform" attributeType="XML" type="rotate" dur="2s" from="0 50 50" to="360 50 50" repeatCount="indefinite" /> </path></svg>'),d('[data-current-form-id="'+r+'"].active .poll').hide();var i=d("#poll-form-post-"+t).formSerialize();d.ajax({type:"POST",url:a,data:i,success:function(e){-1<e.indexOf("data-form-success")?d.ajax({url:n+"?formId="+r,success:function(e){o(e,!0)}}):(d("#form-"+r).after(e),d("#form-"+r+".active").remove(),d("#form-"+r).addClass("active"))}})}),d.ajax({url:n+"?formId=0",success:function(e){o(e,!1)}})}}(window.Brainbank=window.Brainbank||{},jQuery),function(Brainbank,$,undefined){Brainbank.DialogBox=Brainbank.DialogBox||{},Brainbank.DialogBox.enableBackdrop=!0,Brainbank.DialogBox.queue=new Array;var defaultDialogContent='<div class="modal-header"><h3></h3></div><div class="modal-body"><div class="loading"><div class="loader"></div><h5 class="loading-title">Loading...</h5></div></div><div class="modal-footer"><a href="#" class="close-button btn" data-dismiss="modal" aria-hidden="true">Close</a><a href="#" class="validate-button btn btn-primary">Ok</a></div><button type="button" class="top-corner close" data-dismiss="modal" aria-hidden="true">&times;</button>',dialogHtml='<div class="main-dialogbox modal fade" role="dialog" tabindex="-1">'+defaultDialogContent+"</div>";function isFunction(e){return e&&"[object Function]"==={}.toString.call(e)}function addDialogHtml(e){$("body").append(dialogHtml),$(".first-div").css("position","static"),$(".first-div").css("top","0"),$(".first-div").css("margin-right","0px"),$("#footer .container-fluid").css("padding-right","20px"),$("#footer .container-fluid").css("padding-left","20px"),$(document).scrollTop(e)}function resetDialogBoxOnHide(scrollTop,onCloseAction){$(document).on("hidden",".main-dialogbox",function(){var $container=$(this);$container.remove(),$(".main-dialogbox:last").length&&($(".main-dialogbox:last").focus(),$(".main-dialogbox:last").css("position","absolute")),0==$(".main-dialogbox").length&&addDialogHtml(scrollTop),onCloseAction!=undefined&&(isFunction(onCloseAction)?onCloseAction():eval(onCloseAction()))})}function initializeScrollbar(e){e.mCustomScrollbar({theme:"dark-thick",advanced:{updateOnContentResize:!0},scrollButtons:{enable:!0}}),e.find(".modal-body-container").on("resize",function(){e.mCustomScrollbar("update")})}function resizeModalWidth(e,t,i){var a=$(i).width();if(t!=undefined&&767<a&&t<a){e.css("width",t);var n=t/2*-1;e.css("left","50%"),e.css("margin-left",n)}else a<=767||a<=t?(e.css("width","90%"),e.css("left","5%"),e.css("margin-left",0)):(e.css("width",560),e.css("left","50%"),e.css("margin-left",-280))}function createDialogBox($container,options){var top=$(document).scrollTop();$container=(options.addNewDialog!=undefined&&options.addNewDialog?($(".main-dialogbox").css("position","fixed"),$("body").append(dialogHtml)):($(".main-dialogbox").remove(),addDialogHtml(top)),$(".main-dialogbox").last()),$container.html(defaultDialogContent),options.body!=undefined&&$container.find(".modal-body").html(options.body),$container.find(".modal-header h3").html(options.title),options.title!=undefined&&""!=options.title||$container.find(".modal-header").css("border-bottom","0px"),resizeModalWidth($container,options.width,window),$(window).on("resize",function(){resizeModalWidth($container,options.width,window)}),$container.on("click",".close-dialog-button",function(){$container.modal("hide")}),$container.on("click",".submit-dialog-button:not(#btn_savegroup)",function(){$('input[type="submit"], .close-dialog-button').attr("disabled","disabled");var e=!1,t=!!window.opr&&!!opr.addons||!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),i=/constructor/i.test(window.HTMLElement)||"[object SafariRemoteNotification]"===(!window.safari||safari.pushNotification).toString();!!!document.documentMode&&!!window.StyleMedia||(e=window.BROWSER?!!window.BROWSER.chrome&&window.BROWSER.chrome:!!window.chrome&&!!window.chrome.webstore);(e||t)&&window.CSS;(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/Windows Phone/i))&&$(this).parents("form").submit(),e&&$(this).parents("form").submit(),i&&$(this).parents("form").submit(),$(document).ajaxComplete(function(){$('input[type="submit"], .close-dialog-button').removeAttr("disabled")})}),initializeAjaxForm($container,options.formSubmitSuccess),$container.ajaxStop(function(){initializeAjaxForm($container,options.formSubmitSuccess)}),options.closeButtonLabel!=undefined||options.validateButtonLabel!=undefined&&options.validateButtonAction!=undefined?(options.validateButtonLabel!=undefined?($container.find(".validate-button").html(options.validateButtonLabel),$container.find(".validate-button").click(function(){var $currentButton=$(this);isFunction(options.validateButtonAction)?options.validateButtonAction($currentButton):eval(options.validateButtonAction),!options.closeAfterValidate&&options.closeAfterValidate!=undefined||$container.modal("hide")})):$container.find(".validate-button").hide(),options.closeButtonLabel!=undefined?$container.find(".close-button").html(options.closeButtonLabel):$container.find(".close-button").hide(),options.closeButtonAction!=undefined&&$container.find(".close-button").click(function(){isFunction(options.closeButtonAction)?options.closeButtonAction():eval(options.closeButtonAction)})):$container.find(".modal-footer").hide(),$container.modal({backdrop:Brainbank.DialogBox.enableBackdrop,keyboard:options.keyboard==undefined||null==options.keyboard||options.keyboard,remote:options.remote!=undefined&&null!=options.remote&&options.remote,show:!0}),$container.attr("data-remote",options.remote),options.caller!=undefined&&($container.attr("data-caller-selector",options.caller.selector),$container.attr("data-caller-url",options.caller.url)),$container.attr("id",options.id),$container.attr("data-reload",options.reload),$container.attr("data-go-url",options.goToUrl),1==$(".main-dialogbox").length&&(resetDialogBoxOnHide(top,options.onCloseAction),$(".first-div").css("position","fixed"),$(".first-div").css("top",-top),$(window).width()<=767&&($(".first-div").css("margin-right","20px"),$("#footer .container-fluid").css("padding-right","0px"),$("#footer .container-fluid").css("padding-left","0px")),0<top&&$("html").css("overflow-y","scroll"))}function initializeAjaxForm($container,successCallback){$container.find("form").length&&$container.find("form").ajaxForm({success:function(result){$container.find(".modal-body").html(result),$container.find(".modal-body").scrollTop(0);var caller={$container:$container.attr("data-caller-selector")!=undefined?$($container.attr("data-caller-selector")):undefined,url:$container.attr("data-caller-url")};successCallback!=undefined&&(isFunction(successCallback)?successCallback():eval(successCallback)),Brainbank.IsDialogSuccess(result)&&$container.attr("data-go-url")!=undefined&&""!=$container.attr("data-go-url")&&null!=$container.attr("data-go-url")?closeAndGoToUrl($container.attr("data-go-url")):Brainbank.IsDialogSuccess(result)&&closeAndReload($container,$container.attr("data-reload"),caller)}})}function closeAndGoToUrl(e){window.location.href=e}function closeAndReload(e,t,i){e.modal("hide"),t==undefined||"parent"==t.toLowerCase()?i!=undefined&&i.$container!=undefined&&i.url!=undefined?i.$container.load(i.url):location.reload():"forcepage"==t.toLowerCase()&&location.reload()}Brainbank.DialogBox.AutoClose=function(){$(document).find('[data-form-success="1"]').length},Brainbank.DialogBox.show=function(e,t){t==undefined&&(t=$(".main-dialogbox").last()),e.isInIframe=!1,createDialogBox(t,e)},Brainbank.DialogBox.initialize=function(e,t,i){e.on("click",function(){Brainbank.DialogBox.show(t,i)})},Brainbank.DialogBox.initializeAjaxDialog=function(){$.fn.modal.Constructor.prototype.enforceFocus=function(){},$(document).on("hidden",".modal .collapse",function(e){e.stopPropagation()}),$(document).on("click",".brainbank-ajax-dialog:not(.editable-content)",function(e){var t=$(this);if("disabled"!=t.attr("disabled")){var i={addNewDialog:!!t.parents(".modal").length,title:t.attr("data-dialog-title")!=undefined?t.attr("data-dialog-title"):t.attr("title"),remote:t.attr("data-dialog-href"),isInIframe:!1,validateButtonLabel:t.attr("data-dialog-validate-button-label"),closeButtonLabel:t.attr("data-dialog-close-button-label"),validateButtonAction:t.attr("data-dialog-validate-button-action"),closeButtonAction:t.attr("data-dialog-close-button-action"),reload:t.attr("data-dialog-auto-reload"),goToUrl:t.attr("data-dialog-go-to-url"),width:t.attr("data-dialog-width"),height:t.attr("data-dialog-height"),id:t.attr("data-dialog-id"),closeAfterValidate:t.attr("data-close-after-validate")==undefined||t.attr("data-close-after-validate"),onCloseAction:t.attr("data-onclose-action"),formSubmitSuccess:t.attr("data-form-submit-success")};if(t.parents(".main-dialogbox").length){var a=t.parents(".main-dialogbox");i.caller={selector:"#"+a.attr("id")+" .modal-body",url:t.attr("data-caller-url")!=undefined?t.attr("data-caller-url"):a.attr("data-remote")}}else t.attr("data-caller-selector")!=undefined&&t.attr("data-caller-url")!=undefined&&(i.caller={selector:t.attr("data-caller-selector"),url:t.attr("data-caller-url")});Brainbank.DialogBox.show(i,$(".main-dialogbox").last())}})}}(window.Brainbank=window.Brainbank||{},jQuery),function(a,r){a.Translation=a.Translation||{},a.Translation.chooseLanguageSubmit=function(){r("#form-locale").ajaxSubmit({success:function(e){r("#form-locale").parents(".modal-body").html(e),"Choose language"===r("#localeEdit option:selected").val()?(r("#save").attr("disabled","disabled"),r("#resettodefault").attr("disabled","disabled")):(r("#save").removeAttr("disabled"),r("#resettodefault").removeAttr("disabled"))}})},a.Translation.initializeReset=function(i){r("#resettodefault").click(function(e){e.stopPropagation(),e.preventDefault();var t=r(this);r.get(i,function(){t.parents(".modal").modal("hide"),r("#translation-filter-form").length?a.Translation.submitFilter():location.reload()})})},a.Translation.initializeSubmitFilter=function(){r("#translation-filter-form").ajaxForm({success:function(e){r("#translation-table-body").html(e)}}),r("#translation-table-body").on("click","#list-pagination a",function(e){e.preventDefault();var t=r(this),i=r("#translation-filter-form [name='section']").val(),a=r("#translation-filter-form [name='locale']").val(),n=r("#translation-filter-form [name='keyword']").val(),o=t.attr("href");o+=(0<o.indexOf("?")?"&":"?")+"section="+i+"&locale="+a+"&keyword="+encodeURIComponent(n),r("#translation-table-body").load(o)})},a.Translation.submitFilter=function(){r("#translation-filter-form").submit()}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,n){e.NoMoreTable=e.NoMoreTable||{};var o=new Array;function t(e){e.find("thead th").each(function(){var e=n(this);0<e.find("span").length?o.push(e.find("span").html()):o.push(e.html())});var a=o.length;e.find("tbody tr").each(function(){for(var e=n(this),t=1;t<=a;t++){var i=e.find("td:nth-child("+t+")");i.find("span.th").length||i.prepend("<span class='th'>"+o[t-1]+"</span>")}})}e.NoMoreTable.initialize=function(e){n(window).width()<=899&&t(e),n(window).on("resize",function(){n(window).width()<=899&&t(e)})}}(window.Brainbank=window.Brainbank||{},jQuery);var BrainBank=BrainBank||{};BrainBank.EventBridge={_eventNamespace:"brainbankframes",_interval:200,_timeout:2e4,_callback:null,_timerId:null,_queue:[],Init:function(e){e.contentWindow&&e.contentWindow.BrainBank&&e.contentWindow.BrainBank.EventBridge&&e.contentWindow.BrainBank.EventBridge.SetCallBack(this._trigger)},SetCallBack:function(e){this._callback=e},Raise:function(e,t){var i=this;null==this._callback?(i._queue.push({event:e,data:t}),this._clearTimeout(),i._timerId=setInterval(function(){i._pollQueue()},this._interval),this._stopPollingAfterTimeout()):this._callback(e,t),this._trigger(e,t)},Listen:function(e,t){$(document).on(e+"."+this._eventNamespace,t)},_trigger:function(e,t){$(document).trigger(e+"."+this._eventNamespace,t)},_pollQueue:function(){if(null!=this._callback){var i=this;this._clearTimeout(),$.each(this._queue,function(e,t){i._callback(t.event,t.data)}),this._queue={}}},_clearTimeout:function(){null!=this._timerId&&(clearInterval(this._timerId),this._timerId=null)},_stopPollingAfterTimeout:function(){setTimeout(function(){null==this._callback&&this._clearTimeout()},this._timeout)}};var BrainBank=BrainBank||{};BrainBank.FormHelpers={RegisterOnBlurSetValue:function(e,t,i){$(e).on("blur",function(){i(e,t)})},Checkboxes:{SetChecked:function(e,t){t?$(e).attr("checked","checked"):$(e).removeAttr("checked")},ToggleGroup:function(e,t){var i=$(t);BrainBank.FormHelpers.Checkboxes.SetChecked(i.add(e),!i.filter(":checked").length)},RegisterSelectAllBehaviour:function(e,t){var i=$(e),a=$(t);i.unbind("change.BrainBank.FormHelpers.RegisterSelectAllCheckboxesBehaviour"),a.unbind("change.BrainBank.FormHelpers.RegisterSelectAllCheckboxesBehaviour"),i.bind("change.BrainBank.FormHelpers.RegisterSelectAllCheckboxesBehaviour",function(e){BrainBank.FormHelpers.Checkboxes.ToggleGroup(i,a),i.css({opacity:"1"})});function n(){var e=a.filter(":checked:first").length,t=a.filter(":not(:checked):first").length;BrainBank.FormHelpers.Checkboxes.SetChecked(i,e),i.css({opacity:e&&t?"0.5":"1"})}a.bind("change.BrainBank.FormHelpers.RegisterSelectAllCheckboxesBehaviour",n),n()},RegisterShiftClickBehaviour:function(e){var n=$(e),o=null;n.unbind("click.BrainBank.FormHelpers.RegisterShiftClickBehaviour"),n.bind("click.BrainBank.FormHelpers.RegisterShiftClickBehaviour",function(e){if(null!==o&&(e.shiftKey||e.metaKey)){var t=n.index(o),i=n.index(e.target),a=n.slice(Math.min(t,i),Math.max(t,i)+1);BrainBank.FormHelpers.Checkboxes.SetChecked(a,e.target.checked)}o=e.target})},RegisterAllBehaviour:function(e,t){BrainBank.FormHelpers.Checkboxes.RegisterSelectAllBehaviour(e,t),BrainBank.FormHelpers.Checkboxes.RegisterShiftClickBehaviour(t)},CheckDefaultValue:function(e,t,i,a){BrainBank.FormHelpers.Checkboxes.SetDefaultValue(e,t,i),a&&BrainBank.FormHelpers.Checkboxes.RegisterOnChangeSetValue(e,t,i,BrainBank.FormHelpers.Checkboxes.SetDefaultValue)},SetDefaultValue:function(e,t,i){var a=$(e);if(""==$.trim(a.val())){var n=i.split("</br>");n=$.map(n,function(e,t){return $.trim(e)}),a.val(n.join(",")),$("#"+t+' input[type="checkbox"]').each(function(e,t){-1<$.inArray($(this).val(),n)&&$(this).attr("checked","checked")})}},RegisterOnChangeSetValue:function(e,t,i,a){$(e).on("change",function(){a(e,t,i)})}},TextBox:{CheckDefaultValue:function(e,t,i,a){BrainBank.FormHelpers.TextBox.SetDefaultValue(e,t,i),a&&BrainBank.FormHelpers.RegisterOnBlurSetValue(e,i,BrainBank.FormHelpers.TextBox.SetDefaultValue)},SetDefaultValue:function(e,t,i){var a,n,o=$(e);$(e).data("kendoEditor")?(n=!0,o=$(e).data("kendoEditor")):"liveEditor"==$(e).attr("data")&&(a=!0),a?$(e).val(i):n?""===$.trim(o.value())&&""===$(t).val()&&o.value(i):""===$.trim(o.val())&&""===$(t).val()&&o.val(i)}},DropDown:{CheckDefaultValue:function(e,t,i){BrainBank.FormHelpers.DropDown.SetDefaultValue(e,t),i&&BrainBank.FormHelpers.RegisterOnBlurSetValue(e,t,BrainBank.FormHelpers.DropDown.SetDefaultValue)},SetDefaultValue:function(e,t){var i,a,n=$(e);""==$.trim(n.val())&&(trimedvalue=t.substring(0,t.length-6).substring(6).replace("&quot;",'"'),n.val((i=trimedvalue,(a=document.createElement("textarea")).innerHTML=i,a.value)).trigger("change"))}},NumericBox:{CheckDefaultValue:function(e,t,i){BrainBank.FormHelpers.NumericBox.SetDefaultValue(e,t),i&&BrainBank.FormHelpers.RegisterOnBlurSetValue(e,t,BrainBank.FormHelpers.NumericBox.SetDefaultValue)},SetDefaultValue:function(e,t){var i=$(e).data("kendoNumericTextBox");""==$.trim(i.value())&&NaN!=Number(t)&&i.value(t)}},RadioButtons:{CheckDefaultValue:function(e,t,i){BrainBank.FormHelpers.RadioButtons.SetDefaultValue(e,t,i)},SetDefaultValue:function(e,t,i){var a=$(e);""==$.trim(a.val())&&(a.val($.trim(i)),$(function(){$("#"+t+' input[type="radio"]').each(function(e,t){$(this).val()!=$.trim(i)||$(this).trigger("click")})}))}},DateTime:{CheckDefaultValue:function(e,t,i,a){BrainBank.FormHelpers.DateTime.SetDefaultValue(e,t,i),a&&BrainBank.FormHelpers.RegisterOnBlurSetValue(e,t,BrainBank.FormHelpers.DateTime.SetDefaultValue)},SetDefaultValue:function(e,t,i){var a;a="True"==i?$(e).getKendoDateTimePicker():$(e).getKendoDatePicker(),""==$.trim(a.value())&&a.value(t)}}},function(v,m){"use strict";var e={options:{elementTypeClass:".field-type",formElementHolderClass:".form-elements",formElementClass:".form-element",formPropertiesClass:".field-properties",formId:0,routeAddField:"",routeListFields:"",allowDragAndDrop:"true",width:300,locale:{areYouSure:"Are you sure?",areYouSureDescription:"Are you sure you'd like to remove this field? This action is irreversible.",yes:"Yes",no:"No",close:"Close"}},RefreshElements:function(){var t=this,i=t.element.find(t.options.formElementHolderClass);v.ajax(t.options.routeListFields).done(function(e){i.html(e),i.fadeTo(100,1),t.BindEvents()}).fail(function(e){i.html(e.responseText),i.fadeTo(100,1),t.BindEvents()})},BindEvents:function(){var n=this;function o(e,t){4==v("#FormGroup_Value").val()&&(v("#draggableFields").show(),v("#dontdragpoll").hide()),v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.deleteField?formid="+e+"&fieldid="+t,complete:function(e){n.RefreshElements()}})}this.element.find(".delete").click(function(){var e=v(this).attr("data-field-id"),t=v("[data-order-id='"+e+"']"),i=t.placeholder().index(),a=t.children()[0].children[0].className.split(" ")[1];0==i&&"TabField"==a&&1<v(".form-element-display .TabField").length?Brainbank.DialogBox.show({addNewDialog:!0,title:deleteWarningTranslate,body:deleteWarningDescriptionTranslate,closeButtonLabel:okTranslate}):Brainbank.DialogBox.show({addNewDialog:!0,title:n.options.locale.areYouSure,body:n.options.locale.areYouSureDescription,closeButtonLabel:n.options.locale.no,validateButtonLabel:n.options.locale.yes,validateButtonAction:function(){o(n.options.formId,e)}})}),this.element.find(".decrease").click(function(){var e=v(this),t=e.attr("data-field-id"),i=v("[data-order-id='"+t+"']");switch(i.attr("data-field-column")){case"span12":e.attr("data-field-column","span6"),i.attr("data-field-column","span6"),i.addClass("span6"),i.removeClass("span12"),i.find(".increase").show(),i.find(".decrease").hide()}var a=i.attr("data-field-column");v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.UpdateFieldcolumn?fieldId="+t+"&fieldColumn="+a,complete:function(e){}})}),this.element.find(".increase").click(function(){var e=v(this),t=e.attr("data-field-id"),i=v("[data-order-id='"+t+"']");switch(i.attr("data-field-column")){case"span6":e.attr("data-field-column","span12"),i.attr("data-field-column","span12"),i.addClass("span12"),i.removeClass("span6"),i.find(".decrease").show(),i.find(".increase").hide()}var a=i.attr("data-field-column");v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.UpdateFieldcolumn?fieldId="+t+"&fieldColumn="+a,complete:function(e){}})}),n._makeElementsSortable()},_makeElementsSortable:function(){var h=this,f=v(h.options.formElementHolderClass);f.sortable({cancel:".placeholder",placeholder:"highlight",helper:function(e,t){var i=t.clone();return i.css("opacity","0.75"),i},start:function(e,t){v(t.item.find(".drop-down-hidden[data-dropdown-serviceurl]")).select2("close"),t.item.toggleClass("highlight")},stop:function(e,t){v(t.item.find(".drop-down-hidden[data-dropdown-serviceurl]")).select2("close"),t.item.toggleClass("highlight")},change:function(e,t){v(t.item.find(".drop-down-hidden[data-dropdown-serviceurl]")).select2("close");var i=v(".form-element-display:first").children();0<i.length?"TabField"==i[0].className.split(" ")[1]?t.placeholder.attr("sortIndex",t.placeholder.index()+1):t.placeholder.attr("sortIndex",t.placeholder.index()):t.placeholder.attr("sortIndex",t.placeholder.index())},over:function(e,t){h.element.find(".placeholder").hide()},out:function(e,t){var i=h.element.find(".placeholder");i!==m&&null!==i&&(i.is(":visible")||i.show())},update:function(e,t){e.preventDefault(),4==v("#FormGroup_Value").val()&&(v("#draggableFields").hide(),v("#dontdragpoll").show());var i="span12",a=t.placeholder;if("li"===a.context.tagName.toLowerCase()){h.element.find(".placeholder").remove();var n=-1;n=a.attr("sortIndex");var o=t.item.attr("data-field-type");if(t.item.hide(),0!=v(".form-element-display").length&&0!=n){var r=v(".form-element-display:first").children()[0].className.split(" ")[1];if("TabField"==o)if("TabField"!=r){v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.addField?formid="+h.options.formId+"&type="+o+"&orderPosition=0&fieldColumn="+i,success:function(){n=parseInt(n)+1,v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.addField?formid="+h.options.formId+"&type="+o+(n!==m&&0<=n?"&orderPosition="+n:"")+"&fieldColumn="+i,success:function(){h.RefreshElements()}})}})}else v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.addField?formid="+h.options.formId+"&type="+o+(n!==m&&0<=n?"&orderPosition="+n:"")+"&fieldColumn="+i,success:function(){h.RefreshElements()}});else v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.addField?formid="+h.options.formId+"&type="+o+(n!==m&&0<=n?"&orderPosition="+n:"")+"&fieldColumn="+i,success:function(){h.RefreshElements()}})}else v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.addField?formid="+h.options.formId+"&type="+o+(n!==m&&0<=n?"&orderPosition="+n:"")+"&fieldColumn="+i,success:function(){h.RefreshElements()}})}else{var l=f.find(h.options.formElementClass),s=l.map(function(){return v(this).attr("data-order-id")}).toArray();if(0<f.children().length)if("TabField"!=f.children()[0].children[0].children[0].className.split(" ")[1])if(1<f.children().length)if("TabField"==f.children()[1].children[0].children[0].className.split(" ")[1]){var d=f.children()[0],c=f.children()[1],u=[];u.push(c),u.push(d);var p=f.children().slice(2);s=(l=u.concat(p.toArray())).map(function(e){return e.attributes[1].value})}0<s.length&&v.ajax({type:"POST",url:BrainBank.apiUrl+"forms.updatefieldsorder?formid="+h.options.formId+"&fieldsorder="+s,complete:function(e){h.RefreshElements()}})}}})},_create:function(){"true"===this.options.allowDragAndDrop&&this.element.find(this.options.elementTypeClass).draggable({start:function(){v(window).width()<768&&v(".form-tools").toggle()},appendTo:".main-dialogbox:last",connectToSortable:".ui-sortable",helper:function(e){return v('<div style="white-space:nowrap;"/>').append(v(this).clone())}}),this.RefreshElements()},_setOption:function(e,t){v.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){v.Widget.prototype.destroy.call(this)}};v.widget("brainbank.formeditor",e)}(jQuery);var BrainBank=BrainBank||{};BrainBank.Comments={_AddCancelEvent:function(e,t){$("#"+e+" .cancel-comment-editor").click(function(){BrainBank.Comments.Hide(t),t.find(".reply").show()})},ShowEditor:function(e,t){var i=$("#"+t);$(".create-comment").each(function(){var e=$(this);BrainBank.Comments.Hide(e.parents(".comment-container:first"))}),i.find(".body:first").append(e.responseText),i.find(".reply").hide(),this._AddCancelEvent(t,i),BrainBank.ui.SetFocus(i.find("textarea"))},UpdateCommentControl:function(e,t){if(200==e.status)$("#"+t+" .commentTab").html(e.responseText);else{var i=$("<div>"+e.responseText+"</div>");$("#"+t).parents(".edit-comment-container").html(i.find(".edit-comment-container").html()),t=i.find(".create-comment").attr("id")}var a=$("#"+t);this._AddCancelEvent(t,a.parent())},ConfirmDeletion:function(e,t,i,a,n){Brainbank.DialogBox.show({title:e,body:t,closeButtonLabel:i,validateButtonLabel:a,validateButtonAction:n})},Hide:function(e){$("#comment_0 .reply").show(),e.find(".create-comment").remove()}};var voteInProgress=!1;!function(e,s){e.VoteControl=e.VoteControl||{},e.VoteControl.initialize=function(){if(BrainBank.hasPermission("idea-vote")){var l=function(e){e.stopImmediatePropagation();var t=s(this).closest(".votecontrol"),i=t.attr("data-vote-id"),a=parseInt(s(this).attr("data-vote-value")),n=t.attr("data-User-Can-Vote"),o=t.attr("data-current-vote");if("true"===n.toLowerCase()||"false"===n.toLowerCase()&&0!=o){var r=this.className.indexOf("vote-active");voteInProgress||(voteInProgress=!0,r<0&&(document.body.style.cursor="progress",s.ajax({type:"POST",url:BrainBank.getApiRoute("ideas","vote")+"?ideaid="+encodeURIComponent(i)+"&value="+encodeURIComponent(a)+"&currentUserVote="+encodeURIComponent(o)+"&votingTargetGoal=0",success:function(e){"Failed"!=e.Result&&(t.attr("data-current-vote",e.Data.CurrentUserVote),s(".votecontrol").attr("data-User-Can-Vote",e.Data.UserCanVote),s.each(s(".votecontrol"),function(){var e=this.getAttribute("data-current-vote"),t=this.getAttribute("data-User-Can-Vote"),i=s(this).find("a");s.each(i,function(){!0==("true"===t.toLowerCase()||"false"===t.toLowerCase()&&0!=e)?s(this).hasClass("hide-vote")&&s(this).removeClass("hide-vote"):s(this).addClass("hide-vote")})}),t.find(".vote-count-post").text(e.Data.VoteValue),t.find(".vote-active").removeClass("vote-active").addClass("vote-inactive"),t.find('[data-vote-value="'+e.Data.CurrentUserVote+'"]').removeClass("vote-inactive").addClass("vote-active"),0<s("#ideaTileView").length&&(0==parseInt(o)?s(t).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text(parseInt(s(t).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text())+1):s(t).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text(parseInt(s(t).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text())-1),s(t).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").attr("data-original-title",parseInt(s(t).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text()))),s(this).on("click",l))},complete:function(){voteInProgress=!1,document.body.style.cursor="default"}})),voteInProgress=!1)}};s("body").on("click",".votecontrol a[data-vote-value]",l)}else s(".vote-up,.vote-down").attr("title","You're not allowed to perform this action."),s(".vote-up,.vote-down").addClass("general-tooltip").data("placement","top")}}(window.Brainbank=window.Brainbank||{},jQuery);var likeInProgress=!1;!function(e,s){e.LikeControl=e.LikeControl||{},e.LikeControl.initialize=function(){if(BrainBank.hasPermission("idea-vote")){var l=function(e){e.stopImmediatePropagation();var i=s(this).closest(".likecontrol"),t=i.attr("data-like-id"),a=parseInt(s(this).attr("data-like-value")),n=i.attr("data-User-Can-Like"),o=i.attr("data-current-like");if("true"===n.toLowerCase()||"false"===n.toLowerCase()&&0!==o){var r=this.className.indexOf("like-active");likeInProgress||(likeInProgress=!0,0<r&&(document.body.style.cursor="progress",a=-1),s.ajax({type:"POST",url:BrainBank.getApiRoute("ideas","vote")+"?ideaid="+encodeURIComponent(t)+"&value="+encodeURIComponent(a)+"&currentUserVote="+encodeURIComponent(o)+"&votingTargetGoal=0",success:function(e){if("Failed"!=e.Result){if(i.attr("data-current-like",e.Data.CurrentUserVote),s(".likecontrol").attr("data-User-Can-Like",e.Data.UserCanVote),s.each(s(".likecontrol"),function(){var e=this.getAttribute("data-current-like"),t=this.getAttribute("data-User-Can-Like"),i=s(this).find("a");s.each(i,function(){!0==("true"===t.toLowerCase()||"false"===t.toLowerCase()&&0!=e)?s(this).hasClass("hide-like")&&s(this).removeClass("hide-like"):s(this).addClass("hide-like")})}),i.find(".like-count-post").text(e.Data.VoteValue),i.find(".like-active").removeClass("like-active").addClass("like-inactive"),i.find('[data-like-value="'+e.Data.CurrentUserVote+'"]').removeClass("like-inactive").addClass("like-active"),i.find(".like").hasClass("like-active")){i.find(".like").text(s("#unliketext").text());var t=i.find(".like").text();i.find(".like").attr("data-original-title",t)}else{i.find(".like").text(s("#liketext").text());t=i.find(".like").text();i.find(".like").attr("data-original-title",t)}0<s("#ideaTileView").length&&(0==parseInt(e.Data.CurrentUserVote)?s(i).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text(parseInt(s(i).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text())-1):s(i).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text(parseInt(s(i).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text())+1),s(i).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").attr("data-original-title",parseInt(s(i).parentsUntil(".idea-card-size").parent().find(".idea-card-vote-count a").text()))),s(this).on("click",l)}},complete:function(){likeInProgress=!1,document.body.style.cursor="default"}}),likeInProgress=!1)}};s("body").on("click",".likecontrol a[data-like-value]",l)}else s(".like,.unlike").attr("title","You're not allowed to perform this action."),s(".like,.unlike").addClass("general-tooltip").data("placement","top")}}(window.Brainbank=window.Brainbank||{},jQuery);var BrainBank=BrainBank||{};BrainBank.Kendo=BrainBank.Kendo||{},BrainBank.Kendo.Grid={AddEmptyTemplate:function(e){}},function(c,f){"use strict";var e={options:{dataTextField:"DisplayName",dataKeyField:"ID",serviceUrl:null,autoCompleteOptions:{placeholder:"Click to start searching..",minimumInputLength:1,multiple:!1,width:"element"},allowNewChoices:!1,dropDownTemplate:"dropDownTemplate is undefined"},_initializeSelection:function(e,t,i){var a=BrainBank.apiUrl+e.attr("data-autocomplete-serviceurl");0<t.length?c.ajax({url:a,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Keys:t}),success:function(e){e.Items!=f&&(e=e.Items),i(e)}}):i([])},_parseObjectbyString:function(e,t){if(0<t.indexOf(".")){for(var i=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");i.length;){var a=i.shift();if(!(a in e))return;e=e[a]}return e}return e[t]},_fillTemplateWithData:function(e,t){var i=t;if(this.options.dataTextField.indexOf(".")<=0){for(var a in e)if(e.hasOwnProperty(a)&&e[a]){for(var n=c(i),o=0;o<n.length;o++)-1<n[o].textContent.indexOf(a)&&(n[o].textContent=e[a]);i=n}}else{var r=this.options.dataTextField,l=this._parseObjectbyString(e,r);if(l){for(var s=c(i),d=0;d<s.length;d++)-1<s[d].textContent.indexOf(r)&&(s[d].textContent=l);i=s}}return i},_create:function(){var p=this,h=1*p.element.attr("data-autocomplete-pagesize"),e=c.extend({},p.options.autoCompleteOptions,{id:function(e){return p._parseObjectbyString(e,p.options.dataKeyField)},ajax:{url:p.options.serviceUrl,type:"POST",data:function(e,t,i,a,n,o,r){var l={};e.trim()&&(l.term=e),r!=f&&(l.currentUserId=r),i!=f&&i.trim()&&(l.challengeId=i),a!=f&&a.trim()&&(l.parentId=a),n!=f&&n.trim()&&(l.currentId=n),o!=f&&o.trim()&&(l.itemKey=o);var s=p.element.val();s!=f&&s.trim()&&(l.selectedVal=s),l.top=1+h,l.skip=t?(t-1)*h:0;var d=p.element.attr("data-autocomplete-customqueryparameters").split("&");if(!d)return l;for(var c=0;c<d.length;c++){var u=d[c].split("=");l[u[0]]=u[1]}return JSON.stringify(l)},contentType:"application/json; charset=utf-8",dataType:"json",results:function(e){e.Items!=f&&(e=e.Items);var t=!1;return e.length==1+h&&(t=!0,e.pop()),{results:e,more:t}}},formatResult:function(e){return p._fillTemplateWithData(e,p.options.dropDownTemplate)},formatSelection:function(e){return p._parseObjectbyString(e,p.options.dataTextField)},initSelection:function(e,t){var i=e.val();p._initializeSelection(p.element,i,t)},tags:[""]}),t=p.element.attr("data-autocomplete-resultstemplate");p.options.dropDownTemplate=""!=t?t:"<div class='select2-user-result'>"+p.options.dataTextField+"</div>",p.options.allowNewChoices&&(e.createSearchChoice=function(e,t){var i={};return i[p.options.dataKeyField]=e,i[p.options.dataTextField]=e,i}),p.element.select2(e).on("change",function(e){var t=this.getAttribute("counter")+"-Values-Value",i=c("#"+t);e.added?(0!=i.length&&(i[0].value=e.added[p.options.dataKeyField]),c(this).trigger("onTagAdded",{id:encodeURIComponent(e.added[p.options.dataKeyField]),tagvalue:encodeURIComponent(e.added[p.options.dataTextField])})):e.removed&&(0!=i.length&&(i[0].value=null),c(this).trigger("onTagRemoved",{id:encodeURIComponent(e.removed[p.options.dataKeyField]),tagvalue:encodeURIComponent(e.removed[p.options.dataTextField])}))})},addValue:function(e){var t,i=this.element.select2("val");t=c.isArray(e)?i.concat(e):i.push(e),this.element.select2("val",t)},destroy:function(){c.Widget.prototype.destroy.call(this)}};c.widget("brainbank.BrainBankAutoComplete",e)}(jQuery),function(u,p){"use strict";var e={options:{dataTextField:"DisplayName",dataKeyField:"ID",serviceUrl:null,customQueryParameters:null,selectFormGroup:"Ideas",dataTransformer:!1,dataFlattener:!1,userDefinedOptions:!1,JsonString:"",dropDownTemplate:"dropDownTemplate is undefined",dropDownOptions:{placeholder:"Click...",multiple:!0,width:"element"}},oldKeys:"null",_initializeSelection:function(e,t,i){var a=this;if(a.options.userDefinedOptions)if(0<t.length){var n=t.split("</br>");i(n)}else i([]);else{var o=e.attr("data-dropdown-serviceurl");0<t.length?setTimeout(function(){u.ajax({url:o,type:"POST",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Keys:t}),success:function(e){e.Items&&(e=e.Items),a.options.dataFlattener?i(a.options.dataFlattener(e)):i(e)}})},5):i([])}},_parseObjectbyString:function(e,t){if(0<t.indexOf(".")){for(var i=(t=(t=t.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split(".");i.length;){var a=i.shift();if(!(a in e))return;e=e[a]}return e}return e[t]},_raiseChangeEvent:function(e,t,i,a){e.trigger(t,{id:i,tagvalue:a})},_formatItem:function(e,t){var i="";return e.StatusIcon.Url&&(i+="<img class='drop-down-icon' src='"+e.StatusIcon.Url+"'>"),i+=t},_fillTemplateWithData:function(e,t){var i=t;if(this.options.dataTextField.indexOf(".")<=0){for(var a in e)if(e.hasOwnProperty(a)&&e[a]){for(var n=u(i),o=0;o<n.length;o++)-1<n[o].textContent.indexOf(a)&&(n[o].textContent=e[a]);i=n}}else{var r=this.options.dataTextField,l=this._parseObjectbyString(e,r);if(l){for(var s=u(i),d=0;d<s.length;d++)-1<s[d].textContent.indexOf(r)&&(s[d].textContent=l);i=s}}return i},_create:function(){var l=this,e=l.element.attr("data-dropdown-resultstemplate");l.options.dropDownTemplate=""!=e?e:"<div class='select2-user-result'>"+l.options.dataTextField+"</div>";var t=u.extend({},l.options.dropDownOptions,{id:function(e){return!e||l.options.userDefinedOptions?e:l.options.dataKeyField!=p&&"ID"!=l.options.dataKeyField?l._parseObjectbyString(e,l.options.dataKeyField):e.ID!=p?l._parseObjectbyString(e,l.options.dataKeyField):p},formatResult:function(i,e,t){if(l.options.dropDownTemplate)return l._fillTemplateWithData(i,u("<div/>").html(l.options.dropDownTemplate).text());var a=u("<div class='select2-user-result'></div>");if(!i||l.options.userDefinedOptions){if(""===l.options.JsonString)return a.text(i),a;var n,o=JSON.parse(l.options.JsonString);return u.each(o.$values,function(e,t){t.Key!==i||void 0===(n=l._parseObjectbyString(t,"Value.Translation"))&&(n=l._parseObjectbyString(t,"Value.Original"))}),a.text(n),a}var r=l._parseObjectbyString(i,l.options.dataTextField);return null!=i.ID&&i.hasOwnProperty("IsActive")&&!1===i.IsActive&&u(e).addClass("drop-down-notactive"),a.text(r),a},formatSelection:function(e,t,i){if(l.options.userDefinedOptions){if(""===l.options.JsonString)return u.isArray(e)?e[0]:e;var a;a=u.isArray(e)?e[0]:e;var n,o=JSON.parse(l.options.JsonString);return u.each(o.$values,function(e,t){t.Key!==a||void 0===(n=l._parseObjectbyString(t,"Value.Translation"))&&(n=l._parseObjectbyString(t,"Value.Original"))}),n}var r;return(r=u.isArray(e)?e[0]:e)!==p&&r.hasOwnProperty("IsActive")&&!1===r.IsActive&&u(t).addClass("drop-down-notactive"),l._parseObjectbyString(r,l.options.dataTextField)}});l.options.selectFormGroup=this.element.attr("data-dropdown-selectFormGroup"),l.options.customQueryParameters=this.element.attr("data-dropdown-customqueryparameters")==p?"":this.element.attr("data-dropdown-customqueryparameters").split("&"),this.options.userDefinedOptions?t.data=l.options.userDefinedOptions:""!==this.options.dataTextField?(l.options.selectFormGroup=this.element.attr("data-dropdown-selectFormGroup"),t.ajax={type:"POST",url:l.options.serviceUrl,data:function(e,t){var i={};if(i.Term=e.trim()?e:p,i.OldKeys=l.oldKeys,i.FormType=l.options.selectFormGroup.trim()?l.options.selectFormGroup:"",l.options.customQueryParameters)for(var a=0;a<l.options.customQueryParameters.length;a++){var n=l.options.customQueryParameters[a].split("=");i[n[0]]=n[1],"propertyValue1"==n[0]&&("state"==i.propertyName1?0==u("input[name='States.Value']").val().length?i.propertyValue1=p:i.propertyValue1=u("#s2id_States_Value").text().trim():"city"==i.propertyName1&&(i.propertyValue1=p))}return JSON.stringify(i)},dataType:"json",contentType:"application/json; charset=utf-8",traditional:!0,results:function(e,t){return e.Items!=p&&(e=e.Items),l.options.dataTransformer?{results:l.options.dataTransformer(e)}:{results:e}}}):t.ajax={type:"POST",url:l.options.serviceUrl,data:function(e,t){var i={};return i.Term=e.trim()?e:"null",i.OldKeys=l.oldKeys,JSON.stringify(i)},contentType:"application/json; charset=utf-8",dataType:"json",results:function(e,t){return e.Items!=p&&(e=e.Items),l.options.dataTransformer?{results:l.options.dataTransformer(e)}:{results:e}}},t.initSelection=function(e,t){h(e,!1);var i=e.val();l.oldKeys=i,l.options.selectFormGroup=e.attr("data-dropdown-selectFormGroup"),l._initializeSelection(l.element,i,t)},l.element.select2(t).on("change",function(e){var t=u(this);if(h(this,!1),e.added)l._raiseChangeEvent(t,"onTagAdded",e.added[l.options.dataKeyField],e.added[l.options.dataTextField]);else if(e.removed)l._raiseChangeEvent(t,"onTagRemoved",e.removed[l.options.dataKeyField],e.removed[l.options.dataTextField]);else{var i=u(this).select2("data");null==i?l._raiseChangeEvent(t,"onTagRemoved",0,""):l._raiseChangeEvent(t,"onTagAdded",i[l.options.dataKeyField],i[l.options.dataTextField])}})},_setOption:function(e,t){this.options[e]=t,u.Widget.prototype._setOption.apply(this,arguments)},destroy:function(){u.Widget.prototype.destroy.call(this)}};function h(e,l,t){if(0==u("#dependentFieldInlineToggle").length||"False"==u("#dependentFieldInlineToggle").val()||"True"==u("#singleSaveEditingToggle").val()||u(".idea-task").is(":visible")){var i,s=u(e),a=s.attr("currentid"),d=u(e).val()||"";""==d&&t&&(d=u(e).find("[data-dropdown-keyfield='ID']").val()||"");var c="";l&&(c=e.getElementsByClassName("selectedvalue")),0==c.length&&(c=""),a!=p&&0!=a&&(i=0<u(".main-dialogbox.modal.fade.in").length?u(".modal-body .control-group[parentid="+a+"]"):0<u(".idea-task.open").length?u(".idea-task .control-group[parentid="+a+"]"):u(".control-group[parentid="+a+"]"),l=!(!u(e).is(":visible")||""==c)||(i.hide(),d="",!1),i.each(function(){var e=this.getAttribute("parentid");u(this.getElementsByClassName("ishidden")).val("True");var t=!0;t=0<u(".main-dialogbox.modal.fade.in").length?u(".modal-body .control-group[currentid="+e+"]").is(":visible"):0<u(".idea-task.open").length?u(".idea-task .control-group[currentid="+e+"]").is(":visible"):u(".control-group[currentid="+e+"]").is(":visible");var i=this.attributes.haschildren.value;if(t)for(var a=this.attributes.parentOptionKey.value.split("</br>"),n=s.val().split("</br>"),o=0;o<a.length;o++)for(var r=0;r<n.length;r++)a[o]==n[r]?(u(this).show(),u(this.getElementsByClassName("ishidden")).val("False")):-1<d.indexOf(a[o])&&d.length==a[o].length?(u(this).show(),u(this.getElementsByClassName("ishidden")).val("False")):""!=c&&l?-1<u(c).val().split("</br>").indexOf(a[o])&&(u(this).show(),u(this.getElementsByClassName("ishidden")).val("False")):u(this.getElementsByClassName("ishidden")).val("True");"true"==i.toLowerCase()&&h(this,!0,!0)}))}}u.widget("brainbank.BrainBankDropDown",e)}(jQuery),BrainBank.Markdown=function(e){var t=Wysiwym.Markdown(e);return $.extend(this,t),this.buttons.push("|"),this.buttons.push(new Wysiwym.Button("H1",Wysiwym.span,{prefix:"#",suffix:"#",text:"Header"})),this.buttons.push(new Wysiwym.Button("H2",Wysiwym.span,{prefix:"##",suffix:"##",text:"Header"})),this.buttons.push(new Wysiwym.Button("H3",Wysiwym.span,{prefix:"###",suffix:"###",text:"Header"})),this.help=[{label:"Header",syntax:"## Header ##"},{label:"Bold",syntax:"**bold**"},{label:"Italic",syntax:"_italics_"},{label:"Link",syntax:"[your text](http://google.com)"},{label:"Bullet List",syntax:"* list item"},{label:"Number List",syntax:"1. list item"},{label:"Blockquote",syntax:"&gt; quoted text"},{label:"Large Code Block",syntax:"(Begin lines with 4 spaces)"},{label:"Inline Code Block",syntax:"&lt;code&gt;inline code&lt;/code&gt;"}],this.help.push({label:"H1",syntax:"#First heading#"}),this.help.push({label:"H2",syntax:"#Second heading#"}),this.help.push({label:"H3",syntax:"#Third heading#"}),this};var bkExtend=function(){var e=arguments;for(var t in 1==e.length&&(e=[this,e[0]]),e[1])e[0][t]=e[1][t];return e[0]};function bkClass(){}bkClass.prototype.construct=function(){},bkClass.extend=function(e){function t(){if(arguments[0]!==bkClass)return this.construct.apply(this,arguments)}var i=new this(bkClass);return bkExtend(i,e),t.prototype=i,t.extend=this.extend,t};var bkElement=bkClass.extend({construct:function(e,t){return"string"==typeof e&&(e=(t||document).createElement(e)),e=$BK(e)},appendTo:function(e){return e.appendChild(this),this},appendBefore:function(e){return e.parentNode.insertBefore(this,e),this},addEvent:function(e,t){return bkLib.addEvent(this,e,t),this},setContent:function(e){return this.innerHTML=e,this},pos:function(){var e=curtop=0;obj=this;if(obj.offsetParent)for(;e+=obj.offsetLeft,curtop+=obj.offsetTop,obj=obj.offsetParent;);var t=window.opera?0:parseInt(this.getStyle("border-width")||this.style.border)||0;return[e+t,curtop+t+this.offsetHeight]},noSelect:function(){return bkLib.noSelect(this),this},parentTag:function(e){var t=this;do{if(t&&t.nodeName&&t.nodeName.toUpperCase()==e)return t;t=t.parentNode}while(t);return!1},hasClass:function(e){return this.className.match(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)"))},addClass:function(e){return this.hasClass(e)||(this.className+=" nicEdit-"+e),this},removeClass:function(e){return this.hasClass(e)&&(this.className=this.className.replace(new RegExp("(\\s|^)nicEdit-"+e+"(\\s|$)")," ")),this},setStyle:function(e){var t=this.style;for(var i in e)switch(i){case"float":t.cssFloat=t.styleFloat=e[i];break;case"opacity":t.opacity=e[i],t.filter="alpha(opacity="+Math.round(100*e[i])+")";break;case"className":this.className=e[i];break;default:t[i]=e[i]}return this},getStyle:function(e,t){var i=t||document.defaultView;if(1==this.nodeType)return i&&i.getComputedStyle?i.getComputedStyle(this,null).getPropertyValue(e):this.currentStyle[bkLib.camelize(e)]},remove:function(){return this.parentNode.removeChild(this),this},setAttributes:function(e){for(var t in e)this[t]=e[t];return this}}),bkLib={isMSIE:-1!=navigator.appVersion.indexOf("MSIE"),addEvent:function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent("on"+t,i)},toArray:function(e){for(var t=e.length,i=new Array(t);t--;)i[t]=e[t];return i},noSelect:function(e){e.setAttribute&&"input"!=e.nodeName.toLowerCase()&&"textarea"!=e.nodeName.toLowerCase()&&e.setAttribute("unselectable","on");for(var t=0;t<e.childNodes.length;t++)bkLib.noSelect(e.childNodes[t])},camelize:function(e){return e.replace(/\-(.)/g,function(e,t){return t.toUpperCase()})},inArray:function(e,t){return null!=bkLib.search(e,t)},search:function(e,t){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return null},cancelEvent:function(e){return(e=e||window.event).preventDefault&&e.stopPropagation&&(e.preventDefault(),e.stopPropagation()),!1},domLoad:[],domLoaded:function(){if(!arguments.callee.done)for(arguments.callee.done=!0,i=0;i<bkLib.domLoad.length;i++)bkLib.domLoad[i]()},onDomLoaded:function(e){this.domLoad.push(e),document.addEventListener?document.addEventListener("DOMContentLoaded",bkLib.domLoaded,null):bkLib.isMSIE&&(document.write("<style>.nicEdit-main p { margin: 0; }</style><script id=__ie_onload defer "+("https:"==location.protocol?"src='javascript:void(0)'":"src=//0")+"><\/script>"),$BK("__ie_onload").onreadystatechange=function(){"complete"==this.readyState&&bkLib.domLoaded()}),window.onload=bkLib.domLoaded}};function $BK(e){return"string"==typeof e&&(e=document.getElementById(e)),e&&!e.appendTo?bkExtend(e,bkElement.prototype):e}var bkEvent={addEvent:function(e,t){return t&&(this.eventList=this.eventList||{},this.eventList[e]=this.eventList[e]||[],this.eventList[e].push(t)),this},fireEvent:function(){var e=bkLib.toArray(arguments),t=e.shift();if(this.eventList&&this.eventList[t])for(var i=0;i<this.eventList[t].length;i++)this.eventList[t][i].apply(this,e)}};function __(e){return e}Function.prototype.closure=function(){var e=this,t=bkLib.toArray(arguments),i=t.shift();return function(){if(void 0!==bkLib)return e.apply(i,t.concat(bkLib.toArray(arguments)))}},Function.prototype.closureListener=function(){var i=this,a=bkLib.toArray(arguments),n=a.shift();return function(e){if((e=e||window.event).target)var t=e.target;else t=e.srcElement;return i.apply(n,[e,t].concat(a))}};var nicEditorConfig=bkClass.extend({buttons:{bold:{name:__("Click to Bold"),command:"Bold",tags:["B","STRONG"],css:{"font-weight":"bold"},key:"b"},italic:{name:__("Click to Italic"),command:"Italic",tags:["EM","I"],css:{"font-style":"italic"},key:"i"},underline:{name:__("Click to Underline"),command:"Underline",tags:["U"],css:{"text-decoration":"underline"},key:"u"},left:{name:__("Left Align"),command:"justifyleft",noActive:!0},center:{name:__("Center Align"),command:"justifycenter",noActive:!0},right:{name:__("Right Align"),command:"justifyright",noActive:!0},justify:{name:__("Justify Align"),command:"justifyfull",noActive:!0},ol:{name:__("Insert Ordered List"),command:"insertorderedlist",tags:["OL"]},ul:{name:__("Insert Unordered List"),command:"insertunorderedlist",tags:["UL"]},subscript:{name:__("Click to Subscript"),command:"subscript",tags:["SUB"]},superscript:{name:__("Click to Superscript"),command:"superscript",tags:["SUP"]},strikethrough:{name:__("Click to Strike Through"),command:"strikeThrough",css:{"text-decoration":"line-through"}},removeformat:{name:__("Remove Formatting"),command:"removeformat",noActive:!0},indent:{name:__("Indent Text"),command:"indent",noActive:!0},outdent:{name:__("Remove Indent"),command:"outdent",noActive:!0},hr:{name:__("Horizontal Rule"),command:"insertHorizontalRule",noActive:!0}},iconsPath:"http://js.nicedit.com/nicEditIcons-latest.gif",buttonList:["save","bold","italic","underline","left","center","right","justify","ol","ul","fontSize","fontFamily","fontFormat","indent","outdent","image","upload","link","unlink","forecolor","bgcolor"],iconList:{xhtml:1,bgcolor:2,forecolor:3,bold:4,center:5,hr:6,indent:7,italic:8,justify:9,left:10,ol:11,outdent:12,removeformat:13,right:14,save:25,strikethrough:16,subscript:17,superscript:18,ul:19,underline:20,image:21,link:22,unlink:23,close:24,arrow:26,upload:27}}),nicEditors={nicPlugins:[],editors:[],registerPlugin:function(e,t){this.nicPlugins.push({p:e,o:t})},allTextAreas:function(e){for(var t=document.getElementsByTagName("textarea"),i=0;i<t.length;i++)nicEditors.editors.push(new nicEditor(e).panelInstance(t[i]));return nicEditors.editors},findEditor:function(e){for(var t=nicEditors.editors,i=0;i<t.length;i++)if(t[i].instanceById(e))return t[i].instanceById(e)}},nicEditor=bkClass.extend({construct:function(e){this.options=new nicEditorConfig,bkExtend(this.options,e),this.nicInstances=new Array,this.loadedPlugins=new Array;for(var t=nicEditors.nicPlugins,i=0;i<t.length;i++)this.loadedPlugins.push(new t[i].p(this,t[i].o));nicEditors.editors.push(this),bkLib.addEvent(document.body,"mousedown",this.selectCheck.closureListener(this))},panelInstance:function(e,t){e=this.checkReplace($BK(e));var i=new bkElement("DIV").setStyle({width:(parseInt(e.getStyle("width"))||e.clientWidth)+"px"}).appendBefore(e);return this.setPanel(i),this.addInstance(e,t)},checkReplace:function(e){var t=nicEditors.findEditor(e);return t&&(t.removeInstance(e),t.removePanel()),e},addInstance:function(e,t){if((e=this.checkReplace($BK(e))).contentEditable||window.opera)var i=new nicEditorInstance(e,t,this);else i=new nicEditorIFrameInstance(e,t,this);return this.nicInstances.push(i),this},removeInstance:function(e){e=$BK(e);for(var t=this.nicInstances,i=0;i<t.length;i++)t[i].e==e&&(t[i].remove(),this.nicInstances.splice(i,1))},removePanel:function(e){this.nicPanel&&(this.nicPanel.remove(),this.nicPanel=null)},instanceById:function(e){e=$BK(e);for(var t=this.nicInstances,i=0;i<t.length;i++)if(t[i].e==e)return t[i]},setPanel:function(e){return this.nicPanel=new nicEditorPanel($BK(e),this.options,this),this.fireEvent("panel",this.nicPanel),this},nicCommand:function(e,t){this.selectedInstance&&this.selectedInstance.nicCommand(e,t)},getIcon:function(e,t){var i=this.options.iconList[e],a=t.iconFiles?t.iconFiles[e]:"";return{backgroundImage:"url('"+(i?this.options.iconsPath:a)+"')",backgroundPosition:(i?-18*(i-1):0)+"px 0px"}},selectCheck:function(e,t){do{if(t.className&&-1!=t.className.indexOf("nicEdit"))return!1}while(t=t.parentNode);return this.fireEvent("blur",this.selectedInstance,t),this.lastSelectedInstance=this.selectedInstance,this.selectedInstance=null,!1}});nicEditor=nicEditor.extend(bkEvent);var nicEditorInstance=bkClass.extend({isSelected:!1,construct:function(e,t,i){this.ne=i,this.elm=this.e=e,this.options=t||{},newX=parseInt(e.getStyle("width"))||e.clientWidth,newY=parseInt(e.getStyle("height"))||e.clientHeight,this.initialHeight=newY-8;var a="textarea"==e.nodeName.toLowerCase();if(a||this.options.hasPanel){var n=bkLib.isMSIE&&!(void 0!==document.body.style.maxHeight&&"CSS1Compat"==document.compatMode),o={width:newX+"px",border:"1px solid #ccc",borderTop:0,overflowY:"auto",overflowX:"hidden"};o[n?"height":"maxHeight"]=this.ne.options.maxHeight?this.ne.options.maxHeight+"px":null,this.editorContain=new bkElement("DIV").setStyle(o).appendBefore(e);var r=new bkElement("DIV").setStyle({width:newX-8+"px",margin:"4px",minHeight:newY+"px"}).addClass("main").appendTo(this.editorContain);if(e.setStyle({display:"none"}),r.innerHTML=e.innerHTML,a){r.setContent(e.value);var l=(this.copyElm=e).parentTag("FORM");l&&bkLib.addEvent(l,"submit",this.saveContent.closure(this))}r.setStyle(n?{height:newY+"px"}:{overflow:"hidden"}),this.elm=r}this.ne.addEvent("blur",this.blur.closure(this)),this.init(),this.blur()},init:function(){this.elm.setAttribute("contentEditable","true"),""==this.getContent()&&this.setContent("<br />"),this.instanceDoc=document.defaultView,this.elm.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keypress",this.keyDown.closureListener(this)).addEvent("focus",this.selected.closure(this)).addEvent("blur",this.blur.closure(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},remove:function(){this.saveContent(),(this.copyElm||this.options.hasPanel)&&(this.editorContain.remove(),this.e.setStyle({display:"block"}),this.ne.removePanel()),this.disable(),this.ne.fireEvent("remove",this)},disable:function(){this.elm.setAttribute("contentEditable","false")},getSel:function(){return window.getSelection?window.getSelection():document.selection},getRng:function(){var e=this.getSel();if(e&&0!==e.rangeCount)return 0<e.rangeCount?e.getRangeAt(0):e.createRange()},selRng:function(e,t){window.getSelection?(t.removeAllRanges(),t.addRange(e)):e.select()},selElm:function(){var e=this.getRng();if(e){if(e.startContainer){var t=e.startContainer;if(1==e.cloneContents().childNodes.length)for(var i=0;i<t.childNodes.length;i++){var a=t.childNodes[i].ownerDocument.createRange();if(a.selectNode(t.childNodes[i]),1!=e.compareBoundaryPoints(Range.START_TO_START,a)&&-1!=e.compareBoundaryPoints(Range.END_TO_END,a))return $BK(t.childNodes[i])}return $BK(t)}return $BK("Control"==this.getSel().type?e.item(0):e.parentElement())}},saveRng:function(){this.savedRange=this.getRng(),this.savedSel=this.getSel()},restoreRng:function(){this.savedRange&&this.selRng(this.savedRange,this.savedSel)},keyDown:function(e,t){e.ctrlKey&&this.ne.fireEvent("key",this,e)},selected:function(e,t){if((t=t||this.selElm)||(t=this.selElm()),!e.ctrlKey){var i=this.ne.selectedInstance;i!=this&&(i&&this.ne.fireEvent("blur",i,t),(this.ne.selectedInstance=this).ne.fireEvent("focus",i,t)),this.ne.fireEvent("selected",i,t),this.isFocused=!0,this.elm.addClass("selected")}return!1},blur:function(){this.isFocused=!1,this.elm.removeClass("selected")},saveContent:function(){(this.copyElm||this.options.hasPanel)&&(this.ne.fireEvent("save",this),this.copyElm?this.copyElm.value=this.getContent():this.e.innerHTML=this.getContent())},getElm:function(){return this.elm},getContent:function(){return this.content=this.getElm().innerHTML,this.ne.fireEvent("get",this),this.content},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.elm.innerHTML=this.content},nicCommand:function(e,t){document.execCommand(e,!1,t)}}),nicEditorIFrameInstance=nicEditorInstance.extend({savedStyles:[],init:function(){var e=this.elm.innerHTML.replace(/^\s+|\s+$/g,"");this.elm.innerHTML="",e||(e="<br />"),this.initialContent=e,this.elmFrame=new bkElement("iframe").setAttributes({src:"javascript:;",frameBorder:0,allowTransparency:"true",scrolling:"no"}).setStyle({height:"100px",width:"100%"}).addClass("frame").appendTo(this.elm),this.copyElm&&this.elmFrame.setStyle({width:this.elm.offsetWidth-4+"px"});for(itm in["font-size","font-family","font-weight","color"])this.savedStyles[bkLib.camelize(itm)]=this.elm.getStyle(itm);setTimeout(this.initFrame.closure(this),50)},disable:function(){this.elm.innerHTML=this.getContent()},initFrame:function(){var e=$BK(this.elmFrame.contentWindow.document);e.designMode="on",e.open();var t=this.ne.options.externalCSS;e.write("<html><head>"+(t?'<link href="'+t+'" rel="stylesheet" type="text/css" />':"")+'</head><body id="nicEditContent" style="margin: 0 !important; background-color: transparent !important;">'+this.initialContent+"</body></html>"),e.close(),this.frameDoc=e,this.frameWin=$BK(this.elmFrame.contentWindow),this.frameContent=$BK(this.frameWin.document.body).setStyle(this.savedStyles),this.instanceDoc=this.frameWin.document.defaultView,this.heightUpdate(),this.frameDoc.addEvent("mousedown",this.selected.closureListener(this)).addEvent("keyup",this.heightUpdate.closureListener(this)).addEvent("keydown",this.keyDown.closureListener(this)).addEvent("keyup",this.selected.closure(this)),this.ne.fireEvent("add",this)},getElm:function(){return this.frameContent},setContent:function(e){this.content=e,this.ne.fireEvent("set",this),this.frameContent.innerHTML=this.content,this.heightUpdate()},getSel:function(){return this.frameWin?this.frameWin.getSelection():this.frameDoc.selection},heightUpdate:function(){this.elmFrame.style.height=Math.max(this.frameContent.offsetHeight,this.initialHeight)+"px"},nicCommand:function(e,t){this.frameDoc.execCommand(e,!1,t),setTimeout(this.heightUpdate.closure(this),100)}}),nicEditorPanel=bkClass.extend({construct:function(e,t,i){this.elm=e,this.options=t,this.ne=i,this.panelButtons=new Array,this.buttonList=bkExtend([],this.ne.options.buttonList),this.panelContain=new bkElement("DIV").setStyle({overflow:"hidden",width:"100%",border:"1px solid #cccccc",backgroundColor:"#efefef"}).addClass("panelContain"),this.panelElm=new bkElement("DIV").setStyle({margin:"2px",marginTop:"0px",zoom:1,overflow:"hidden"}).addClass("panel").appendTo(this.panelContain),this.panelContain.appendTo(e);var a=this.ne.options,n=a.buttons;for(button in n)this.addButton(button,a,!0);this.reorder(),e.noSelect()},addButton:function(buttonName,options,noOrder){var button=options.buttons[buttonName],type=button.type?eval("(typeof("+button.type+') == "undefined") ? null : '+button.type+";"):nicEditorButton,hasButton=bkLib.inArray(this.buttonList,buttonName);type&&(hasButton||this.ne.options.fullPanel)&&(this.panelButtons.push(new type(this.panelElm,buttonName,options,this.ne)),hasButton||this.buttonList.push(buttonName))},findButton:function(e){for(var t=0;t<this.panelButtons.length;t++)if(this.panelButtons[t].name==e)return this.panelButtons[t]},reorder:function(){for(var e=this.buttonList,t=0;t<e.length;t++){var i=this.findButton(e[t]);i&&this.panelElm.appendChild(i.margin)}},remove:function(){this.elm.remove()}}),nicEditorButton=bkClass.extend({construct:function(e,t,i,a){this.options=i.buttons[t],this.name=t,this.ne=a,this.elm=e,this.margin=new bkElement("DIV").setStyle({float:"left",marginTop:"2px"}).appendTo(e),this.contain=new bkElement("DIV").setStyle({width:"20px",height:"20px"}).addClass("buttonContain").appendTo(this.margin),this.border=new bkElement("DIV").setStyle({backgroundColor:"#efefef",border:"1px solid #efefef"}).appendTo(this.contain),this.button=new bkElement("DIV").setStyle({width:"18px",height:"18px",overflow:"hidden",zoom:1,cursor:"pointer"}).addClass("button").setStyle(this.ne.getIcon(t,i)).appendTo(this.border),this.button.addEvent("mouseover",this.hoverOn.closure(this)).addEvent("mouseout",this.hoverOff.closure(this)).addEvent("mousedown",this.mouseClick.closure(this)).noSelect(),window.opera||(this.button.onmousedown=this.button.onclick=bkLib.cancelEvent),a.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)).addEvent("key",this.key.closure(this)),this.disable(),this.init()},init:function(){},hide:function(){this.contain.setStyle({display:"none"})},updateState:function(){this.isDisabled?this.setBg():this.isHover?this.setBg("hover"):this.isActive?this.setBg("active"):this.setBg()},setBg:function(e){switch(e){case"hover":var t={border:"1px solid #666",backgroundColor:"#ddd"};break;case"active":t={border:"1px solid #666",backgroundColor:"#ccc"};break;default:t={border:"1px solid #efefef",backgroundColor:"#efefef"}}this.border.setStyle(t).addClass("button-"+e)},checkNodes:function(e){var t=e;do{if(this.options.tags&&bkLib.inArray(this.options.tags,t.nodeName))return this.activate(),!0}while(t=t.parentNode&&"nicEdit"!=t.className);for(t=$BK(e);3==t.nodeType;)t=$BK(t.parentNode);if(this.options.css)for(itm in this.options.css)if(t.getStyle(itm,this.ne.selectedInstance.instanceDoc)==this.options.css[itm])return this.activate(),!0;return this.deactivate(),!1},activate:function(){this.isDisabled||(this.isActive=!0,this.updateState(),this.ne.fireEvent("buttonActivate",this))},deactivate:function(){this.isActive=!1,this.updateState(),this.isDisabled||this.ne.fireEvent("buttonDeactivate",this)},enable:function(e,t){this.isDisabled=!1,this.contain.setStyle({opacity:1}).addClass("buttonEnabled"),this.updateState(),this.checkNodes(t)},disable:function(e,t){this.isDisabled=!0,this.contain.setStyle({opacity:.6}).removeClass("buttonEnabled"),this.updateState()},toggleActive:function(){this.isActive?this.deactivate():this.activate()},hoverOn:function(){this.isDisabled||(this.isHover=!0,this.updateState(),this.ne.fireEvent("buttonOver",this))},hoverOff:function(){this.isHover=!1,this.updateState(),this.ne.fireEvent("buttonOut",this)},mouseClick:function(){this.options.command&&(this.ne.nicCommand(this.options.command,this.options.commandArgs),this.options.noActive||this.toggleActive()),this.ne.fireEvent("buttonClick",this)},key:function(e,t){this.options.key&&t.ctrlKey&&String.fromCharCode(t.keyCode||t.charCode).toLowerCase()==this.options.key&&(this.mouseClick(),t.preventDefault&&t.preventDefault())}}),nicPlugin=bkClass.extend({construct:function(e,t){this.options=t,this.ne=e,this.ne.addEvent("panel",this.loadPanel.closure(this)),this.init()},loadPanel:function(e){var t=this.options.buttons;for(var i in t)e.addButton(i,this.options);e.reorder()},init:function(){}}),nicPaneOptions={},nicEditorPane=bkClass.extend({construct:function(e,t,i,a){this.ne=t,this.elm=e,this.pos=e.pos(),this.contain=new bkElement("div").setStyle({zIndex:"99999",overflow:"hidden",position:"absolute",left:this.pos[0]+"px",top:this.pos[1]+"px"}),this.pane=new bkElement("div").setStyle({fontSize:"12px",border:"1px solid #ccc",overflow:"hidden",padding:"4px",textAlign:"left",backgroundColor:"#ffffc9"}).addClass("pane").setStyle(i).appendTo(this.contain),a&&!a.options.noClose&&(this.close=new bkElement("div").setStyle({float:"right",height:"16px",width:"16px",cursor:"pointer"}).setStyle(this.ne.getIcon("close",nicPaneOptions)).addEvent("mousedown",a.removePane.closure(this)).appendTo(this.pane)),this.contain.noSelect().appendTo(document.body),this.position(),this.init()},init:function(){},position:function(){if(this.ne.nicPanel){var e=this.ne.nicPanel.elm,t=e.pos()[0]+parseInt(e.getStyle("width"))-(parseInt(this.pane.getStyle("width"))+8);t<this.pos[0]&&this.contain.setStyle({left:t+"px"})}},toggle:function(){this.isVisible=!this.isVisible,this.contain.setStyle({display:this.isVisible?"block":"none"})},remove:function(){this.contain&&(this.contain.remove(),this.contain=null)},append:function(e){e.appendTo(this.pane)},setContent:function(e){this.pane.setContent(e)}}),nicSelectOptions={buttons:{fontSize:{name:__("Select Font Size"),type:"nicEditorFontSizeSelect",command:"fontsize"},fontFamily:{name:__("Select Font Family"),type:"nicEditorFontFamilySelect",command:"fontname"},fontFormat:{name:__("Select Font Format"),type:"nicEditorFontFormatSelect",command:"formatBlock"}}},nicEditorSelect=bkClass.extend({construct:function(e,t,i,a){this.options=i.buttons[t],this.elm=e,this.ne=a,this.name=t,this.selOptions=new Array,this.margin=new bkElement("div").setStyle({float:"left",margin:"2px 1px 0 1px"}).appendTo(this.elm),this.contain=new bkElement("div").setStyle({width:"90px",height:"20px",cursor:"pointer",overflow:"hidden"}).addClass("selectContain").addEvent("click",this.toggle.closure(this)).appendTo(this.margin),this.items=new bkElement("div").setStyle({overflow:"hidden",zoom:1,border:"1px solid #ccc",paddingLeft:"3px",backgroundColor:"#fff"}).appendTo(this.contain),this.control=new bkElement("div").setStyle({overflow:"hidden",float:"right",height:"18px",width:"16px"}).addClass("selectControl").setStyle(this.ne.getIcon("arrow",i)).appendTo(this.items),this.txt=new bkElement("div").setStyle({overflow:"hidden",float:"left",width:"66px",height:"14px",marginTop:"1px",fontFamily:"sans-serif",textAlign:"center",fontSize:"12px"}).addClass("selectTxt").appendTo(this.items),window.opera||(this.contain.onmousedown=this.control.onmousedown=this.txt.onmousedown=bkLib.cancelEvent),this.margin.noSelect(),this.ne.addEvent("selected",this.enable.closure(this)).addEvent("blur",this.disable.closure(this)),this.disable(),this.init()},disable:function(){this.isDisabled=!0,this.close(),this.contain.setStyle({opacity:.6})},enable:function(e){this.isDisabled=!1,this.close(),this.contain.setStyle({opacity:1})},setDisplay:function(e){this.txt.setContent(e)},toggle:function(){this.isDisabled||(this.pane?this.close():this.open())},open:function(){this.pane=new nicEditorPane(this.items,this.ne,{width:"88px",padding:"0px",borderTop:0,borderLeft:"1px solid #ccc",borderRight:"1px solid #ccc",borderBottom:"0px",backgroundColor:"#fff"});for(var e=0;e<this.selOptions.length;e++){var t=this.selOptions[e],i=new bkElement("div").setStyle({overflow:"hidden",borderBottom:"1px solid #ccc",width:"88px",textAlign:"left",cursor:"pointer"}),a=new bkElement("div").setStyle({padding:"0px 4px"}).setContent(t[1]).appendTo(i).noSelect();a.addEvent("click",this.update.closure(this,t[0])).addEvent("mouseover",this.over.closure(this,a)).addEvent("mouseout",this.out.closure(this,a)).setAttributes("id",t[0]),this.pane.append(i),window.opera||(a.onmousedown=bkLib.cancelEvent)}},close:function(){this.pane&&(this.pane=this.pane.remove())},over:function(e){e.setStyle({backgroundColor:"#ccc"})},out:function(e){e.setStyle({backgroundColor:"#fff"})},add:function(e,t){this.selOptions.push(new Array(e,t))},update:function(e){this.ne.nicCommand(this.options.command,e),this.close()}}),nicEditorFontSizeSelect=nicEditorSelect.extend({sel:{1:"1&nbsp;(8pt)",2:"2&nbsp;(10pt)",3:"3&nbsp;(12pt)",4:"4&nbsp;(14pt)",5:"5&nbsp;(18pt)",6:"6&nbsp;(24pt)"},init:function(){for(itm in this.setDisplay("Font&nbsp;Size..."),this.sel)this.add(itm,'<font size="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFamilySelect=nicEditorSelect.extend({sel:{arial:"Arial","comic sans ms":"Comic Sans","courier new":"Courier New",georgia:"Georgia",helvetica:"Helvetica",impact:"Impact","times new roman":"Times","trebuchet ms":"Trebuchet",verdana:"Verdana"},init:function(){for(itm in this.setDisplay("Font&nbsp;Family..."),this.sel)this.add(itm,'<font face="'+itm+'">'+this.sel[itm]+"</font>")}}),nicEditorFontFormatSelect=nicEditorSelect.extend({sel:{p:"Paragraph",pre:"Pre",h6:"Heading&nbsp;6",h5:"Heading&nbsp;5",h4:"Heading&nbsp;4",h3:"Heading&nbsp;3",h2:"Heading&nbsp;2",h1:"Heading&nbsp;1"},init:function(){for(itm in this.setDisplay("Font&nbsp;Format..."),this.sel){var e=itm.toUpperCase();this.add("<"+e+">","<"+itm+' style="padding: 0px; margin: 0px;">'+this.sel[itm]+"</"+e+">")}}});nicEditors.registerPlugin(nicPlugin,nicSelectOptions);var nicButtonTips=bkClass.extend({construct:function(e){(this.ne=e).addEvent("buttonOver",this.show.closure(this)).addEvent("buttonOut",this.hide.closure(this))},show:function(e){this.timer=setTimeout(this.create.closure(this,e),400)},create:function(e){this.timer=null,this.pane||(this.pane=new nicEditorPane(e.button,this.ne,{fontSize:"12px",marginTop:"5px"}),this.pane.setContent(e.options.name))},hide:function(e){this.timer&&clearTimeout(this.timer),this.pane&&(this.pane=this.pane.remove())}});nicEditors.registerPlugin(nicButtonTips);var nicEditorAdvancedButton=nicEditorButton.extend({init:function(){this.ne.addEvent("selected",this.removePane.closure(this)).addEvent("blur",this.removePane.closure(this))},mouseClick:function(){this.isDisabled||(this.pane&&this.pane.pane?this.removePane():(this.pane=new nicEditorPane(this.contain,this.ne,{width:this.width||"270px",backgroundColor:"#fff"},this),this.addPane(),this.ne.selectedInstance.saveRng()))},addForm:function(e,t){for(itm in this.form=new bkElement("form").addEvent("submit",this.submit.closureListener(this)),this.pane.append(this.form),this.inputs={},e){var i=e[itm],a="";t&&(a=t.getAttribute(itm)),a=a||(i.value||"");var n=e[itm].type;if("title"==n)new bkElement("div").setContent(i.txt).setStyle({fontSize:"14px",fontWeight:"bold",padding:"0px",margin:"2px 0"}).appendTo(this.form);else{var o=new bkElement("div").setStyle({overflow:"hidden",clear:"both"}).appendTo(this.form);switch(i.txt&&new bkElement("label").setAttributes({for:itm}).setContent(i.txt).setStyle({margin:"2px 4px",fontSize:"13px",width:"50px",lineHeight:"20px",textAlign:"right",float:"left"}).appendTo(o),n){case"text":this.inputs[itm]=new bkElement("input").setAttributes({id:itm,value:a,type:"text"}).setStyle({margin:"2px 0",fontSize:"13px",float:"left",height:"20px",border:"1px solid #ccc",overflow:"hidden"}).setStyle(i.style).appendTo(o);break;case"select":for(opt in this.inputs[itm]=new bkElement("select").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left",margin:"2px 0"}).appendTo(o),i.options)new bkElement("option").setAttributes({value:opt,selected:opt==a?"selected":""}).setContent(i.options[opt]).appendTo(this.inputs[itm]);break;case"content":this.inputs[itm]=new bkElement("textarea").setAttributes({id:itm}).setStyle({border:"1px solid #ccc",float:"left"}).setStyle(i.style).appendTo(o),this.inputs[itm].value=a}}}new bkElement("input").setAttributes({type:"submit"}).setStyle({backgroundColor:"#efefef",border:"1px solid #ccc",margin:"3px 0",float:"left",clear:"both"}).appendTo(this.form),this.form.onsubmit=bkLib.cancelEvent},submit:function(){},findElm:function(e,t,i){for(var a=this.ne.selectedInstance.getElm().getElementsByTagName(e),n=0;n<a.length;n++)if(a[n].getAttribute(t)==i)return $BK(a[n])},removePane:function(){this.pane&&(this.pane.remove(),this.pane=null,this.ne.selectedInstance.restoreRng())}}),nicLinkOptions={buttons:{link:{name:"Add Link",type:"nicLinkButton",tags:["A"]},unlink:{name:"Remove Link",command:"unlink",noActive:!0}}},nicLinkButton=nicEditorAdvancedButton.extend({addPane:function(){this.ln=this.ne.selectedInstance.selElm().parentTag("A"),this.addForm({"":{type:"title",txt:"Add/Edit Link"},href:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},title:{type:"text",txt:"Title"},target:{type:"select",txt:"Open In",options:{"":"Current Window",_blank:"New Window"},style:{width:"100px"}}},this.ln)},submit:function(e){var t=this.inputs.href.value;if("http://"==t||""==t)return alert("You must enter a URL to Create a Link"),!1;if(this.removePane(),!this.ln){var i="javascript:nicTemp();";this.ne.nicCommand("createlink",i),this.ln=this.findElm("A","href",i)}this.ln&&this.ln.setAttributes({href:this.inputs.href.value,title:this.inputs.title.value,target:this.inputs.target.options[this.inputs.target.selectedIndex].value})}});nicEditors.registerPlugin(nicPlugin,nicLinkOptions);var nicColorOptions={buttons:{forecolor:{name:__("Change Text Color"),type:"nicEditorColorButton",noClose:!0},bgcolor:{name:__("Change Background Color"),type:"nicEditorBgColorButton",noClose:!0}}},nicEditorColorButton=nicEditorAdvancedButton.extend({addPane:function(){var e={0:"00",1:"33",2:"66",3:"99",4:"CC",5:"FF"},t=new bkElement("DIV").setStyle({width:"270px"});for(var i in e)for(var a in e)for(var n in e){var o="#"+e[i]+e[n]+e[a],r=new bkElement("DIV").setStyle({cursor:"pointer",height:"15px",float:"left"}).appendTo(t),l=new bkElement("DIV").setStyle({border:"2px solid "+o}).appendTo(r),s=new bkElement("DIV").setStyle({backgroundColor:o,overflow:"hidden",width:"11px",height:"11px"}).addEvent("click",this.colorSelect.closure(this,o)).addEvent("mouseover",this.on.closure(this,l)).addEvent("mouseout",this.off.closure(this,l,o)).appendTo(l);window.opera||(r.onmousedown=s.onmousedown=bkLib.cancelEvent)}this.pane.append(t.noSelect())},colorSelect:function(e){this.ne.nicCommand("foreColor",e),this.removePane()},on:function(e){e.setStyle({border:"2px solid #000"})},off:function(e,t){e.setStyle({border:"2px solid "+t})}}),nicEditorBgColorButton=nicEditorColorButton.extend({colorSelect:function(e){this.ne.nicCommand("hiliteColor",e),this.removePane()}});nicEditors.registerPlugin(nicPlugin,nicColorOptions);var nicImageOptions={buttons:{image:{name:"Add Image",type:"nicImageButton",tags:["IMG"]}}},nicImageButton=nicEditorAdvancedButton.extend({addPane:function(){this.im=this.ne.selectedInstance.selElm().parentTag("IMG"),this.addForm({"":{type:"title",txt:"Add/Edit Image"},src:{type:"text",txt:"URL",value:"http://",style:{width:"150px"}},alt:{type:"text",txt:"Alt Text",style:{width:"100px"}},align:{type:"select",txt:"Align",options:{none:"Default",left:"Left",right:"Right"}}},this.im)},submit:function(e){var t=this.inputs.src.value;if(""==t||"http://"==t)return alert("You must enter a Image URL to insert"),!1;if(this.removePane(),!this.im){var i="javascript:nicImTemp();";this.ne.nicCommand("insertImage",i),this.im=this.findElm("IMG","src",i)}this.im&&this.im.setAttributes({src:this.inputs.src.value,alt:this.inputs.alt.value,align:this.inputs.align.value})}});nicEditors.registerPlugin(nicPlugin,nicImageOptions);var nicSaveOptions={buttons:{save:{name:__("Save this content"),type:"nicEditorSaveButton"}}},nicEditorSaveButton=nicEditorButton.extend({init:function(){this.ne.options.onSave||this.margin.setStyle({display:"none"})},mouseClick:function(){var e=this.ne.options.onSave,t=this.ne.selectedInstance;e(t.getContent(),t.elm.id,t)}});nicEditors.registerPlugin(nicPlugin,nicSaveOptions);var nicXHTML=bkClass.extend({stripAttributes:["_moz_dirty","_moz_resizing","_extended"],noShort:["style","title","script","textarea","a"],cssReplace:{"font-weight:bold;":"strong","font-style:italic;":"em"},sizes:{1:"xx-small",2:"x-small",3:"small",4:"medium",5:"large",6:"x-large"},construct:function(e){this.ne=e,this.ne.options.xhtml&&e.addEvent("get",this.cleanup.closure(this))},cleanup:function(e){var t=e.getElm(),i=this.toXHTML(t);e.content=i},toXHTML:function(e,t,i){var a="",n="",o="",r=e.nodeType,l=e.nodeName.toLowerCase(),s=e.hasChildNodes&&e.hasChildNodes(),d=new Array;switch(r){case 1:var c=e.attributes;switch(l){case"b":l="strong";break;case"i":l="em";break;case"font":l="span"}if(t){for(var u=0;u<c.length;u++){var p=c[u],h=p.nodeName.toLowerCase(),f=p.nodeValue;if(p.specified&&f&&!bkLib.inArray(this.stripAttributes,h)&&"function"!=typeof f){switch(h){case"style":var v=f.replace(/ /g,"");for(itm in this.cssReplace)-1!=v.indexOf(itm)&&(d.push(this.cssReplace[itm]),v=v.replace(itm,""));o+=v,f="";break;case"class":f=f.replace("Apple-style-span","");break;case"size":o+="font-size:"+this.sizes[f]+";",f=""}f&&(n+=" "+h+'="'+f+'"')}}o&&(n+=' style="'+o+'"');for(u=0;u<d.length;u++)a+="<"+d[u]+">";""==n&&"span"==l&&(t=!1),t&&(a+="<"+l,"br"!=l&&(a+=n))}if(s||bkLib.inArray(this.noShort,h)){t&&(a+=">");for(u=0;u<e.childNodes.length;u++){var m=this.toXHTML(e.childNodes[u],!0,!0);m&&(a+=m)}}else t&&(a+=" />");t&&s&&(a+="</"+l+">");for(u=0;u<d.length;u++)a+="</"+d[u]+">";break;case 3:a+=e.nodeValue}return a}});nicEditors.registerPlugin(nicXHTML);var nicCodeOptions={buttons:{xhtml:{name:"Edit HTML",type:"nicCodeButton"}}},nicCodeButton=nicEditorAdvancedButton.extend({width:"350px",addPane:function(){this.addForm({"":{type:"title",txt:"Edit HTML"},code:{type:"content",value:this.ne.selectedInstance.getContent(),style:{width:"340px",height:"200px"}}})},submit:function(e){var t=this.inputs.code.value;this.ne.selectedInstance.setContent(t),this.removePane()}});nicEditors.registerPlugin(nicPlugin,nicCodeOptions);var nicBBCode=bkClass.extend({construct:function(e){if(this.ne=e,this.ne.options.bbCode){e.addEvent("get",this.bbGet.closure(this)),e.addEvent("set",this.bbSet.closure(this));var t=this.ne.loadedPlugins;for(itm in t)t[itm].toXHTML&&(this.xhtml=t[itm])}},bbGet:function(e){var t=this.xhtml.toXHTML(e.getElm());e.content=this.toBBCode(t)},bbSet:function(e){e.content=this.fromBBCode(e.content)},toBBCode:function(i){function e(e,t){i=i.replace(e,t)}return e(/\n/gi,""),e(/<strong>(.*?)<\/strong>/gi,"[b]$1[/b]"),e(/<em>(.*?)<\/em>/gi,"[i]$1[/i]"),e(/<span.*?style="text-decoration:underline;">(.*?)<\/span>/gi,"[u]$1[/u]"),e(/<ul>(.*?)<\/ul>/gi,"[list]$1[/list]"),e(/<li>(.*?)<\/li>/gi,"[*]$1[]"),e(/<ol>(.*?)<\/ol>/gi,"[list=1]$1[/list]"),e(/<img.*?src="(.*?)".*?>/gi,"[img]$1[/img]"),e(/<a.*?href="(.*?)".*?>(.*?)<\/a>/gi,"[url=$1]$2[/url]"),e(/<br.*?>/gi,"\n"),e(/<.*?>.*?<\/.*?>/gi,""),i},fromBBCode:function(i){function e(e,t){i=i.replace(e,t)}return e(/\[b\](.*?)\[\/b\]/gi,"<strong>$1</strong>"),e(/\[i\](.*?)\[\/i\]/gi,"<em>$1</em>"),e(/\[u\](.*?)\[\/u\]/gi,'<span style="text-decoration:underline;">$1</span>'),e(/\[list\](.*?)\[\/list\]/gi,"<ul>$1</ul>"),e(/\[list=1\](.*?)\[\/list\]/gi,"<ol>$1</ol>"),e(/\[\*\](.*?)\[\/\*\]/gi,"<li>$1</li>"),e(/\[img\](.*?)\[\/img\]/gi,'<img src="$1" />'),e(/\[url=(.*?)\](.*?)\[\/url\]/gi,'<a href="$1">$2</a>'),e(/\n/gi,"<br />"),i}});nicEditors.registerPlugin(nicBBCode);var nicUploadOptions={buttons:{upload:{name:"Upload Image",type:"nicUploadButton"}}},nicUploadButton=nicEditorAdvancedButton.extend({nicURI:"https://api.imgur.com/3/image",errorText:"Failed to upload image",addPane:function(){if(void 0===window.FormData)return this.onError("Image uploads are not supported in this browser, use Chrome, Firefox, or Safari instead.");this.im=this.ne.selectedInstance.selElm().parentTag("IMG");var e=new bkElement("div").setStyle({padding:"10px"}).appendTo(this.pane.pane);new bkElement("div").setStyle({fontSize:"14px",fontWeight:"bold",paddingBottom:"5px"}).setContent("Insert an Image").appendTo(e),this.fileInput=new bkElement("input").setAttributes({type:"file"}).appendTo(e),this.progress=new bkElement("progress").setStyle({width:"100%",display:"none"}).setAttributes("max",100).appendTo(e),this.fileInput.onchange=this.uploadFile.closure(this)},onError:function(e){this.removePane(),alert(e||"Failed to upload image")},uploadFile:function(){var e=this.fileInput.files[0];if(e&&e.type.match(/image.*/)){this.fileInput.setStyle({display:"none"}),this.setProgress(0);var t=new FormData;t.append("image",e);var i=new XMLHttpRequest;i.open("POST",this.ne.options.uploadURI||this.nicURI),i.onload=function(){try{var e=JSON.parse(i.responseText).data}catch(e){return this.onError()}if(e.error)return this.onError(e.error);this.onUploaded(e)}.closure(this),i.onerror=this.onError.closure(this),i.upload.onprogress=function(e){this.setProgress(e.loaded/e.total)}.closure(this),i.setRequestHeader("Authorization","Client-ID c37fc05199a05b7"),i.send(t)}else this.onError("Only image files can be uploaded")},setProgress:function(e){this.progress.setStyle({display:"block"}),e<.98?this.progress.value=e:this.progress.removeAttribute("value")},onUploaded:function(e){this.removePane();var t=e.link;if(!this.im){this.ne.selectedInstance.restoreRng();this.ne.nicCommand("insertImage",t),this.im=this.findElm("IMG","src",t)}var i=parseInt(this.ne.selectedInstance.elm.getStyle("width"));this.im&&this.im.setAttributes({src:t,width:i&&e.width?Math.min(i,e.width):""})}});nicEditors.registerPlugin(nicPlugin,nicUploadOptions);var BrainBank=BrainBank||{};BrainBank.Ui=BrainBank.Ui||{},BrainBank.Ui.TextInjector=function(){"use strict";var n=this;n.recipient=null,this.bind=function(e,t){return $(e).click(function(){n.injectToken($(this).text())}),$(t).click(function(){n.setRecipient(this)}),n},this.bindKendo=function(e){function t(){n.setRecipient(this)}return $(e).each(function(){var e=$(this).data().kendoEditor;null!=e&&e._events.select.push(t)}),n},this.setRecipient=function(e){n.recipient=e},this.injectToken=function(e){if(n.recipient){if(n.recipient.paste)return n.recipient.paste(e),void(n.recipient.focus&&n.recipient.focus());var t=n.recipient;if($(t).selection())return t.focus(),void $(t).selection("replace",{text:e});if(t.selectionStart||"0"==t.selectionStart){var i=t.value.substring(0,t.selectionStart),a=t.value.substring(t.selectionEnd,t.value.length);t.value=i+e+a}else t.value+=e;t.focus()}}};var BrainBank=BrainBank||{};BrainBank.Ui=BrainBank.Ui||{},BrainBank.Ui.CollapsiblePanel={checkbox:function(e,t){e=$(e),t=$(t),e.is(":checked")?t.css({display:"block"}):t.css({display:"none"}),e.change(function(){t.toggle(this.checked)})},radiobuttons:function(e,t,i){e=$(e),t=$(t),i=i||"data-container",t.hide(),e.change(function(){var e=$(this);t.hide(),e.is("["+i+"]")&&$(e.attr(i)).show("fast")}),e.filter(":checked").change()},link:function(a,n,o){$(document).off("click",a),$(document).on("click",a,function(){var e=$(a),t=$("#"+$(this).attr("data-container-id")),i="block"==t.css("display");return t.slideToggle(400),e.each(function(){var e=$(this);null!=e.data("show-text")&&(n=e.data("show-text")),null!=e.data("hide-text")&&(o=e.data("hide-text")),e.html(i?n:o)}),!1})}};var BrainBank=BrainBank||{};BrainBank.MagicHooks={AddContentEditable:function(){$(".content-editable-toggle").click(function(){var e="enableEditing";$.cookie(e)?$.cookie(e,null,{path:"/"}):$.cookie(e,!0,{path:"/"}),window.location.reload()})},AddAjaxContent:function(){$(".brainbank-ajax-content").each(function(e,t){var i=$(t),a=i.attr("data-ajax-content-href");$(this).removeClass("brainbank-ajax-content"),i.load(a)})},AddCollapsible:function(){var o="is-collapsed";$("*[data-toggles]").on("click",function(e){var t=$(e.target),i=$(t.attr("data-toggles")),a=t.attr("data-text-expanded")||"[-]",n=t.attr("data-text-collapsed")||"[+]";return!i.first().hasClass(o)?(t.text(n),i.hide().addClass(o)):(t.text(a),i.show().removeClass(o)),e.preventDefault(),!1})},AddAlternatingClasses:function(){$("table.is-striped").each(function(e,t){$(t).find("> tbody > tr:odd").addClass("is-odd")})}},function(n,l,s){var o,i,r,a,d,c,u,p,h,f,v;n.Challenge=n.Challenge||{};var m,g,b,w,y="",C=[];function k(e){l("#challengeList").is(":visible")?o.load(e,function(e){o.html(e),x(),S()}):l("#challengeTiles").is(":visible")?i.load(e,function(e){i.html(e),x(),S()}):o.load(e,function(e){o.html(e),x(),S()})}function x(e,t){t=t||"";var i=".list-view",a="";l("#challengeTiles").is(":visible")&&(a=".tileView",i=".tile-view"),e&&""!=t&&(i="challengeListBtn"==t?a="":(a=".tileView",".tile-view")),l(".challenge-list"+i+" .nav.nav-tabs li").removeClass("active"),"all"!=r.toLowerCase()&&"allnoinactive"!=r.toLowerCase()||l("#all"+a).addClass("active"),"active"==r.toLowerCase()&&l("#active"+a).addClass("active"),"notactive"==r.toLowerCase()&&l("#notactive"+a).addClass("active"),"closed"==r.toLowerCase()&&l("#Closed"+a).addClass("active"),"template"==r.toLowerCase()&&l("#Template"+a).addClass("active"),"completed"==r.toLowerCase()&&l("#completed"+a).addClass("active"),"inactive"==r.toLowerCase()&&l("#inactive"+a).addClass("active"),"upcoming"==r.toLowerCase()&&l("#upcoming").addClass("active"),l("#currentActiveFilter").val(r.toLowerCase())}function S(e){var t=".list-view";d&&(t=".tile-view"),e&&(t=""),l(".challenge-list"+t+" #sortbar a").removeClass("active"),"enddateasc"==a&&l(".challenge-list"+t+" a[data-sort='enddateasc']").addClass("active"),"enddatedesc"==a&&l(".challenge-list"+t+" a[data-sort='enddatedesc']").addClass("active"),"startdateasc"==a&&l(".challenge-list"+t+" a[data-sort='startdateasc']").addClass("active"),"startdatedesc"==a&&l(".challenge-list"+t+" a[data-sort='startdatedesc']").addClass("active")}function B(e,t,i,a,n,o){"stars"!=e&&"hreflink"!=e&&"textbox"!=e?(0==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').length&&l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .selectTypeDropdownParent').next().after('<div class="criteriaSetup row-fluid"><div class="span4 criteria-header-value"><h5></h5></div><div class="span4 criteria-header-label"><h5></h5></div><div class="span2 criteria-header-required"></div></div>'),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteria-header-value h5').text(t),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteria-header-label h5').text(i),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options, [id ^= "evalCriteria-"].active:not("#evalCriteria-0") .empty-options').remove(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').after(a?I(e):'<div class="empty-options row-fluid"><div class="span4 option-value"><div class="empty-criteria-value"><input type="text" value="" name="new-value"><br /><span class="help-block text-error"></span></div></div><div class="span4 option-value"><div class="empty-criteria-label"><input type="text" value="" name="new-label"></div></div><div class="span2"></div><div class="span2"><button class="empty-criteria-add btn disabledBtn">+</button></div></div>'),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').show()):(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(""),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options, [id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-options').remove(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').hide()),"readonly"!=e&&"pointer"!=e||l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteria-header-default h5').text(""),T(n,o)}function T(e,t){e?l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-default-checkbox').parents().eq(1).show():(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-default-checkbox').parents().eq(1).hide(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-default-checkbox').prop("checked",!1)),t?l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-required-checkbox').parents().eq(1).show():(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-required-checkbox').parents().eq(1).hide(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-required-checkbox').prop("checked",!1))}function I(e){return("readonly"==e||"pointer"==e)&&0<l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options').length?"":'<div class="empty-options row-fluid"><div class="span4 option-value"><div class="empty-criteria-value"><input type="text" value="" name="new-value"><br /><span class="help-block text-error"></span></div></div><div class="span4 option-value"><div class="empty-criteria-label"><input type="text" value="" name="new-label"></div></div><div class="span2"></div><div class="span2"></div></div>'}function E(){""==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-value input').val()||""==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-label input').val()||l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .help-block.text-error').is(":visible")?l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-add').hasClass("disabledBtn")||l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-add').addClass("disabledBtn"):l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-add').removeClass("disabledBtn")}function A(){var e=document.documentElement.clientWidth;if(e<1025&&0===l(".select-evaluation-menu").length&&0!=l("#challengeEvaluation .nav-tabs li a").length){var t=l("<select></select>");t.addClass("select-evaluation-menu input-block-level"),l("#challengeEvaluation .nav-tabs li a").each(function(){var e=l("<option></option>");e.val(this.hash),e.text(l(this).text()),t.append(e)}),t.change(function(){var e=this.value;l("#challengeEvaluation .sideways li").each(function(){l(l(this).children()[0]).prop("hash")==e?(l(this).addClass("active"),l(e).addClass("active")):(l(this).removeClass("active"),l(l(l(this).children()[0]).prop("hash")).removeClass("active"))})}),l("#challengeEvaluation .nav-tabs").before(t).hide()}1500<=e&&(l("#challengeEvaluation .select-evaluation-menu").remove(),l("#challengeEvaluation .nav-tabs").show())}function D(){l('[id^="evalCriteria-"]').each(function(e,t){var i="#"+l(this).attr("id");0<l(i+" .criteriaSetup").length?l(i+" .EvaluationSaveOriginalHTMLHidden").val('<div class="criteriaSetup row-fluid">'+l(i+" .criteriaSetup").html()+"</div>"):l(i+" .EvaluationSaveOriginalHTMLHidden").val(""),l(l(i+" .completed-options")).each(function(){l(i+" .EvaluationSaveOriginalHTMLHidden").val(l(i+" .EvaluationSaveOriginalHTMLHidden").val()+'<div class="completed-options row-fluid" data-value="'+l(this).attr("data-value")+'">'+l(this).html()+"</div>")}),0<l(i+" .empty-options").length&&l(i+" .EvaluationSaveOriginalHTMLHidden").val(l(i+" .EvaluationSaveOriginalHTMLHidden").val()+'<div class="empty-options row-fluid">'+l(i+" .empty-options").html()+"</div>")})}function L(){l.each(l(".Challenges-master-page #challengeList .media-body"),function(e,t){if(0<l(this).find(".icon-cog").length){var i=l(this).find(".icon-cog").offset();_this=l(this),i.left<1e3?(_this.find(".icon-cog + ul.dropdown-menu").css({left:"0px"}),_this.find(".icon-cog + ul.dropdown-menu").css({right:"auto"})):(_this.find(".icon-cog + ul.dropdown-menu").css({right:"0px"}),_this.find(".icon-cog + ul.dropdown-menu").css({left:"auto"}))}})}n.Challenge.initializeVerticalSlider=function(){1200<=l(window).width()&&n.VerticalSlider.initialization(l(".slider-vertical"),".featured-challenge-content")},n.Challenge.deleteBlobReference=function(){l(".delete-blobreference").click(function(e){e.preventDefault();var t=l(this),i=t.closest(".controls"),a=t.attr("data-key");n.ImageGallery.cleanBlobReference(i.find(".blob-references-container"),a),t.siblings("img").remove(),t.remove()})},n.Challenge.setFilter=function(e){r=e},n.Challenge.setSort=function(e){a=e},n.Challenge.Leaderboard=function(e,t,i,a,n,o){c=e,h=i,p=a,v=n,f=o,""!=(u=t)&&function(){if(""!=u){var e=c+"?viewName="+u;l.ajax({url:e,success:function(e){var r='<div class="row"><div class="span12"><h1><span id="collaboratorsTitle">'+v+'</span></h1></div></div><div class="row" id="collaborators">';p=p.replace("tempimage",""),l(e.Items).each(function(){var t=[],e="",i=h,a=(i.match(/{{badge/g)||[]).length,n=this.BadgeThumbnailKeys.split(",");l(n).each(function(){var e=this.split(":");" "==e[0].charAt(0)&&(e[0]=e[0].substr(1)),t.push({id:e[0],path:e[1]})}),i=(i=i.replace(/{{userName}}/g,this.UserDisplayName)).replace(/{{userId}}/g,this.UserId),i=(i=(i=""!=this.UserBlobKey?i.replace("{{userProfileImg}}",p+this.UserBlobKey):i.replace("{{userProfileImg}}","//d32ekf2zat2q3c.cloudfront.net/Planbox/icons/icons-profile-default.png")).replace("{{userPoints}}",this.AwardValue)).replace("{{Site.RootUrl}}",f);for(var o=0;o<a;o++)e="",i=t[o]!=s&&""!=(e=(t[o].path==s||""==t[o].path)&&""!=t[o].id&&(t[o].path="//d32ekf2zat2q3c.cloudfront.net/Planbox/icons/defaultIdeaBadge.png",!0)?t[o].path:t[o].path!=s&&""!=t[o].path?p+t[o].path:"")?i.replace("{{badge"+(o+1)+"}}",e):i.replace("{{badge"+(o+1)+"}}","").replace("is-badge-"+(o+1),""),!0;i=i.replace(i.match(/{{badge(.*)}}/g),""),r+=i}),r=r.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'").replace(/&quot;/g,'"')+"</div>",0<e.Items.length&&l("#collaboratorsLeaderboard").append(r)}})}}()},n.Challenge.initialize=function(e,t){o=l("#challenge-list-container"),i=l("#challenge-tiles-container"),r=e,a=t,l("#myCarousel").carousel(),l("a[data-toggle=popover]").popover().click(function(e){e.preventDefault()}),l("div.challenge-list").on("click","#sortbar a[data-sort]",function(e){e.preventDefault(),"challengeTiles"==e.target.parentNode.parentNode.id?(o=l("#challenge-tiles-container"),d=!0):o=l("#challenge-list-container");var t="list-view";d&&(t="tile-view"),l(this).addClass("active");var i=l(this).attr("data-sort");if(d)var a=l("div.challenge-list."+t+" .nav.nav-tabs li.active a:not(.create-challenge)");else a=l("div.challenge-list .nav.nav-tabs li.active a:not(.create-challenge)");a.attr("href",function(e,t){return t.replace(/(sort=)[a-z]+/gi,"$1"+i)}),k(a[0].href),l(".challenge-list."+t+"#sortbar a[data-sort!='"+i+"']").removeClass("active")}),l(document).on("click","#challengeListBtn, #challengeTileBtn",function(){var e,t=l(this).attr("id");d="challengeListBtn"==t?(e=l("#challengeTiles ul.nav .active").attr("id"),!1):(e=l("#challengeList ul.nav .active").attr("id"),!0),r=e,x(!0,l(this).attr("id")),S(!0)}),window.onresize=L,x(),S(!0),l(document).on("click",".tile-view .nav.nav-tabs li a:not(.create-challenge), .list-view .nav.nav-tabs li a:not(.create-challenge)",function(e){e.preventDefault(),k(l(this).attr("href"))}),n.Pagination.initializeLive("#idea-list-pagination",null,function(e){l("#challenge-list-container").html(e),x(),S()}),n.Pagination.initializeLive("#idea-tiles-pagination",null,function(e){l("#challenge-tiles-container").html(e),x(),S()})},l(document).ajaxComplete(function(){L(),l(document).on("click","#toggle-main-nav",function(){L()})}),n.Challenge.initializeEdit=function(e,t,i,a,n){g=t,b=i,w=a,y=n,l(window).resize(A),l(window).trigger("resize"),D(),l(document).on("click",'a[href="#TopContributorLeaderboard"]',function(){l(".tab-pane#TopContributorLeaderboard").addClass("in active"),l(".CodeMirror").each(function(e,t){t.CodeMirror.refresh(),t.CodeMirror.replaceSelection(t.CodeMirror.getSelection(),{line:0,ch:0},{line:0,ch:0})})}),l(document).on("input keyup",'[forcriteria^="criteriaName-"]',function(){!function(e,t){var i=l(e).attr("forcriteria"),a="#"+l(e).attr("forcriteria"),n=l('[forcriteria="'+i+'"]').typeahead(),o=l('[forcriteria="'+i+'"]').val();if(n.data("typeahead").items=10,setTimeout(function(){if(0<l(".select-evaluation-menu").length){var e=l(".sideways li.active a").attr("href");l('.select-evaluation-menu option[value="'+e+'"]').html(o)}l(a).html(o)},0),2<o.length){var r=t;m!=o&&l.ajax({url:r,data:{term:o},success:function(e){var t=[],a=0;l((C=e).Items).each(function(){t.push(this.Title)}),n.data("typeahead").source=t,n.data("typeahead").highlighter=function(e,t){var i="";return i=C.Items[a].Challenge?"<span>"+C.Items[a].Title+'</span></br><span style="font-size: 12px;">'+C.Items[a].Challenge.Name.Original+"</span>":"<span>"+C.Items[a].Title+"</span>",a++,i},a=0,n.data("typeahead").updater=function(o){var r=o;return l(C.Items).each(function(){if(this.Title==r){var e=this.Options,t="",i="";this.HasDefaultValue?(t='<input type="radio" class="defaultRadio" name="defaultvalue" value=',l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteria-header-default').show(),this.DefaultValue&&l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-required-checkbox').prop("checked",this.IsRequired)):l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteria-header-default h5').text(""),"readonly"!=this.Type.toLowerCase()&&"pointer"!=this.Type.toLowerCase()||l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-options').remove(),""!=e&&e!=s||(e="[]"),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(e),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveTypeHidden').val(this.Type),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsOriginalHidden').val(e),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveOriginalTypeHidden').val(this.Type);var a=JSON.parse(e);l(a).each(function(){var e=t;""!=e&&(e+='"'+this.label+'"'),this.DefaultValue==this.label?e+=" checked >":e+=" >",i+='<div class="completed-options row-fluid" data-value="'+this.value+'"><div class="span4 option-value"><div class="completed-criteria-value"><span>'+this.value+'</span></div></div><div class="span4 option-label"><div class="completed-criteria-label"><span>'+this.label+'</span></div></div><div class="span2 default-options">'+t+'</div><div class="span2"><a href="#" delete-value="'+this.value+'"><i class="icon-trash"></i></a></div></div>'}),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .selectTypeDropdown').prop("disabled",this.IsLocked),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-enabled-checkbox').prop("checked",this.Enabled),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-required-checkbox').prop("checked",this.IsRequired),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-default-checkbox').prop("checked",this.HasDefaultValue),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options').remove(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').after(i),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .selectTypeDropdown option[value="'+this.Type+'"]').attr("selected","selected"),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveTypeHidden').val(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .selectTypeDropdown').val()),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") [forcriteria^="criteriaName-"]').val(o.value);var n=l('[id^="evalCriteria-"].active:not("#evalCriteria-0") [forcriteria^="criteriaName-"]').attr("forcriteria");l("#"+n).html(this.Title),"stars"==this.Type.toLowerCase()||"textbox"==this.Type.toLowerCase()||"hreflink"==this.Type.toLowerCase()?(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options').remove(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-options').remove(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').remove(),T(!1,!0)):"dropdown"==this.Type.toLowerCase()||"radio"==this.Type.toLowerCase()?T(!0,!0):T(!1,!1)}D()}),r}}}),m=o}}(this,e)}),l(document).on("change",".selectTypeDropdown",function(){l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveTypeHidden').val(l(this).val()),l(this).val().toLowerCase()==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveOriginalTypeHidden').val().toLowerCase()?(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsOriginalHidden').val()),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup, [id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options, [id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-options').remove(),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .selectTypeDropdownParent').next().after(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveOriginalHTMLHidden').val()),l('[id^="evalCriteria-"].active:not("#evalCriteria-0")').show(),"dropdown"==l(this).val().toLowerCase()||"radio"==l(this).val().toLowerCase()?T(!0,!0):"stars"!=l(this).val().toLowerCase()&&"hreflink"!=l(this).val().toLowerCase()&&"textbox"!=l(this).val().toLowerCase()||T(!1,!0)):"pointer"==l(this).val().toLowerCase()?B(l(this).val().toLowerCase(),g,b,!0,!1,!1):"readonly"==l(this).val().toLowerCase()?B(l(this).val().toLowerCase(),w,y,!0,!1,!1):"stars"==l(this).val().toLowerCase()||"hreflink"==l(this).val().toLowerCase()||"textbox"==l(this).val().toLowerCase()?B(l(this).val().toLowerCase(),"","",null,!1,!0):B(l(this).val().toLowerCase(),w,y,!1,!0,!0)}),l(document).on("click",".icon-trash",function(){var a=l(this).parent().attr("delete-value"),e=l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val();""!=e&&e!=s||(e="[]");var n=JSON.parse(e);l('[id^="evalCriteria-"].active:not("#evalCriteria-0") [data-value="'+a+'"]').remove(),l.each(n,function(e,t,i){if(t.value==a)return n.splice(e,1),!1}),e=n[0]==s?"[]":JSON.stringify(n),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(e),"[]"!=e||l(".empty-criteria-add").is(":visible")||("readonly"==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveTypeHidden').val().toLowerCase()||"pointer"==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveTypeHidden').val().toLowerCase()?l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').after(I()):l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteriaSetup').after('<div class="empty-options row-fluid"><div class="span4 option-value"><div class="empty-criteria-value"><input type="text" value="" name="new-value"><br /><span class="help-block text-error"></span></div></div><div class="span4 option-value"><div class="empty-criteria-label"><input type="text" value="" name="new-label"></div></div><div class="span2"></div><div class="span2"><button class="empty-criteria-add btn disabledBtn">+</button></div></div>'))}),l(document).on("click",".empty-criteria-add",function(e){e.preventDefault();var t=parseInt(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-value input').val()),i=l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-label input').val(),a=l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(),n="";""!=a&&a!=s||(a="[]");var o=JSON.parse(a);o.push({value:t,label:i}),a=JSON.stringify(o),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(a),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .evaluation-default-checkbox').is(":checked")&&(n='<input type="radio" class="defaultRadio" name="defaultvalue" value="'+i+'">'),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-options').before('<div class="completed-options row-fluid" data-value="'+t+'"><div class="span4 option-value"><div class="completed-criteria-value"><span>'+t+'</span></div></div><div class="span4 option-label"><div class="completed-criteria-label"><span>'+i+'</span></div></div><div class="span2 default-options">'+n+'</div><div class="span2"><a href="#" delete-value="'+t+'"><i class="icon-trash"></i></a></div></div>'),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-value input, [id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-label input').val(""),E()}),l(document).on("change paste keyup",".empty-criteria-value input, .empty-criteria-label input",function(){var e=l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-value input').val();/^\d+$/.test(e)||""==e?l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .help-block.text-error').hide():(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .help-block.text-error').text(e+" is not a number"),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .help-block.text-error').show()),E()}),l(document).on("blur",".empty-criteria-value input, .empty-criteria-label input",function(){setTimeout(function(){var e=l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-value input').val();if((/^\d+$/.test(e)||""==e)&&("readonly"==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveTypeHidden').val().toLowerCase()||"pointer"==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveTypeHidden').val().toLowerCase())){var t=l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(),i=JSON.parse(t),a={value:parseInt(e),label:l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .empty-criteria-label input').val()};i.splice(0,1,a),t=JSON.stringify(i),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationOptionsHidden').val(t)}},0)}),l(document).on("click","#evaluationAdd",function(e){e.preventDefault();var t=l(".sideways li").length;if(t<10){0<l(".select-evaluation-menu").length&&(l(".select-evaluation-menu").append('<option value="#evalCriteria-Added-'+(t+1)+'">Evaluation '+(t+1)+"</option>"),l(".select-evaluation-menu").val("#evalCriteria-Added-"+(t+1))),0<l(".sideways li").length?l(".sideways li:last").after('<li class="active"><a href="#evalCriteria-Added-'+(t+1)+'" id="criteriaName-'+(t+1)+'" data-toggle="tab">Evaluation '+(t+1)+"</a></li>"):l(".sideways").append('<li class="active"><a href="#evalCriteria-Added-'+(t+1)+'" id="criteriaName-'+(t+1)+'" data-toggle="tab">Evaluation '+(t+1)+"</a></li>");var i=l(l(".evaluationCriteriaTemplate").html()).clone();l(i).attr("id","evalCriteria-Added-"+(t+1));var a=l(i).html();a=a.replace('id="newEvaluation_Options"','id="newEvaluation_Options" value="[]"').replace('class="EvaluationOptionsOriginalHidden"','class="EvaluationOptionsOriginalHidden" value="[]"').replace("criteriaName-0","criteriaName-"+(t+1)).replace('id="newEvaluation_Type"','id = "newEvaluation_Type" value="dropdown"').replace('class="EvaluationSaveOriginalTypeHidden"','class="EvaluationSaveOriginalTypeHidden" value="dropdown"').replace('id="newEvaluation_Title"','id="ChallengeEdit_EvaluationFields_'+t+'__Title" value="Evaluation '+(t+1)+'"').replace(/id="newEvaluation/g,'id="ChallengeEdit_EvaluationFields_'+t+"_").replace(/name="newEvaluation/g,'name="ChallengeEdit.EvaluationFields['+t+"]"),l(i).html(a),l('[id^="evalCriteria"].active').removeClass("active"),l(i).hasClass("active")||l(i).addClass("active"),0<l('[id^="evalCriteria-Added-"]').length?(l(i).insertAfter(l('[id^="evalCriteria-Added-"]').last()),l(".sideways li.active:first").removeClass("active")):0<l('[id^="evalCriteria-"]:not("#evalCriteria-0")').length?(l(i).insertAfter(l('[id^="evalCriteria-"]').last()),l(".sideways li.active:first").removeClass("active")):l(i).insertAfter(l(".evaluationCriteriaTemplate")),l("#"+i.attr("id")+" .EvaluationSaveIndexHidden").val(t+1)}10<=t+1&&l("#evaluationAdd").hide()}),l(document).on("change",".defaultRadio",function(){l('[id^="evalCriteria-"].active:not("#evalCriteria-0"):not("#evalCriteria-0") .EvaluationSaveDefaultValueHidden').val(l(this).val())}),l(document).on("change",".evaluation-default-checkbox",function(){!function(e){e?(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options .default-options').each(function(){l(this).append('<input type="radio" class="defaultRadio" name="defaultvalue" '+(l(l(l(this).prev().children()[0]).children()[0]).text()==l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .EvaluationSaveDefaultValueHidden').val()?"checked":"")+' value="'+l(l(l(this).prev().children()[0]).children()[0]).text()+'">')}),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteria-header-default h5').show()):(l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options .default-options').each(function(){l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .completed-options .default-options .defaultRadio').remove()}),l('[id^="evalCriteria-"].active:not("#evalCriteria-0") .criteria-header-default h5').text(""))}(l(this).is(":checked"))}),l(document).on("mouseover",".typeahead.dropdown-menu",function(){l(this).show()}),l(".sideways").sortable({stop:function(e,t){l(".sideways li a").each(function(e,t){var i=l(this).attr("href");l(i+" .EvaluationSaveOrderHidden").val(e+1),l(i+" .EvaluationSaveIndexHidden").val(e+1)})}}),l(".sideways").disableSelection()}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,a){var n,o,r;function l(e){n.load(e,function(e){n.html(e),d(),c()})}function s(){n.on("click","#list-pagination a",function(e){e.preventDefault();var t=a(this).attr("href");"#"!==(t=0<t.indexOf("?page=")||0<t.indexOf("&page=")?t+"&filter="+o+"&sort="+r:t+"?filter="+o+"&sort="+r)&&function(e){a(".users-list-container").find("#Users").load(e,function(){})}(t)})}function d(){a(".users-list .nav.nav-tabs li").removeClass("active"),"all"==o&&a("#all").addClass("active"),"active"==o&&a("#active").addClass("active"),"notactive"==o&&a("#notactive").addClass("active"),"lockedout"==o?(a("#lockedout").addClass("active"),a("#filter-all").hide(),a("#filter-external").hide()):(a("#filter-all").show(),a("#filter-external").show())}function c(){a(".users-list #sortbar a").removeClass("active"),"All"==r&&a(".users-list a[data-sort='All']").addClass("active"),"Internal"==r&&a(".users-list a[data-sort='Internal']").addClass("active"),"External"==r&&a(".users-list a[data-sort='External']").addClass("active")}e.Users=e.Users||{},e.Users.setFilter=function(e){o=e},e.Users.setSort=function(e){r=e},e.Users.initialize=function(e,t,i){n=a(".users-list-container"),i,"#list-pagination",o=e,r=t,a("div.users #userSearch").on("click",function(e){e.preventDefault();var t=a(this).attr("href"),i=a("#SearchTerm").val();l(t=t+"?filter="+o+"&searchTerm="+i.replace(" ","%20")+"&sort="+r)}),a("div.users #reset-userSearch").on("click",function(e){e.preventDefault(),a("#SearchTerm").val("");var t=a(this).attr("href");l(t=t+"?filter="+o+"&sort="+r)}),a("div.users-list").on("click","#sortbar a[data-sort]",function(e){e.preventDefault(),a(this).addClass("active");var i=a(this).attr("data-sort");r=i;var t=a("div.users-list .nav.nav-tabs li.active a");t.attr("href",function(e,t){return t.replace(/(sort=)[a-z]+/gi,"$1"+i)}),l(t[0].href),a("#sortbar a[data-sort!='"+i+"']").removeClass("active")}),d(),c(),a(".users-list").on("click",".nav.nav-tabs li a",function(e){e.preventDefault();var t=a(this).attr("href");t=t.replace(/(sort=)[a-z]+/gi,"$1"+r),o=a(this).parent().attr("id"),l(t)}),s()}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,a){var n;function o(){n.on("click","#list-pagination a",function(e){e.preventDefault();var t=a(this).attr("href");"#"!==t&&function(e){a(".success-story-list").find("#stories").load(e,function(){})}(t)})}e.SuccessStories=e.SuccessStories||{},e.SuccessStories.initialize=function(e,t,i){n=a(".success-story-list"),i,"#list-pagination",o()}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,a){var t,n;function o(e){a("#communities-container").load(e||t)}function i(){e.Pagination.initialize(a("#watchers-pagination"),null,function(e){a("#watchers").html(a(e).find("#watchers").html()),i()}),a(".community-watchers-form").ajaxForm({success:function(e){a("#communities-container").html(e)}})}e.CommunityWatchers=e.CommunityWatchers||{},e.CommunityWatchers.watchersInitialization=function(){i(),a(".show-communities").click(function(){n?o(a.param.querystring(t,{filter:n})):o()})},e.CommunityWatchers.initialization=function(e){t=e,a(".load-watchers").click(function(e){e.preventDefault();var t=a(this);if("disabled"!=t.attr("disabled")){var i=t.attr("href");a("#communities-container").load(i)}}),a(".nav-tabs [data-filter] a").click(function(e){e.preventDefault();var t=a(this),i=t.attr("href");n=t.parent().attr("data-filter"),o(i)})}}(window.Brainbank=window.Brainbank||{},jQuery),function(a){a.Categories=a.Categories||{},a.Categories.formPrefix="",a.Categories.getCategoriesIdsFromForm=function(e){a.Categories.formPrefix&&(a.Categories.formPrefix+=".");for(var t=e.serializeArray(),i=0;i<t.length;i++)if(t[i].name==a.Categories.formPrefix+"Ideacategoriestree.Value")return t[i].value.split(",");return null}}(window.Brainbank=window.Brainbank||{},jQuery),function(o,r){var a;o.Attachments=o.Attachments||{};var l=new Array;o.Attachments.deleteFromQueue=function(){for(var e=r.Deferred(),t=new Array,i=0;i<l.length;i++)t.push(r.get(r.param.querystring(a,{ids:l[i]})));return r.when.apply(r,t).done(function(){e.resolve()}),e.promise()},o.Attachments.updateDom=function(e){var t=e.find(".blob-references");t.each(function(a){r(t[a]).find("input").each(function(){var e=r(this),t=e.attr("name").split("]"),i=t[t.length-1];e.attr("name",e.attr("name").replace(/\[\d+\].(Blob.Key|ID|FileUploadFieldResponseID)$/,"["+a+"]"+i))})})},o.Attachments.initialization=function(e,t){a=e,r(t).on("click",".delete",function(e){e.preventDefault();var t=r(this),i=t.attr("data-blob-key"),a=t.attr("data-id"),n=t.closest(".brainbank-upload").parent().find(".blob-references-container");o.ImageGallery.cleanBlobReference(n,i,a),t.closest(".upload-item").remove(),a&&l.push(a)})}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,r){function n(e,t,i,a,n){e.preventDefault(),e.stopImmediatePropagation();var o=t.attr("href");o&&"#"!=o&&(n?r.ajax({url:o,complete:n}):a?r.ajax({url:o,success:a}):i&&i.load(o))}e.Pagination=e.Pagination||{},e.Pagination.initialize=function(e,t,i,a){e.find("a").click(function(e){n(e,r(this),t,i,a)})},e.Pagination.initializeLive=function(e,t,i,a){r(document).on("click",e+" a",function(e){n(e,r(this),t,i,a)})}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,s){e.scrollPagination=e.scrollPagination||{};var d=1,c=!1;s(document).on("click",".nav.nav-tabs li",function(){d=1,s("#activeTabFilter").val(s(this).attr("data-filter"))}),e.scrollPagination.initialize=function(e,t,i,a,n,o){s(window).on("scroll",function(){s(window).scrollTop()+s(window).height()>=s(document).height()-50&&function(e,t,i,a,n,o){var r,l;if(r=parseInt(parseInt(s(i).val())/a),r+=0<parseInt(s(i).val())%a?1:0,""!=s(o).val()&&(d=parseInt(s(o).val()),s(o).val(""),s(n).val(parseInt(s(i).val()))),!c&&d<r){c=!0,l=""!=n?(s(n).val(parseInt(s(n).val())-a*d),parseInt(s(n).val())):"";e=e+"?page="+ ++d;s.ajax({url:e,data:{rowNumber:l},success:function(e){s(t).append(e)},complete:function(){c=!1}})}}(e,t,i,a,n,o)})},e.scrollPagination.initializeLive=function(e,t,i,a,n,o){s(window).on("scroll",function(){s(document.body)[0].scrollHeight>s(window).height()&&s(window).scrollTop()+s(window).height()>=s(document).height()-50&&function(e,t,i,a,n,o){var r,l;if(r=parseInt(i/a),r+=0<i%a?1:0,!c&&d<r){c=!0,s(".nav.nav-tabs li a").addClass("disabledTab"),l=""!=n?(s(n).val(parseInt(s(n).val())-a*d),parseInt(s(n).val())):"";e=e+"?page="+ ++d+"&filter="+o;s.ajax({url:e,data:{rowNumber:l},success:function(e){s(t).append(e),s(".nav.nav-tabs li a").removeClass("disabledTab")},complete:function(){c=!1}})}}(e,t,i,a,n,o)})}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,l){e.ToggleTable=e.ToggleTable||{},e.ToggleTable.initialize=function(){var o=l(".toggle-table");if(!o.parent().is(".toggle-table-wrapper")){var r=l('<div class="toggle-table-menu btn-group"><a class="btn dropdown-toggle" data-toggle="dropdown" href="#">Display <span class="caret"></span></a><ul class="dropdown-menu pull-right"></ul></div>');o.wrap("<div class='toggle-table-wrapper'/>"),o.find("thead th").each(function(t){var e=l(this),i=e.attr("id"),a=e.attr("class");if(i||(i="table-col-"+t,e.attr("id",i)),o.find("tbody tr").each(function(){var e=l(this).find("th, td").eq(t);e.attr("headers",i),a&&e.addClass(a)}),!e.is(".persist")){var n=l('<li><input type="checkbox" name="toggle-cols" id="toggle-col-'+t+'" value="'+i+'" /> <label for="toggle-col-'+t+'">'+e.text()+'</label></li><li class="divider"></li>');r.find("ul").append(n),n.find("input").change(function(){var e=l(this),t=e.val(),i=l("#"+t+", [headers="+t+"]");e.is(":checked")?i.show():i.hide()}).on("updateCheck",function(){"table-cell"==e.css("display")?l(this).attr("checked",!0):l(this).attr("checked",!1)}).trigger("updateCheck"),n.click(function(e){e.stopPropagation()})}}),l(window).on("orientationchange resize",function(){r.find("input").trigger("updateCheck")}),o.before(r)}}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,i){var t,a,n;function o(){i("[data-filter]").removeClass("active"),i('[data-filter="'+n+'"]').addClass("active")}function r(e){a.load(e,function(){o()})}e.Tasks=e.Tasks||{},e.Tasks.reloadCurrentTab=function(){r(i("#task-list-container").find("li[data-filter].active a").attr("href"))},e.Tasks.intialize=function(e){t=i("#task-list-container"),a=t.find("#task-list"),"#list-pagination",n=e,o(),t.on("click","[data-filter] a",function(e){e.preventDefault();var t=i(this).attr("href");n=i(this).parent("[data-filter]").attr("data-filter"),r(t)}),t.on("click","#list-pagination a",function(e){e.preventDefault();var t=i(this).attr("href");"#"!==t&&r(t)})}}(window.Brainbank=window.Brainbank||{},jQuery);var BrainBank=BrainBank||{};BrainBank.page=BrainBank.page||{},BrainBank.page.TaskList||(BrainBank.page.TaskList={isInitialized:!1,filter:null,updateIdeaList:function(e,t,i){var a=this;this.filter=e,$("[data-filter]").removeClass("active"),$('[data-filter="'+this.filter+'"]').addClass("active");var n={target:"#task-list",success:function(e){var t=$(e),i=$("#task-list",t).html();$("#task-list").html(i),a.updateIdeaList(a.filter),Brainbank.NoMoreTable.initialize($(".no-more-table"))}};$("#task-list-form").ajaxForm(n),$("*[data-filter] a").click(function(e){e.preventDefault();var t=$(this).parent("[data-filter]").attr("data-filter");a.setFilter(t),$("#task-list-form").ajaxSubmit(n)}),$("#list-pagination a").click(function(e){e.preventDefault();var t=$(this).attr("href"),i=$.deparam(t.substr(t.indexOf("?")+1));$("input#CurrentPage").val(i.page),$("#task-list-form").ajaxSubmit(n)})},initialize:function(e,t,i){this.updateIdeaList(e)},setFilter:function(e){this.filter=e,$("input#Filter").val(e)}}),function(e,i){var t,a,n;function o(e){""!==n.val()&&(e=e+"&term="+n.val()),a.load(e,function(){})}e.IdeaMerges=e.IdeaMerges||{},e.IdeaMerges.reloadCurrentTab=function(){o(i("#idea-list-container").find("li[data-filter].active a").attr("href"))},e.IdeaMerges.intialize=function(){t=i("#idea-list-container"),a=t.find("#idea-list"),"#list-pagination",n=i(".merge-search"),t.on("click","#list-pagination a",function(e){e.preventDefault();var t=i(this).attr("href");"#"!==t&&o(t)})}}(window.Brainbank=window.Brainbank||{},jQuery);var BrainBank=BrainBank||{};BrainBank.page=BrainBank.page||{},BrainBank.page.MergeList||(BrainBank.page.MergeList={isInitialized:!1,filter:null,updateIdeaList:function(e,t,i){var a=this;this.filter=e,$("[data-filter]").removeClass("active"),$('[data-filter="'+this.filter+'"]').addClass("active");var n={target:"#idea-list",success:function(e){var t=$(e),i=$("#idea-list",t).html();$("#idea-list").html(i),a.updateIdeaList(a.filter),Brainbank.NoMoreTable.initialize($(".no-more-table"))}};$("#idea-list-form").ajaxForm(n),$("*[data-filter] a").click(function(e){e.preventDefault();var t=$(this).parent("[data-filter]").attr("data-filter");a.setFilter(t),$("#idea-list-form").ajaxSubmit(n)}),$("#list-pagination a").click(function(e){e.preventDefault();var t=$(this).attr("href"),i=$.deparam(t.substr(t.indexOf("?")+1));$("input#CurrentPage").val(i.page),$("#idea-list-form").ajaxSubmit(n)})},initialize:function(){this.updateIdeaList(filter)},setFilter:function(e){this.filter=e,$("input#Filter").val(e)}}),function(d,f,c){d.ImageGallery=d.ImageGallery||{},d.ImageGallery.snapMenuEnabled=!0;var u,n,o,r,t=50,l=2,v=new Array,a=["jpeg","jpg","png","gif"],m=[],p=1,h=!1;function i(){u=f("#image-gallery-container"),n=u.find(".thumbnail-container")}function s(t){u.on("click","#more-btn",function(e){e.preventDefault(),function(i){var e=f.param.querystring(o,{page:l});f.get(e,function(e){if(0<e.length){var t=f(e);d.StopLoading=!1,t.imagesLoaded(function(){f(d.loadingAbsoluteSelector).remove(),d.StopLoading=!0,i?n.append(t).masonry("appended",t,!0):(t.hide(),n.append(t),t.filter(".gallery-image").each(function(e,t){var i=f(t);i.hasClass("gallery-image")&&i.fadeIn()}),x(n.width(),n.find(".gallery-image")))})}l++,g(e)})}(t)})}function g(e){f("<div>"+e+"</div>").find(".total-blobs").val()<=t*(l-1)?f("#more-btn").hide():f("#more-btn").show()}function b(){n.css("visibility","hidden"),u.append(d.loadingAbsolute),n.imagesLoaded(function(){n.masonry({columnWidth:196,itemSelector:".gallery-image",isAnimated:!1}),u.find(d.loadingAbsoluteSelector).remove(),n.css("visibility","visible")})}function w(){u.on("mouseenter",".gallery-image",function(e){f(this).find(".description").stop().animate({bottom:"0px"},500)}),u.on("mouseleave",".gallery-image",function(e){f(this).find(".description").stop().animate({bottom:"-63px"},500)})}function y(t){for(var e=f("#form-filter").serializeArray(),i={},a=0;a<e.length;a++)e[a].value&&(i[e[a].name]=e[a].value);i.page=l-1,o=f.param.querystring(o,i,2),n.load(o,function(e){t&&n.masonry("destroy"),n.html(e),t&&b(),l=2,g(e),n.imagesLoaded(function(){x(n.width(),n.find(".gallery-image"))})})}function C(e,t,i,a,n,o){if(t.find("[value='"+e+"']").length)0!=f(".delete-blobreference").length&&f(".blob-references-container .blob-references .blob-references-key").val(f(".delete-blobreference").data().key);else{var r=t.find(".blob-references input.blob-references-key");if(m&&m.length&&new RegExp(m.join("|")).test(o.replace(/["'()]/g,"",""))){var l=t.siblings(".k-widget").find(".k-upload-files li.k-file span.k-filename[title='"+o+"']");if(l.length){var s=t.find("span.invalid-picture.hidden").clone();s.removeClass("hidden"),l.parent().append(s),f(".k-upload-files").addClass("k-invalid-picture")}}if("invalid"==e.substr(2+(~-e.lastIndexOf(".")>>>0))){var d=t.siblings(".k-widget").find(".k-upload-files li.k-file span.k-filename[title='"+o+"']");if(d.length){var c=t.find("span.max-size.hidden").clone();c.removeClass("hidden"),d.parent().append(c),f(".k-upload-files").addClass("k-invalid-picture")}}if(i){var u=r.attr("name").split(/\[\d+\].Blob.Key$/)[0];if(1!=r.length||r.val()||a){var p=r.last().clone();p.attr("name",u+"["+r.length+"].Blob.Key"),p.val(e);var h=f('<div class="blob-references"></div>').append(p);t.append(h)}else r.val(e),r.attr("name",u+"[0].Blob.Key")}else r.val(e);n||v.push(e)}}d.ImageGallery.addSelectedImage=function(e,t,i,a,n){C(e,t,i,a,!0,n)},d.ImageGallery.selection=function(e){e?f("#image-gallery-container .thumbnail-container").selectable({filter:".gallery-image",selecting:function(e,t){f(t.selecting).addClass("selected-image")},unselecting:function(e,t){f(t.unselecting).removeClass("selected-image")},distance:0}):u.on("click",".gallery-image",function(){var e=f(this);f(".gallery-image").removeClass("selected-image"),e.addClass("selected-image")})},d.ImageGallery.validateSelection=function(e,i){v=new Array;var a=f(e),t=f(".modal-body:last .selected-image");0<t.length&&(1<t.length?t.each(function(e,t){C(f(t).attr("data-key"),a,i,e)}):C(t.attr("data-key"),a,i),function(e,t){if(0<v.length){var i=e.find(".blob-list");f.ajax({type:"post",url:r,data:{keys:v},success:function(e){t?i.find("tbody").append(e):i.find("tbody").html(e),i.show()},traditional:!0})}}(a.parents(".upload-control").parent(),i));f(".modal:last").modal("hide")},d.ImageGallery.insertIntoInnovaStudioEditor=function(e){var i,a,n="",t=f(".modal-body:last .selected-image");0<t.length&&(1<t.length?t.each(function(e,t){i=f(t).attr("data-url"),a=f(t).attr("data-name"),n+="<img alt='"+a+"' src='"+i+"'/>"}):(i=t.attr("data-url"),a=t.attr("data-name"),n="<img alt='"+a+"' src='"+i+"'/>"),e.insertHTML(n))},d.ImageGallery.cancelSelection=function(e){f(this).closest(e).val(""),f(".gallery-image").removeClass("selected-image")},d.ImageGallery.reload=function(){p=1,f(".modal-body [data-form-success]").length&&y()},d.ImageGallery.initialize=function(e){i(),o=e,s(),w(),u.on("click",".gallery-image",function(e){var t=f(e.target);if(!t.closest(".previewed").length&&!t.closest(".preview").length){var i=f(this);u.find(".gallery-image.previewed .preview-close").click(),i.addClass("previewed");var a=f(window).height(),n=f(window).width(),o=979<=n?90:0;i.height(600<a?a-o:a+206);var r=i.attr("data-url"),l=i.attr("data-key"),s=i.attr("data-name");0!=f(this).find(".img-polaroid").length&&1<f(this).find(".img-polaroid").css("background").split('url("').length&&(r=f(this).find(".img-polaroid").css("background").split('url("')[1].split('") no-repeat')[0]),i.find(".preview-inner-desc .remove").attr("data-key",l),i.find(".preview-inner-desc .edit").attr("data-key",l),i.find(".preview").show(),i.find(".preview").css({"max-height":i.height()-214}),i.find(".preview").animate({height:600<a?a-206:a},500,"",function(){i.find(".preview-inner-img").css("line-height",i.find(".preview-inner").height()+"px"),633<n&&i.find(".preview-inner-img img").attr("src")!=r&&(i.find(".preview-inner-img").html("<img class='image' src='"+r+"' alt='"+s+"'/>"),i.find(".preview").append(d.loadingAbsolute),i.find(".preview").imagesLoaded(function(){i.find(".preview "+d.loadingAbsoluteSelector).remove(),i.find(".preview-inner-img img").fadeIn()}));var e=a<600?i.find(".preview").offset().top:i.offset().top-o;f("body, html").scrollTop(e)})}}),u.on("click",".preview-close",function(e){e.stopPropagation();var t=f(this);t.parents(".preview").hide(),t.parents(".gallery-image").animate({height:200},500),t.parents(".gallery-image").removeClass("previewed")}),f(document).keyup(function(e){if(27==e.which){var t=f(".gallery-image.previewed .preview");t.length&&"block"==t.css("display")&&t.find(".preview-close").click()}}),f("#form-filter select").change(function(){f("#form-filter").submit()}),f("#form-filter").submit(function(e){e.preventDefault(),y()}),n.imagesLoaded(function(){x(n.width(),n.find(".gallery-image")),f(window).resize(function(){x(n.width(),n.find(".gallery-image"))})})},d.ImageGallery.ScrollPagination=function(e,t,i,a,n,o,r){f(window).on("scroll",function(){f(document.body)[0].scrollHeight>f(window).height()&&f(document).height()-f(window).height()-150<=document.documentElement.scrollTop&&function(e,t,i,a){var n,o,r=f("#activeTabFilter").val(),l=f("#activeUploadFilter").val(),s=0<f("#activeSizeFilter").length?f("#activeSizeFilter").val():"";r===c&&(r=""),l===c&&(l=""),s===c&&(s=""),n=parseInt(i/a),n+=0<i%a?1:0,!h&&p<n&&(h=!0,f(".loadingAnimationBottom").show(),f(".form-inline select").addClass("disabledTab"),o=""!=s?e+"?page="+ ++p+"&filter="+r+"&activeFilter="+l+"&size="+s:e+"?page="+ ++p+"&filter="+r+"&activeFilter="+l,f.ajax({url:o,success:function(e){f(t).append(e),f(".form-inline select").removeClass("disabledTab")},complete:function(){h=!1,f(".loadingAnimationBottom").hide()}}))}(e,t,i,a)}),f(document).on("change",".form-inline select",function(e){p=1,"filter"==f(this).attr("name")?f("#activeTabFilter").val(this.value):"activeFilter"==f(this).attr("name")?f("#activeUploadFilter").val(this.value):"size"==f(this).attr("name")&&f("#activeSizeFilter").val(this.value)})},d.ImageGallery.removeImage=function(t,i,a){u.on("click",".gallery-image .preview .remove",function(){var e=f(this).attr("data-key");d.DialogBox.show({title:i,body:a,reload:"off",closeButtonLabel:"Cancel",validateButtonLabel:"Ok",validateButtonAction:function(){f.get(f.param.querystring(t,{key:e}),function(e){f("<div>"+e+"</div>").find("[data-form-success]").length?y():d.DialogBox.show({title:i,body:e,closeButtonLabel:"Ok"})})}})})},d.ImageGallery.editImage=function(t,i){u.on("click",".gallery-image .preview .edit",function(){var e=f(this).attr("data-key");d.DialogBox.show({title:i,remote:f.param.querystring(t,{key:e}),reload:"off",formSubmitSuccess:function(){y()}})})},d.ImageGallery.initializePopup=function(e){i(),o=e,b(),s(!0),w(),l=2},d.ImageGallery.SetGetByKeyBlobUrl=function(e){r=e},d.ImageGallery.cleanBlobReference=function(e,t,i){var a=e.find("input").length/3;t==c&&(t=i);var n=e.find("input[value='"+t+"']");1<a?(n.parent().remove(),d.Attachments.updateDom(e)):n.val("")},d.ImageGallery.validateImage=function(e,t){var i=t.substr(2+(~-t.lastIndexOf(".")>>>0));new RegExp(a.join("|")).test(i.toLowerCase())||0!=m.length&&new RegExp(m.join("|")).test(t.replace(/["'()]/g,""))||m.push(t.replace(/["'()]/g,"",""))},d.ImageGallery.removeInvalidImage=function(e){for(var t=m.length-1;0<=t;t--)if(m[t]===e.replace(/["'()]/g,"")){m.splice(t,1);break}},d.ImageGallery.autoMarginEnabled=!0;var k=5;function x(o,r){if(d.ImageGallery.autoMarginEnabled){var l=new Array,s=0;r.each(function(e,t){var i=f(t);i.css("margin-left",0);var a=i.width(),n=o-k*l.length;n<a+s&&(S(l,o,s),s=0,l=new Array),a+s<=n&&(s+=a,l.push(i)),e==r.length-1&&S(l,o,s)})}}function S(e,t,i){for(var a=(t-i)/(e.length-1),n=1;n<e.length;n++)50<a&&(a=50),e[n].css("margin-left",a-5)}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,c){e.SuccessStory=e.SuccessStory||{},e.SuccessStory.initialize=function(e,t,i,a){var n=new PptxGenJS,o=n.addNewSlide(),r="",l="",s="",d=!1;c('span[data-filedtype="CategoryTreeViewField"]').each(function(){l+=c(this).attr("data-value").replace(/,/g,"</br>")+"</br>",c(this).attr("data-value","|"+c(this).attr("data-value").replace(/,/g,"|")+"|"),c(this).text("")}),c('span[data-filedtype="UserDropDownField"]').each(function(){s+=c(this).attr("data-value").replace(/,/g,"</br>")+"</br>",c(this).attr("data-value","|"+c(this).attr("data-value").replace(/<\/br>/g,"|")+"|"),c(this).text("")}),c('#successStoryTable div[style*="background-image"]').each(function(){var t=c(this),i=c(this).css("background-image").replace("url(","").replace(")","").replace(/\"/gi,"");-1<i.indexOf("blobStorageLocation-")?i=a.replace("tempimage","")+i.split("blobStorageLocation-")[1]:t.addClass("staticImage"),function(e,a,n){var t=new Image;t.crossOrigin="Anonymous",t.onload=function(){var e,t=document.createElement("CANVAS"),i=t.getContext("2d");t.height=this.height,t.width=this.width,i.drawImage(this,0,0),e=t.toDataURL(n),a(e),t=null},t.src=e}(i,function(e){t.hasClass("staticImage")?t.append('<img src="'+e+'" />'):t.append('<img style="width: 238px;height: 238px;" src="'+e+'" />'),t.css("background-image","url("+i+")")})}),c.ajax({type:"POST",url:i,data:JSON.stringify({keys:l.substring(0,l.length-5)}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){var n;null!=a.Items&&c('span[data-filedtype="CategoryTreeViewField"]').each(function(){var i="",e=parseInt(c(this).attr("char-limit")),t=c(this).attr("data-value").split("|").filter(function(e){return""!=e});c.each(t,function(e,t){n=t,a.Items.find(function(e){e.ID!=parseInt(n)||(i+=e.Name.Translation+", ")})}),(i=i.substring(0,i.length-2)).length>e&&(i=i.substring(0,e)+"..."),c(this).text(i)})}}),c.ajax({type:"POST",url:t,data:JSON.stringify({keys:s.substring(0,s.length-5)}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){null!=e.Items&&c(e.Items).each(function(){var i=this.DisplayName,e=this.ID;c('span[data-filedtype="UserDropDownField"][data-value*="|'+e+'|"]').each(function(){var e=parseInt(c(this).attr("char-limit"));if(""==c(this).text())i.length>e&&(i=i.substring(0,e)+"..."),c(this).text(i);else if(c(this).text().length<=e)if(c(this).text().length+2>e)c(this).text(c(this).text()+"...");else if(c(this).text().length+2+i.length>e){var t=c(this).text()+", "+i;t=t.substring(0,e),c(this).text(t)}else c(this).text(c(this).text()+", "+i)})})}}),c(window).load(function(){c(".newLoader").hide(),c("#printToPowerPoint, #successStoryTable").fadeIn(500,function(){c("#successStoryTable").css("display","inline-block")})}),c("#printToPowerPoint").on("click",function(){d||(html2canvas(document.getElementById("successStoryTable"),{quality:4,scale:2,onrendered:function(e){!function(e){e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.oImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1}(e.getContext("2d")),r=e.toDataURL("image/png"),0<c(".a3Layout").length?(n.setLayout({name:"A3",width:10.375,height:10.8021}),o.addImage({data:r,x:0,y:0,w:10.375,h:10.8021})):0<c(".successStoryLayout").length?(o.addImage({data:r,x:0,y:0,w:10.7916,h:8.8021}),n.setLayout({name:"A3",width:10.7916,height:8.8021})):(o.addImage({data:r,x:0,y:0,w:10,h:7.5}),n.setLayout("LAYOUT_WIDE"))}}),d=!0),c(".newLoader").show(),setTimeout(function(){n.save(e),c(".newLoader").hide(),c("#printToPowerPoint, #successStoryTable").fadeIn(500,function(){c("#successStoryTable").css("display","inline-block")})},2e3)})}}(window.Brainbank=window.Brainbank||{},jQuery),function(a,l){a.EnhanceVoteControl=a.EnhanceVoteControl||{},a.EnhanceVoteControl.initialize=function(){l("input.btn-enhanced-vote-small").click(function(){l(".popover").remove(),l(this).removeClass("popoverset");var t=l(this);if(!t.hasClass("popoverset")){t.addClass("popoverset");var e=t.attr("data-href-enhanced-vote");t.popover({html:!0,content:a.loading}),t.popover("show"),l.get(e,function(e){t.popover("destroy"),t.popover({html:!0,content:e}),t.popover("show")})}}),l("input.btn-enhanced-vote-big").click(function(){var t=l(this);if(!t.hasClass("popoverset")){t.addClass("popoverset");var e=t.attr("data-href-enhanced-vote"),i={html:!0,placement:"left",container:".idea-info-content:first",content:a.loading};t.popover(i),t.popover("show"),l.get(e,function(e){t.popover("destroy"),i.content=e,t.popover(i),t.popover("show")})}}),l("input#CurrentUserIdeaVotes").change(function(){var e=l(this).attr("max"),t=l(this).attr("data-original-vote-value"),i=l(this).val();l(this).parent().find("input#MaxAvailableVotes").val(e-(i-t))}),l(document).on("click",'.enhanced-vote-popup input[type="button"]',function(){var e=l(this).parent().find("input#CurrentUserIdeaVotes").val();e=""===e?"0":-1<e.indexOf(".")?Math.round(e):e;var o=l(this).attr("data-idea-id"),t=l(this).parent().find("input#CurrentUserIdeaVotes").attr("data-original-vote-value");if(t=""===t?"0":t,0<=parseInt(e)&&t!==e){this.disabled=!0;var r=l(this).parent().find("input#CurrentUserIdeaVotes").attr("data-original-vote-TargetGoal");if(""===r&&(r=0),"False"==l("#Voted").val()){l("#Voted").val(!0);var i=BrainBank.getApiRoute("ideas","vote")+"?ideaid="+o+"&value="+e+"&currentUserVote=0&votingTargetGoal="+r;l.post(i,function(t){var i=t.Data.VotingTargetGoal,a=l("#enhancedvotecontrol-"+o+" .is-vote-value");if(a.attr("data-original-vote-value",t.Data.VoteValue),null!=i&&0!==i){var n=t.Data.VoteValue/i*100;a.each(function(e){0<a[e].className.indexOf("percentage")?(0<n%1&&(n=n.toFixed(1)),a[e].style.width=n+"%",a[e].innerText=n+"%"):a[e].innerText=t.Data.VoteValue.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"/"+i.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}),l(".percentage-complete-number-enhanced-voting").text(n),l(".remaining-votes-enhanced-voting").text((r-t.Data.VoteValue).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","))}else a.text(t.Data.VoteValue);var e=a.parent().find(".popoverset");e.removeClass("popoverset"),e.popover("destroy")})}}})}}(window.Brainbank=window.Brainbank||{},jQuery),function(e,n){var o,r,l,s;function d(e){event.preventDefault(),void 0===e&&(e="");var t={};t.term=n("#SearchTerm").val(),0!=n("input[name='States.Value']").val().length&&(t.state=n("#s2id_States_Value").text().trim()),0!=n("input[name='Cities.Value']").val().length&&(t.city=n("#s2id_Cities_Value").text().trim()),0!=n("input[name='Titles.Value']").val().length&&(t.title=n("#s2id_Titles_Value").text().trim()),t.skills=n("input[name='SelectedTags.Value']").val(),n.post(l+e,t).done(function(e){n("#Users").html(e)})}function c(){n(".users-list #sortbar a").removeClass("active"),"Alphabetical"==r&&n(".users-list a[data-sort='Alphabetical']").addClass("active"),"Newest"==r&&n(".users-list a[data-sort='Newest']").addClass("active")}e.MembersMentors=e.MembersMentors||{},e.MembersMentors.setFilter=function(e){e},e.MembersMentors.setSort=function(e){r=e},e.MembersMentors.initialize=function(e,t,i,a){o=n(".users-list-container"),l=i,"#list-pagination",e,r=t,s=a,n("input[name='States.Value']").change(function(e){n("#s2id_Cities_Value").find("a").find("span").text(s),n("#s2id_Cities_Value").find("a").addClass("select2-default"),n("#s2id_Cities_Value").find("a").find("abbr").hide()}),n("#advanced-search-toggle").on("click",function(e){n("#advanced-search-icon").toggleClass("icon-minus")}),n("div.users #userSearch").on("click",function(e){d()}),n("div.users #search-member").on("keypress",function(e){13!=e.which&&13!=e.keyCode||n("div.users #userSearch").click()}),n("div.users-list").on("click","#sortbar a[data-sort]",function(e){e.preventDefault(),n(this).addClass("active");var t=n(this).attr("data-sort");d("?sort="+(r=t)),n("#sortbar a[data-sort!='"+t+"']").removeClass("active")}),c(),o.on("click","#list-pagination a",function(e){e.preventDefault();n('form[name="user-filter-form"]').serializeArray();var t="?page="+n(this).html()+"&sort="+r;"#"!=t&&d(t)})}}(window.Brainbank=window.Brainbank||{},jQuery);